[{"id":"901001","description":"CRS is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"crs_setup_version"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"Deny":403},{"Tag":"UNKNOWN:status:500"},"Log",{"Tag":"FLAG:auditlog"},{"Msg":"CRS is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":901001,"phase":1,"chain":false}},{"id":"901100","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"inbound_anomaly_score_threshold"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.inbound_anomaly_score_threshold=5"}],"transformations":[],"id":901100,"phase":1,"chain":false}},{"id":"901110","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"outbound_anomaly_score_threshold"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.outbound_anomaly_score_threshold=4"}],"transformations":[],"id":901110,"phase":1,"chain":false}},{"id":"901111","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"reporting_level"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.reporting_level=4"}],"transformations":[],"id":901111,"phase":1,"chain":false}},{"id":"901115","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"early_blocking"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.early_blocking=0"}],"transformations":[],"id":901115,"phase":1,"chain":false}},{"id":"901120","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"blocking_paranoia_level"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_paranoia_level=1"}],"transformations":[],"id":901120,"phase":1,"chain":false}},{"id":"901125","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"detection_paranoia_level"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_paranoia_level=%{TX.blocking_paranoia_level}"}],"transformations":[],"id":901125,"phase":1,"chain":false}},{"id":"901130","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"sampling_percentage"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.sampling_percentage=100"}],"transformations":[],"id":901130,"phase":1,"chain":false}},{"id":"901140","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"critical_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.critical_anomaly_score=5"}],"transformations":[],"id":901140,"phase":1,"chain":false}},{"id":"901141","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"error_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.error_anomaly_score=4"}],"transformations":[],"id":901141,"phase":1,"chain":false}},{"id":"901142","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"warning_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.warning_anomaly_score=3"}],"transformations":[],"id":901142,"phase":1,"chain":false}},{"id":"901143","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"notice_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.notice_anomaly_score=2"}],"transformations":[],"id":901143,"phase":1,"chain":false}},{"id":"901160","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allowed_methods"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allowed_methods=GET HEAD POST OPTIONS"}],"transformations":[],"id":901160,"phase":1,"chain":false}},{"id":"901162","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allowed_request_content_type"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |text/xml| |application/xml| |application/soap+xml| |application/json|"}],"transformations":[],"id":901162,"phase":1,"chain":false}},{"id":"901168","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allowed_request_content_type_charset"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allowed_request_content_type_charset=|utf-8| |iso-8859-1| |iso-8859-15| |windows-1252|"}],"transformations":[],"id":901168,"phase":1,"chain":false}},{"id":"901163","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allowed_http_versions"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0"}],"transformations":[],"id":901163,"phase":1,"chain":false}},{"id":"901164","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"restricted_extensions"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.restricted_extensions=.ani/ .asa/ .asax/ .ascx/ .back/ .backup/ .bak/ .bck/ .bk/ .bkp/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .cnf/ .com/ .compositefont/ .config/ .conf/ .copy/ .crt/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dist/ .dll/ .dos/ .dpkg-dist/ .drv/ .gadget/ .hta/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .inf/ .ini/ .jks/ .jse/ .key/ .licx/ .lnk/ .log/ .mdb/ .msc/ .ocx/ .old/ .pass/ .pdb/ .pfx/ .pif/ .pem/ .pol/ .prf/ .printer/ .pwd/ .rdb/ .rdp/ .reg/ .resources/ .resx/ .sav/ .save/ .scr/ .sct/ .sh/ .shs/ .sql/ .sqlite/ .sqlite3/ .swap/ .swo/ .swp/ .sys/ .temp/ .tfstate/ .tlb/ .tmp/ .vb/ .vbe/ .vbs/ .vbproj/ .vsdisco/ .vxd/ .webinfo/ .ws/ .wsc/ .wsf/ .wsh/ .xsd/ .xsx/"}],"transformations":[],"id":901164,"phase":1,"chain":false}},{"id":"901165","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"restricted_headers_basic"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.restricted_headers_basic=/content-encoding/ /proxy/ /lock-token/ /content-range/ /if/ /x-http-method-override/ /x-http-method/ /x-method-override/ /x-middleware-subrequest/ /expect/"}],"transformations":[],"id":901165,"phase":1,"chain":false}},{"id":"901171","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"restricted_headers_extended"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.restricted_headers_extended=/accept-charset/"}],"transformations":[],"id":901171,"phase":1,"chain":false}},{"id":"901510","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allow_method_override_parameter"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allow_method_override_parameter=0"}],"transformations":[],"id":901510,"phase":1,"chain":false}},{"id":"901167","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"enforce_bodyproc_urlencoded"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.enforce_bodyproc_urlencoded=0"}],"transformations":[],"id":901167,"phase":1,"chain":false}},{"id":"901169","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"crs_validate_utf8_encoding"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.crs_validate_utf8_encoding=0"}],"transformations":[],"id":901169,"phase":1,"chain":false}},{"id":"901170","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"crs_skip_response_analysis"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.crs_skip_response_analysis=0"}],"transformations":[],"id":901170,"phase":1,"chain":false}},{"id":"901320","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ENABLE_DEFAULT_COLLECTIONS"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.ua_hash=%{REQUEST_HEADERS.User-Agent}"}],"transformations":[],"id":901320,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ENABLE_DEFAULT_COLLECTIONS"},"count":false,"negation":false}],"operator":{"Eq":"1"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ua_hash"},"count":false,"negation":false}],"operator":{"Rx":"@unconditionalMatch"},"actions":[{"Tag":"UNKNOWN:initcol:global=global"},{"Tag":"UNKNOWN:initcol:ip=%{remote_addr}_%{MATCHED_VAR}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"901340","description":"Enabling body inspection","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQBODY_PROCESSOR"},"count":false,"negation":false}],"operator":{"Rx":"!@rx (?:URLENCODED|MULTIPART|XML|JSON)"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"FLAG:noauditlog"},{"Msg":"Enabling body inspection"},{"Tag":"OWASP_CRS"},{"Ctl":["","forceRequestBodyVariable=On"]},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":901340,"phase":1,"chain":false}},{"id":"901350","description":"Enabling forced body inspection for ASCII content","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"enforce_bodyproc_urlencoded"},"count":false,"negation":false}],"operator":{"Eq":"1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"FLAG:noauditlog"},{"Msg":"Enabling forced body inspection for ASCII content"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":["UrlDecodeUni"],"id":901350,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQBODY_PROCESSOR"},"count":false,"negation":false}],"operator":{"Rx":"!@rx (?:URLENCODED|MULTIPART|XML|JSON)"},"actions":[{"Ctl":["","requestBodyProcessor=URLENCODED"]}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"901400","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"sampling_percentage"},"count":false,"negation":false}],"operator":{"Eq":"100"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-SAMPLING"}],"transformations":[],"id":901400,"phase":1,"chain":false}},{"id":"901410","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"UNIQUE_ID"},"count":false,"negation":false}],"operator":{"Rx":"^[a-f]*([0-9])[a-f]*([0-9])"},"actions":["Pass",{"Tag":"FLAG:capture"},{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"TX.sampling_rnd100=%{TX.1}%{TX.2}"}],"transformations":[],"id":901410,"phase":1,"chain":false}},{"id":"901450","description":"Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"sampling_rnd100"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass","Log",{"Tag":"FLAG:noauditlog"},{"Msg":"Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}"},{"Tag":"OWASP_CRS"},{"Ctl":["","ruleRemoveByTag=OWASP_CRS"]},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":901450,"phase":1,"chain":false}},{"id":"901500","description":"Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"detection_paranoia_level"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Tag":"UNKNOWN:status:500"},"Log",{"Msg":"Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":901500,"phase":1,"chain":false}},{"id":"905100","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false}],"operator":{"StrEq":"GET /"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-apache"},{"Tag":"attack-generic"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":905100,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RemoteAddr","count":false,"negation":false}],"operator":{"Rx":"@ipMatch 127.0.0.1,::1"},"actions":[{"Ctl":["","ruleRemoveByTag=OWASP_CRS"]},{"Ctl":["","auditEngine=Off"]}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"905110","description":"No description","enabled":true,"details":{"variables":[{"variable":"RemoteAddr","count":false,"negation":false}],"operator":{"Rx":"@ipMatch 127.0.0.1,::1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-apache"},{"Tag":"attack-generic"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":905110,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"EndsWith":"(internal dummy connection)"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false}],"operator":{"Rx":"^(?:GET /|OPTIONS \\*) HTTP/[12]\\.[01]$"},"actions":[{"Ctl":["","ruleRemoveByTag=OWASP_CRS"]},{"Ctl":["","auditEngine=Off"]}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"911011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911011,"phase":1,"chain":false}},{"id":"911012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911012,"phase":2,"chain":false}},{"id":"911100","description":"Method is not allowed by policy","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":"NoOp","actions":["Block",{"Msg":"Method is not allowed by policy"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-generic"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/METHOD-ENFORCEMENT"},{"Tag":"capec/1000/210/272/220/274"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":911100,"phase":1,"chain":false}},{"id":"911013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911013,"phase":1,"chain":false}},{"id":"911014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911014,"phase":2,"chain":false}},{"id":"911015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911015,"phase":1,"chain":false}},{"id":"911016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911016,"phase":2,"chain":false}},{"id":"911017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911017,"phase":1,"chain":false}},{"id":"911018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911018,"phase":2,"chain":false}},{"id":"913011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913011,"phase":1,"chain":false}},{"id":"913012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913012,"phase":2,"chain":false}},{"id":"913100","description":"Found User-Agent associated with security scanner","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"PmFromFile":"scanners-user-agents.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Found User-Agent associated with security scanner"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-reputation-scanner"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/SCANNER-DETECTION"},{"Tag":"capec/1000/118/224/541/310"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":913100,"phase":1,"chain":false}},{"id":"913013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913013,"phase":1,"chain":false}},{"id":"913014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913014,"phase":2,"chain":false}},{"id":"913015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913015,"phase":1,"chain":false}},{"id":"913016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913016,"phase":2,"chain":false}},{"id":"913017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913017,"phase":1,"chain":false}},{"id":"913018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913018,"phase":2,"chain":false}},{"id":"920011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920011,"phase":1,"chain":false}},{"id":"920012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920012,"phase":2,"chain":false}},{"id":"920100","description":"Invalid HTTP Request Line","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false}],"operator":{"Rx":"!@rx (?i)^(?:get /[^#\\?]*(?:\\?[^\\s\\x0b#]*)?(?:#[^\\s\\x0b]*)?|(?:connect (?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\.?(?::[0-9]+)?|[\\--9A-Z_a-z]+:[0-9]+)|options \\*|[a-z]{3,10}[\\s\\x0b]+(?:[0-9A-Z_a-z]{3,7}?://[\\--9A-Z_a-z]*(?::[0-9]+)?)?/[^#\\?]*(?:\\?[^\\s\\x0b#]*)?(?:#[^\\s\\x0b]*)?)[\\s\\x0b]+[\\.-9A-Z_a-z]+)$"},"actions":["Block",{"Msg":"Invalid HTTP Request Line"},{"LogData":"%{request_line}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920100,"phase":1,"chain":false}},{"id":"920160","description":"Content-Length HTTP header is not numeric","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^\\d+$"},"actions":["Block",{"Msg":"Content-Length HTTP header is not numeric"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920160,"phase":1,"chain":false}},{"id":"920170","description":"GET or HEAD Request with Body Content","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"^(?:GET|HEAD)$"},"actions":["Block",{"Msg":"GET or HEAD Request with Body Content"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920170,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^0?$"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920171","description":"GET or HEAD Request with Transfer-Encoding","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"^(?:GET|HEAD)$"},"actions":["Block",{"Msg":"GET or HEAD Request with Transfer-Encoding"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920171,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Transfer-Encoding"},"count":true,"negation":false}],"operator":{"Rx":"!@eq 0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920180","description":"POST without Content-Length and Transfer-Encoding headers","enabled":true,"details":{"variables":[{"variable":"RequestProtocol","count":false,"negation":false}],"operator":{"Rx":"!@within HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0"},"actions":["Block",{"Msg":"POST without Content-Length and Transfer-Encoding headers"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920180,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"StrEq":"POST"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Transfer-Encoding"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920181","description":"Content-Length and Transfer-Encoding headers present","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Transfer-Encoding"},"count":true,"negation":false}],"operator":{"Rx":"!@eq 0"},"actions":["Block",{"Msg":"Content-Length and Transfer-Encoding headers present"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920181,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":true,"negation":false}],"operator":{"Rx":"!@eq 0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920190","description":"Range: Invalid Last Byte Value","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Request-Range"},"count":false,"negation":false}],"operator":{"Rx":"(\\d+)-(\\d+)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Range: Invalid Last Byte Value"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920190,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"2"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920210","description":"Multiple/Conflicting Connection Header Data Found","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Connection"},"count":false,"negation":false}],"operator":{"Rx":"\\b(?:keep-alive|close),\\s?(?:keep-alive|close)\\b"},"actions":["Block",{"Msg":"Multiple/Conflicting Connection Header Data Found"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920210,"phase":1,"chain":false}},{"id":"920250","description":"UTF8 Encoding Abuse Attack Attempt","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"CRS_VALIDATE_UTF8_ENCODING"},"count":false,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"UTF8 Encoding Abuse Attack Attempt"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920250,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"@validateUtf8Encoding"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920260","description":"Unicode Full/Half Width Abuse Attack Attempt","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"(?i)%uff[0-9a-f]{2}"},"actions":["Block",{"Msg":"Unicode Full/Half Width Abuse Attack Attempt"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267/72"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920260,"phase":2,"chain":false}},{"id":"920270","description":"Invalid character in request (null character)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"@validateByteRange 1-255"},"actions":["Block",{"Msg":"Invalid character in request (null character)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920270,"phase":2,"chain":false}},{"id":"920280","description":"Request Missing a Host Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Host"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Block",{"Msg":"Request Missing a Host Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SkipAfter":"END-HOST-CHECK"}],"transformations":[],"id":920280,"phase":1,"chain":false}},{"id":"920290","description":"Empty Host Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Host"},"count":false,"negation":false}],"operator":{"Rx":"^$"},"actions":["Block",{"Msg":"Empty Host Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920290,"phase":1,"chain":false}},{"id":"920310","description":"Request Has an Empty Accept Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept"},"count":false,"negation":false}],"operator":{"Rx":"^$"},"actions":["Block",{"Msg":"Request Has an Empty Accept Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"}],"transformations":[],"id":920310,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"!@rx ^OPTIONS$"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"!@pm AppleWebKit Android Business Enterprise Entreprise"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920311","description":"Request Has an Empty Accept Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept"},"count":false,"negation":false}],"operator":{"Rx":"^$"},"actions":["Block",{"Msg":"Request Has an Empty Accept Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"}],"transformations":[],"id":920311,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"!@rx ^OPTIONS$"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920330","description":"Empty User Agent Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"^$"},"actions":["Block",{"Msg":"Empty User Agent Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":920330,"phase":1,"chain":false}},{"id":"920340","description":"Content-Type header missing from request with non-zero Content-Length","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^0$"},"actions":["Block",{"Msg":"Content-Type header missing from request with non-zero Content-Length"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920340,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920350","description":"Host header is a numeric IP address","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Host"},"count":false,"negation":false}],"operator":{"Rx":"(?:^([\\d.]+|\\[[\\da-f:]+\\]|[\\da-f:]+)(:[\\d]+)?$)"},"actions":["Block",{"Msg":"Host header is a numeric IP address"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920350,"phase":1,"chain":false}},{"id":"920380","description":"Too many arguments in request","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"MAX_NUM_ARGS"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Too many arguments in request"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920380,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":true,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920360","description":"Argument name too long","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ARG_NAME_LENGTH"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Argument name too long"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920360,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Length"],"id":0,"phase":2,"chain":false}},{"id":"920370","description":"Argument value too long","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ARG_LENGTH"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Argument value too long"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920370,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Length"],"id":0,"phase":2,"chain":false}},{"id":"920390","description":"Total arguments size exceeded","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"TOTAL_ARG_LENGTH"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Total arguments size exceeded"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920390,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"ArgsCombinedSize","count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920400","description":"Uploaded file size too large","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"MAX_FILE_SIZE"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Uploaded file size too large"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920400,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^(?i)multipart/form-data"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920410","description":"Total uploaded files size too large","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"COMBINED_FILE_SIZES"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Total uploaded files size too large"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920410,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES_COMBINED_SIZE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920420","description":"Request content type is not allowed by policy","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^[^;\\s]+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Request content type is not allowed by policy"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.content_type=|%{tx.0}|"}],"transformations":[],"id":920420,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"content_type"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"content_type_charset"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Ctl":["","forceRequestBodyVariable=On"]},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"920530","description":"Multiple charsets detected in content type header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"charset.*?charset"},"actions":["Block",{"Msg":"Multiple charsets detected in content type header"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":920530,"phase":1,"chain":false}},{"id":"920640","description":"Content-Type header missing from request with body","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_BODY_LENGTH"},"count":false,"negation":false}],"operator":{"Gt":0},"actions":["Block",{"Msg":"Content-Type header missing from request with body"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920640,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920430","description":"HTTP protocol version is not allowed by policy","enabled":true,"details":{"variables":[{"variable":"RequestProtocol","count":false,"negation":false}],"operator":"NoOp","actions":["Block",{"Msg":"HTTP protocol version is not allowed by policy"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920430,"phase":1,"chain":false}},{"id":"920440","description":"URL file extension is restricted by policy","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false}],"operator":{"Rx":"\\.([^.]+)$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"URL file extension is restricted by policy"},{"LogData":"%{TX.0}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.extension=.%{tx.1}/"}],"transformations":["UrlDecodeUni"],"id":920440,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"EXTENSION"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"920500","description":"Attempt to access a backup or working file","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"Rx":"\\.[^.~]+~(?:/.*|)$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Attempt to access a backup or working file"},{"LogData":"%{TX.0}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920500,"phase":1,"chain":false}},{"id":"920450","description":"HTTP header is restricted by policy (%{MATCHED_VAR})","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_HEADERS_NAMES"},"count":false,"negation":false}],"operator":{"Rx":"^.*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP header is restricted by policy (%{MATCHED_VAR})"},{"LogData":"Restricted header detected: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.header_name_920450_%{tx.0}=/%{tx.0}/"}],"transformations":["Lowercase"],"id":920450,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"/^header_name_920450_/"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920520","description":"Accept-Encoding header exceeded sensible length","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept-Encoding"},"count":false,"negation":false}],"operator":{"Gt":100},"actions":["Block",{"Msg":"Accept-Encoding header exceeded sensible length"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase","Length"],"id":920520,"phase":1,"chain":false}},{"id":"920540","description":"Possible Unicode character bypass detected","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQBODY_PROCESSOR"},"count":false,"negation":false}],"operator":{"Rx":"!@streq JSON"},"actions":["Block",{"Msg":"Possible Unicode character bypass detected"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267/72"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920540,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"(?i)\\x5cu[0-9a-f]{4}"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920610","description":"Raw (unencoded) fragment in request URI","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false}],"operator":{"Contains":"#"},"actions":["Block",{"Msg":"Raw (unencoded) fragment in request URI"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920610,"phase":1,"chain":false}},{"id":"920620","description":"Multiple Content-Type Request Headers","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":true,"negation":false}],"operator":{"Gt":1},"actions":["Block",{"Msg":"Multiple Content-Type Request Headers"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920620,"phase":1,"chain":false}},{"id":"920013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920013,"phase":1,"chain":false}},{"id":"920014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920014,"phase":2,"chain":false}},{"id":"920200","description":"Range: Too many fields (6 or more)","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Request-Range"},"count":false,"negation":false}],"operator":{"Rx":"^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}"},"actions":["Block",{"Msg":"Range: Too many fields (6 or more)"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920200,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false}],"operator":{"Rx":"!@endsWith .pdf"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920201","description":"Range: Too many fields for pdf request (63 or more)","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false}],"operator":{"EndsWith":".pdf"},"actions":["Block",{"Msg":"Range: Too many fields for pdf request (63 or more)"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":["UrlDecodeUni"],"id":920201,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Request-Range"},"count":false,"negation":false}],"operator":{"Rx":"^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){63}"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920230","description":"Multiple URL Encoding Detected","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"%[0-9a-fA-F]{2}"},"actions":["Block",{"Msg":"Multiple URL Encoding Detected"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267/120"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920230,"phase":2,"chain":false}},{"id":"920271","description":"Invalid character in request (non printable characters)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"@validateByteRange 9,10,13,32-126,128-255"},"actions":["Block",{"Msg":"Invalid character in request (non printable characters)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920271,"phase":2,"chain":false}},{"id":"920320","description":"Missing User Agent Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Block",{"Msg":"Missing User Agent Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":920320,"phase":1,"chain":false}},{"id":"920451","description":"HTTP header is restricted by policy (%{MATCHED_VAR})","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_HEADERS_NAMES"},"count":false,"negation":false}],"operator":{"Rx":"^.*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP header is restricted by policy (%{MATCHED_VAR})"},{"LogData":"Restricted header detected: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.header_name_920451_%{tx.0}=/%{tx.0}/"}],"transformations":["Lowercase"],"id":920451,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"/^header_name_920451_/"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920240","description":"URL Encoding Abuse Attack Attempt","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^(?i)application/x-www-form-urlencoded"},"actions":["Block",{"Msg":"URL Encoding Abuse Attack Attempt"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267/72"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920240,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"\\x25"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"@validateUrlEncoding"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920650","description":"HTTP method override attempt via _method parameter","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allow_method_override_parameter"},"count":false,"negation":false}],"operator":{"Eq":"0"},"actions":["Block",{"Msg":"HTTP method override attempt via _method parameter"},{"LogData":"Requested method override: %{ARGS._method}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920650,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"ArgsSpecific":"_method"},"count":false,"negation":false}],"operator":{"Rx":"^[a-z]{3,10}$"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"920015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920015,"phase":1,"chain":false}},{"id":"920016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920016,"phase":2,"chain":false}},{"id":"920272","description":"Invalid character in request (outside of printable chars below ascii 127)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"@validateByteRange 32-36,38-126"},"actions":["Block",{"Msg":"Invalid character in request (outside of printable chars below ascii 127)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920272,"phase":2,"chain":false}},{"id":"920300","description":"Request Missing an Accept Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Block",{"Msg":"Request Missing an Accept Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"}],"transformations":[],"id":920300,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"!@rx ^(?:OPTIONS|CONNECT)$"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"!@pm AppleWebKit Android"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920490","description":"Request header x-up-devcap-post-charset detected in combination with prefix \\'UP\\' to User-Agent","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"x-up-devcap-post-charset"},"count":true,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Block",{"Msg":"Request header x-up-devcap-post-charset detected in combination with prefix \\'UP\\' to User-Agent"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"language-aspnet"},{"Tag":"platform-windows"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920490,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"^(?i)up"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920510","description":"Invalid Cache-Control request header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Cache-Control"},"count":true,"negation":false}],"operator":{"Gt":0},"actions":["Block",{"Msg":"Invalid Cache-Control request header"},{"LogData":"Invalid Cache-Control value in request found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"header-allowlist"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920510,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Cache-Control"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^(?:(?:max-age=[0-9]+|min-fresh=[0-9]+|no-cache|no-store|no-transform|only-if-cached|max-stale(?:=[0-9]+)?)(?:\\s*\\,\\s*|$)){1,7}$"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920521","description":"Illegal Accept-Encoding header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"!@rx br|compress|deflate|(?:pack200-)?gzip|identity|\\*|^$|aes128gcm|exi|zstd|x-(?:compress|gzip)"},"actions":["Block",{"Msg":"Illegal Accept-Encoding header"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":920521,"phase":1,"chain":false}},{"id":"920017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920017,"phase":1,"chain":false}},{"id":"920018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920018,"phase":2,"chain":false}},{"id":"920202","description":"Range: Too many fields for pdf request (6 or more)","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false}],"operator":{"EndsWith":".pdf"},"actions":["Block",{"Msg":"Range: Too many fields for pdf request (6 or more)"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":["UrlDecodeUni"],"id":920202,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Request-Range"},"count":false,"negation":false}],"operator":{"Rx":"^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920273","description":"Invalid character in request (outside of very strict set)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"@validateByteRange 38,44-46,48-58,61,65-90,95,97-122"},"actions":["Block",{"Msg":"Invalid character in request (outside of very strict set)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920273,"phase":2,"chain":false}},{"id":"920274","description":"Invalid character in request headers (outside of very strict set)","enabled":true,"details":{"variables":[{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Cookie"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Sec-Fetch-User"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Sec-CH-UA"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Sec-CH-UA-Mobile"},"count":false,"negation":true}],"operator":{"Rx":"@validateByteRange 32,34,38,42-59,61,65-90,95,97-122"},"actions":["Block",{"Msg":"Invalid character in request headers (outside of very strict set)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920274,"phase":1,"chain":false}},{"id":"920275","description":"Invalid character in request headers (outside of very strict set)","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Sec-Fetch-User"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Sec-CH-UA-Mobile"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^(?:\\?[01])?$"},"actions":["Block",{"Msg":"Invalid character in request headers (outside of very strict set)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920275,"phase":1,"chain":false}},{"id":"920460","description":"Abnormal character escapes in request","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"(?:^|[^\\x5c])\\x5c[cdeghijklmpqwxyz123456789]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Abnormal character escapes in request"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/153/267"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode","Lowercase"],"id":920460,"phase":2,"chain":false}},{"id":"921011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921011,"phase":1,"chain":false}},{"id":"921012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921012,"phase":2,"chain":false}},{"id":"921110","description":"HTTP Request Smuggling Attack","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:get|post|head|options|connect|put|delete|trace|track|patch|propfind|propatch|mkcol|copy|move|lock|unlock)\\s+[^\\s]+\\s+http/\\d"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Request Smuggling Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode","Lowercase"],"id":921110,"phase":2,"chain":false}},{"id":"921120","description":"HTTP Response Splitting Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"[\\r\\n]\\W*?(?:content-(?:type|length)|set-cookie|location):\\s*\\w"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Response Splitting Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/34"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921120,"phase":2,"chain":false}},{"id":"921130","description":"HTTP Response Splitting Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:\\bhttp/\\d|<(?:html|meta)\\b)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Response Splitting Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/34"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode","Lowercase"],"id":921130,"phase":2,"chain":false}},{"id":"921140","description":"HTTP Header Injection Attack via headers","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_HEADERS_NAMES"},"count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Header Injection Attack via headers"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/273"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":921140,"phase":1,"chain":false}},{"id":"921150","description":"HTTP Header Injection Attack via payload (CR/LF detected)","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Header Injection Attack via payload (CR/LF detected)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921150,"phase":2,"chain":false}},{"id":"921160","description":"HTTP Header Injection Attack via payload (CR/LF and header-name detected)","enabled":true,"details":{"variables":[{"variable":{"Tx":"ARGS_GET_NAMES"},"count":false,"negation":false},{"variable":{"Tx":"ARGS_GET"},"count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]+(?:\\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\\s*:"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Header Injection Attack via payload (CR/LF and header-name detected)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921160,"phase":1,"chain":false}},{"id":"921190","description":"HTTP Splitting (CR/LF in request filename detected)","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Splitting (CR/LF in request filename detected)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/34"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":921190,"phase":1,"chain":false}},{"id":"921200","description":"LDAP Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"^[^:\\(\\)\\&\\|\\!<>\\~]*\\)\\s*(?:\\((?:[^,\\(\\)\\=\\&\\|\\!<>\\~]+[><~]?=|\\s*[&!|]\\s*(?:\\)|\\()?\\s*)|\\)\\s*\\(\\s*[\\&\\|\\!]\\s*|[&!|]\\s*\\([^\\(\\)\\=\\&\\|\\!<>\\~]+[><~]?=[^:\\(\\)\\&\\|\\!<>\\~]*)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"LDAP Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-ldap"},{"Tag":"platform-multi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/248/136"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode"],"id":921200,"phase":2,"chain":false}},{"id":"921421","description":"Content-Type header: Dangerous content type outside the mime type declaration","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^[^\\s\\x0b,;]+[\\s\\x0b,;].*?(?:application/(?:.+\\+)?json|(?:application/(?:soap\\+)?|text/)xml)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Content-Type header: Dangerous content type outside the mime type declaration"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921421,"phase":1,"chain":false}},{"id":"921240","description":"mod_proxy attack attempt detected","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false}],"operator":{"Rx":"unix:[^|]*\\|"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"mod_proxy attack attempt detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-apache"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","Lowercase"],"id":921240,"phase":1,"chain":false}},{"id":"921250","description":"Old Cookies V1 usage attempt detected","enabled":true,"details":{"variables":[{"variable":{"RequestCookiesSpecific":"/\\x22?\\x24Version/"},"count":false,"negation":false}],"operator":{"StrEq":"1"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Old Cookies V1 usage attempt detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921250,"phase":1,"chain":false}},{"id":"921013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921013,"phase":1,"chain":false}},{"id":"921014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921014,"phase":2,"chain":false}},{"id":"921151","description":"HTTP Header Injection Attack via payload (CR/LF detected)","enabled":true,"details":{"variables":[{"variable":{"Tx":"ARGS_GET"},"count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Header Injection Attack via payload (CR/LF detected)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921151,"phase":1,"chain":false}},{"id":"921422","description":"Content-Type header: Dangerous content type outside the mime type declaration","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^[^\\s\\x0b,;]+[\\s\\x0b,;].*?\\b(?:((?:tex|multipar)t|application)|((?:audi|vide)o|image|cs[sv]|(?:vn|relate)d|p(?:df|lain)|json|(?:soa|cs)p|x(?:ml|-www-form-urlencoded)|form-data|x-amf|(?:octe|repor)t|stream)|([\\+/]))\\b"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Content-Type header: Dangerous content type outside the mime type declaration"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921422,"phase":1,"chain":false}},{"id":"921015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921015,"phase":1,"chain":false}},{"id":"921016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921016,"phase":2,"chain":false}},{"id":"921230","description":"HTTP Range Header detected","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":true,"negation":false}],"operator":{"Gt":0},"actions":["Block",{"Msg":"HTTP Range Header detected"},{"LogData":"Matched Data: Header %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921230,"phase":1,"chain":false}},{"id":"921170","description":"No description","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"."},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/137/15/460"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"TX.paramcounter_%{MATCHED_VAR_NAME}=+1"}],"transformations":[],"id":921170,"phase":2,"chain":false}},{"id":"921180","description":"HTTP Parameter Pollution (%{MATCHED_VAR_NAME})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"/paramcounter_.*/"},"count":false,"negation":false}],"operator":{"Gt":1},"actions":["Block",{"Msg":"HTTP Parameter Pollution (%{MATCHED_VAR_NAME})"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/137/15/460"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921180,"phase":2,"chain":false}},{"id":"921210","description":"HTTP Parameter Pollution after detecting bogus char after parameter array","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"(][^\\]]+$|][^\\]]+\\[)"},"actions":["Block",{"Tag":"FLAG:capture"},"Log",{"Msg":"HTTP Parameter Pollution after detecting bogus char after parameter array"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/137/15/460"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921210,"phase":2,"chain":false}},{"id":"921017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921017,"phase":1,"chain":false}},{"id":"921018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921018,"phase":2,"chain":false}},{"id":"921220","description":"HTTP Parameter Pollution possible via array notation","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"\\["},"actions":["Block",{"Tag":"FLAG:capture"},"Log",{"Msg":"HTTP Parameter Pollution possible via array notation"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/137/15/460"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921220,"phase":2,"chain":false}},{"id":"922100","description":"Multipart content type global _charset_ definition is not allowed by policy","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"MULTIPART_PART_HEADERS:_charset_"},"count":true,"negation":false}],"operator":{"Rx":"!@eq 0"},"actions":["Block",{"Msg":"Multipart content type global _charset_ definition is not allowed by policy"},{"LogData":"Matched Data: %{ARGS._charset_}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-multipart-header"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.922100_charset=|%{ARGS._charset_}|"}],"transformations":[],"id":922100,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"922100_CHARSET"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"922140","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MULTIPART_PART_HEADERS"},"count":true,"negation":false}],"operator":{"Gt":0},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"attack-multipart-header"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.multipart_headers_content_counter=0"}],"transformations":[],"id":922140,"phase":2,"chain":false}},{"id":"922150","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MULTIPART_PART_HEADERS"},"count":false,"negation":false}],"operator":{"Rx":"^content-type\\s*:\\s*(.*)$"},"actions":["Pass",{"Tag":"FLAG:capture"},{"Tag":"FLAG:nolog"},{"Tag":"attack-multipart-header"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.multipart_headers_content_types_%{tx.multipart_headers_content_counter}=%{tx.1}"},{"SetVar":"tx.multipart_headers_content_counter=+1"}],"transformations":["Lowercase"],"id":922150,"phase":2,"chain":false}},{"id":"922120","description":"Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used","enabled":true,"details":{"variables":[{"variable":{"Tx":"MULTIPART_PART_HEADERS"},"count":false,"negation":false}],"operator":{"Rx":"content-transfer-encoding:(.*)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used"},{"LogData":"Matched Data: %{TX.0}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-multipart-header"},{"Tag":"attack-deprecated-header"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Tag":"capec/272/220"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":922120,"phase":2,"chain":false}},{"id":"922130","description":"Multipart header contains characters outside of valid range","enabled":true,"details":{"variables":[{"variable":{"Tx":"MULTIPART_PART_HEADERS"},"count":false,"negation":false}],"operator":{"Rx":"[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Multipart header contains characters outside of valid range"},{"LogData":"Matched Data: %{TX.0}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-multipart-header"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Tag":"capec/272/220"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":922130,"phase":2,"chain":false}},{"id":"930011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930011,"phase":1,"chain":false}},{"id":"930012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930012,"phase":2,"chain":false}},{"id":"930100","description":"Path Traversal Attack (/../) or (/.../)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":true},{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[56]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))(?:\\.(?:%0[01]|\\?)?|\\?\\.?|%(?:2(?:(?:5(?:2|c0%25a))?e|%45)|c0(?:\\.|%[256aef]e)|u(?:(?:ff0|002)e|2024)|%32(?:%(?:%6|4)5|E)|(?:e|f(?:(?:8|c%80)%8)?0%8)0%80%ae)|0x2e){2,3}(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[56]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Path Traversal Attack (/../) or (/.../)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":930100,"phase":2,"chain":false}},{"id":"930110","description":"Path Traversal Attack (/../) or (/.../)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":true},{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Path Traversal Attack (/../) or (/.../)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","RemoveNulls"],"id":930110,"phase":2,"chain":false}},{"id":"930120","description":"OS File Access Attempt","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"lfi-os-files.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"OS File Access Attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":930120,"phase":2,"chain":false}},{"id":"930130","description":"Restricted File Access Attempt","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"PmFromFile":"restricted-files.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Restricted File Access Attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":930130,"phase":1,"chain":false}},{"id":"930013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930013,"phase":1,"chain":false}},{"id":"930014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930014,"phase":2,"chain":false}},{"id":"930121","description":"OS File Access Attempt in REQUEST_HEADERS","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"PmFromFile":"lfi-os-files.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"OS File Access Attempt in REQUEST_HEADERS"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":930121,"phase":1,"chain":false}},{"id":"930015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930015,"phase":1,"chain":false}},{"id":"930016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930016,"phase":2,"chain":false}},{"id":"930017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930017,"phase":1,"chain":false}},{"id":"930018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930018,"phase":2,"chain":false}},{"id":"931011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931011,"phase":1,"chain":false}},{"id":"931012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931012,"phase":2,"chain":false}},{"id":"931100","description":"Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)^(file|ftps?|https?|ssh)://(?:\\[?[a-f0-9]+:[a-f0-9:]+\\]?|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":931100,"phase":2,"chain":false}},{"id":"931110","description":"Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload","enabled":true,"details":{"variables":[{"variable":"QueryString","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"(?i)(?:\\binclude\\s*\\([^)]*|mosConfig_absolute_path|_CONF\\[path\\]|_SERVER\\[DOCUMENT_ROOT\\]|GALLERY_BASEDIR|path\\[docroot\\]|appserv_root|config\\[root_dir\\])=(?:file|ftps?|https?)://"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":931110,"phase":2,"chain":false}},{"id":"931120","description":"Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"^(?i:file|ftps?|https?).*?\\?+$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":931120,"phase":2,"chain":false}},{"id":"931013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931013,"phase":1,"chain":false}},{"id":"931014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931014,"phase":2,"chain":false}},{"id":"931130","description":"Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}"}],"transformations":[],"id":931130,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"/rfi_parameter_.*/"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.rfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"931131","description":"Possible Remote File Inclusion (RFI) Attack","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"Rx":"(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[^@]+@)?([^/]*)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":931131,"phase":1,"chain":false}},{"id":"931015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931015,"phase":1,"chain":false}},{"id":"931016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931016,"phase":2,"chain":false}},{"id":"931017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931017,"phase":1,"chain":false}},{"id":"931018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931018,"phase":2,"chain":false}},{"id":"932011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932011,"phase":1,"chain":false}},{"id":"932012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932012,"phase":2,"chain":false}},{"id":"932120","description":"Remote Command Execution: Windows PowerShell Command Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"windows-powershell-commands.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Windows PowerShell Command Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"language-powershell"},{"Tag":"platform-windows"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932120,"phase":2,"chain":false}},{"id":"932130","description":"Remote Command Execution: Unix Shell Expression Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Expression Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932130,"phase":2,"chain":false}},{"id":"932140","description":"Remote Command Execution: Windows FOR/IF Command Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Windows FOR/IF Command Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-windows"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932140,"phase":2,"chain":false}},{"id":"932270","description":"Remote Command Execution: Unix Shell Expression Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"~[\\+\\-](?:$|[0-9]+)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Expression Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932270,"phase":2,"chain":false}},{"id":"932280","description":"Remote Command Execution: Brace Expansion Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\{[0-9A-Z_a-z]*,[,\\-0-9A-Z_a-z]*\\}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Brace Expansion Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932280,"phase":2,"chain":false}},{"id":"932330","description":"Remote Command Execution: Unix shell history invocation","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"!-\\d"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix shell history invocation"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932330,"phase":2,"chain":false}},{"id":"932160","description":"Remote Command Execution: Unix Shell Code Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"unix-shell.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Code Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":932160,"phase":2,"chain":false}},{"id":"932170","description":"Remote Command Execution: Shellshock (CVE-2014-6271)","enabled":true,"details":{"variables":[{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"RequestLine","count":false,"negation":false}],"operator":{"Rx":"^\\(\\s*\\)\\s+\\{"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Shellshock (CVE-2014-6271)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":932170,"phase":1,"chain":false}},{"id":"932171","description":"Remote Command Execution: Shellshock (CVE-2014-6271)","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"Tx":"FILES_NAMES"},"count":false,"negation":false}],"operator":{"Rx":"^\\(\\s*\\)\\s+\\{"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Shellshock (CVE-2014-6271)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":932171,"phase":2,"chain":false}},{"id":"932180","description":"Restricted File Upload Attempt","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"PmFromFile":"restricted-upload.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Restricted File Upload Attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":932180,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"!@rx (?i)(?:\\.boto|buddyinfo|mtrr|acpi|zoneinfo)\\B"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932013,"phase":1,"chain":false}},{"id":"932014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932014,"phase":2,"chain":false}},{"id":"932131","description":"Remote Command Execution: Unix Shell Expression Found","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"\\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Expression Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932131,"phase":1,"chain":false}},{"id":"932200","description":"RCE Bypass Technique","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RCE Bypass Technique"},{"LogData":"Matched Data: %{TX.0} found within %{TX.932200_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.932200_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase","UrlDecodeUni"],"id":932200,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"/"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"\\s"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932205","description":"RCE Bypass Technique","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"^[^#]+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RCE Bypass Technique"},{"LogData":"Matched Data: %{TX.2} found within %{TX.932205_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.932205_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase","UrlDecodeUni"],"id":932205,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"0"},"count":false,"negation":false}],"operator":{"Rx":"^[^\\.]+\\.[^;\\?]+[;\\?](.*(['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]))"},"actions":[{"Tag":"FLAG:capture"}],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":{"Rx":"/"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":{"Rx":"\\s"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932206","description":"RCE Bypass Technique","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"^[^\\.]*?(?:['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RCE Bypass Technique"},{"LogData":"Matched Data: %{TX.0} found within %{TX.932206_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.932206_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase","UrlDecodeUni"],"id":932206,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"/"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"\\s"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932207","description":"RCE Bypass Technique","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"#.*"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RCE Bypass Technique"},{"LogData":"Matched Data: %{TX.0} found within %{TX.932207_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.932207_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase","UrlDecodeUni"],"id":932207,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"0"},"count":false,"negation":false}],"operator":{"Rx":"['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]"},"actions":[{"Tag":"FLAG:capture"}],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VAR"},"count":false,"negation":false}],"operator":{"Rx":"/"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VAR"},"count":false,"negation":false}],"operator":{"Rx":"\\s"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VAR"},"count":false,"negation":false}],"operator":{"Rx":"!@beginsWith #:~:text="},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"!@rx [0-9]\\s*\\'\\s*[0-9]"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932281","description":"Remote Command Execution: Brace Expansion Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\{[^\\s\\x0b,:\\}]*,[^\\s\\x0b]*\\}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Brace Expansion Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932281,"phase":2,"chain":false}},{"id":"932271","description":"Remote Command Execution: Unix Shell Expression Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"~[0-9]+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Expression Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932271,"phase":2,"chain":false}},{"id":"932300","description":"Remote Command Execution: SMTP Command Execution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\r\\n.*?\\b(?:E(?:HLO[\\s\\x0b][\\-\\.a-z]{1,255}|XPN[\\s\\x0b].{1,64})|HELO[\\s\\x0b][\\-\\.a-z]{1,255}|MAIL[\\s\\x0b]FROM:<.{1,64}@.{1,255}>|R(?:CPT[\\s\\x0b]TO:(?:<.{1,64}@.{1,255}>| )?<.{1,64}>|SET\\b)|VRFY[\\s\\x0b].{1,64}(?:[\\s\\x0b]<.{1,64}@.{1,255}>|@.{1,255})|AUTH[\\s\\x0b][\\-0-9_a-z]{1,20}[\\s\\x0b](?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=|STARTTLS\\b|NOOP\\b(?:[\\s\\x0b].{1,255})?)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: SMTP Command Execution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/137/134"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932300,"phase":2,"chain":false}},{"id":"932320","description":"Remote Command Execution: POP3 Command Execution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?is)\\r\\n.*?\\b(?:(?:LIST|TOP [0-9]+)(?: [0-9]+)?|U(?:SER .+?|IDL(?: [0-9]+)?)|PASS .+?|(?:RETR|DELE) [0-9]+?|A(?:POP [0-9A-Z_a-z]+ [0-9a-f]{32}|UTH [\\-0-9_a-z]{1,20} (?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: POP3 Command Execution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/137/134"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932320,"phase":2,"chain":false}},{"id":"932161","description":"Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"PmFromFile":"unix-shell.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":932161,"phase":1,"chain":false}},{"id":"932015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932015,"phase":1,"chain":false}},{"id":"932016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932016,"phase":2,"chain":false}},{"id":"932237","description":"Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|(?:(?:GE|POS)T|y(?:e(?:s|lp)|um|arn)|HEAD)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get|itude(?:[\\s\\x0b&\\),<>\\|]|$))|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:[\\s\\x0b&\\),<>\\|]|$|h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|t(?:[\\s\\x0b&\\),<>\\|]|$|obm(?:[\\s\\x0b&\\),<>\\|]|$))|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|io(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:t(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|on(?:[\\s\\x0b&\\),<>\\|]|$|tab)))|d(?:(?:[dfu]|i(?:(?:alo)?g|r|ff)|a(?:sh|te)|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|nf(?:[\\s\\x0b&\\),<>\\|]|$)?|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:[bd]|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|le(?:[\\s\\x0b&\\),<>\\|]|$|test)|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|d(?:(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oupmod)|tester|unzip)|h(?:(?:d|up|ash|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:(?:d|rb|conv|nstall)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|ava|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|[qx](?:[\\s\\x0b&\\),<>\\|]|$)))|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:(?:re|unt)(?:[\\s\\x0b&\\),<>\\|]|$)|squitto)|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|cman|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|hp(?:[\\s\\x0b&\\),<>\\|]|$|-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[\\s\\x0b&\\),<>\\|]|$|[^\\s\\x0b]{1,10}\\b)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|(?:(?:w|op)d|xz|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|y(?:3?versions|thon[23]))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|name|p(?:eat|lace))(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|r(?:een|ipt))|g|ash|diff|ftp|l(?:eep|sh)|plit)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|u(?:f|tdown)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|h(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass))|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:(?:(?:ca|r)t|urce)(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|qlite3|t(?:art-stop-daemon|dbuf|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|sk(?:[\\s\\x0b&\\),<>\\|]|$|set))|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|me(?:[\\s\\x0b&\\),<>\\|]|$|datectl|out(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:l?sh(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:dump|ing|traceroute))|r(?:a(?:ceroute6?|p(?:[\\s\\x0b&\\),<>\\|]|$))|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:ame|compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|p(?:2date(?:[\\s\\x0b&\\),<>\\|]|$)|date-alternatives)|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:[\\s\\x0b&\\),<>\\|]|$|m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:[ep]w|gr|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|a(?:ll|tch))(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:o(?:[\\s\\x0b&\\),<>\\|]|$|ami|is(?:[\\s\\x0b&\\),<>\\|]|$))?|iptail(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|[ef]grep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))(?:\\b|[^0-9A-Z_a-z])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":932237,"phase":1,"chain":false}},{"id":"932190","description":"Remote Command Execution: Wildcard bypass technique attempt","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"/(?:[?*]+[a-z/]+|[a-z/]+[?*]+)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Wildcard bypass technique attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":932190,"phase":2,"chain":false}},{"id":"932301","description":"Remote Command Execution: SMTP Command Execution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\r\\n.*?\\b(?:DATA|QUIT|HELP(?: .{1,255})?)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: SMTP Command Execution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/137/134"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932301,"phase":2,"chain":false}},{"id":"932321","description":"Remote Command Execution: POP3 Command Execution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\r\\n.*?\\b(?:(?:QUI|STA|RSE)T|NOOP|CAPA)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: POP3 Command Execution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/137/134"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932321,"phase":2,"chain":false}},{"id":"932331","description":"Remote Command Execution: Unix shell history invocation","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"!(?:\\d|!)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix shell history invocation"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932331,"phase":2,"chain":false}},{"id":"932017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932017,"phase":1,"chain":false}},{"id":"932018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932018,"phase":2,"chain":false}},{"id":"933011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933011,"phase":1,"chain":false}},{"id":"933012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933012,"phase":2,"chain":false}},{"id":"933100","description":"PHP Injection Attack: PHP Open Tag Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<\\?(?:[^x]|x(?:[^m]|m(?:[^l]|l(?:[^\\s\\x0b]|[\\s\\x0b]+[^a-z]|$)))|$|php)|\\[[/\\x5c]?php\\]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Open Tag Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933100,"phase":2,"chain":false}},{"id":"933110","description":"PHP Injection Attack: PHP Script File Upload Found","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X.Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"Rx":".*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Script File Upload Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":933110,"phase":2,"chain":false}},{"id":"933120","description":"PHP Injection Attack: Configuration Directive Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:llow_url_(?:fopen|include)|pc.(?:coredump_unmap|en(?:able(?:_cli|d)|tries_hint)|(?:gc_)?ttl|mmap_file_mask|preload_path|s(?:erializer|hm_s(?:egments|ize)|lam_defense)|use_request_time)|rg_separator.(?:in|out)put|ssert.(?:active|(?:bai|quiet_eva)l|callback|exception|warning)|uto_(?:(?:ap|pre)pend_file|detect_line_endings|globals_jit))|b(?:cmath.scale|rowscap)|c(?:gi.(?:check_shebang_line|(?:discard_pat|np)h|f(?:ix_pathinfo|orce_redirect)|r(?:edirect_status_env|fc2616_headers))|hild_terminate|li(?:_server.color|.p(?:ager|rompt))|om.(?:a(?:llow_dcom|utoregister_(?:(?:casesensitiv|verbos)e|typelib))|(?:code_pag|typelib_fil)e|dotnet_version)|url.cainfo)|d(?:ate.(?:(?:default_l(?:at|ong)itud|timezon)e|sun(?:rise|set)_zenith)|ba.default_handler|efault_(?:(?:charse|socket_timeou)t|mimetype)|is(?:able_(?:classe|function)|play_(?:startup_)?error)s|oc(?:_roo|ref_(?:ex|roo))t)|e(?:n(?:able_(?:dl|post_data_reading)|gine)|rror_(?:(?:(?:ap|pre)pend_str|report)in|lo)g|x(?:i(?:f.(?:decode_(?:jis|unicode)_(?:intel|motorola)|encode_(?:jis|unicode))|t_on_timeout)|tension(?:_dir)?|p(?:ect.(?:log(?:file|user)|match_max|timeout)|ose_php)))|f(?:astcgi.(?:impersonate|logging)|fi.(?:enable|preload)|il(?:e_uploads|ter.default(?:_flags)?))|g(?:d.jpeg_ignore_warning|eoip.custom_directory)|h(?:ard_timeout|ighlight.(?:(?:commen|defaul)t|html|keyword|string)|tml_errors)|i(?:b(?:ase.(?:(?:allow_persisten|time(?:stamp)?forma)t|d(?:ateformat|efault_(?:charset|db|password|user))|max_(?:links|persistent))|m_db2.(?:binmode|i(?:5_(?:all(?:_pconnec|ow_commi)t|dbcs_alloc|ignore_userid)|nstance_name)))|conv.(?:in(?:put|ternal)|output)_encoding|g(?:binary.compact_strings|nore_(?:repeated_(?:errors|source)|user_abort))|m(?:a(?:gick.(?:locale_fix|progress_monitor|skip_version_check)|p.enable_insecure_rsh)|plicit_flush)|n(?:clude_path|put_encoding|t(?:ernal_encoding|l.(?:default_locale|error_level|use_exceptions))))|l(?:dap.max_links|og_errors(?:_max_len)?)|m(?:a(?:gic_quotes_(?:gpc|runtime)|il(?:.(?:add_x_header|force_extra_parameters|log)|parse.def_charset)|x_(?:execution_time|file_uploads|input_(?:nesting_level|time|vars)))|bstring.(?:detect_order|encoding_translation|func_overload|http_(?:input|output(?:_conv_mimetypes)?)|internal_encoding|language|regex_(?:retry|stack)_limit|s(?:trict_detection|ubstitute_character))|crypt.(?:algorithm|mode)s_dir|em(?:cache(?:.(?:allow_failover|c(?:hunk_size|ompress_threshold)|(?:default_por|lock_timeou)t|hash_(?:function|strategy)|max_failover_attempts|protocol|(?:session_)?redundancy)|d.(?:compression_(?:factor|t(?:hreshold|ype))|default_(?:binary_protocol|con(?:nect_timeout|sistent_hash))|s(?:e(?:rializer|ss_(?:binary(?:_protocol)?|con(?:nect_timeout|sistent_hash(?:_type)?)|lock(?:_(?:expire|retries|wait(?:_m(?:ax|in))?)|ing)|number_of_replicas|p(?:ersistent|refix)|r(?:andomize_replica_read|emove_failed(?:_servers)?)|s(?:asl_(?:password|username)|erver_failure_limit)))|tore_retry_count)|use_sasl))|ory_limit)|ysql(?:.(?:allow_(?:local_infile|persistent)|connect_timeout|default_(?:(?:hos|socke)t|p(?:assword|ort)|user)|max_(?:links|persistent)|trace_mode)|i.(?:allow_(?:local_infile|persistent)|default_(?:(?:hos|socke)t|p(?:ort|w)|user)|local_infile_directory|max_(?:links|persistent)|r(?:econnect|ollback_on_cached_plink))|nd.(?:collect_(?:memory_)?statistics|debug|(?:fetch_data_cop|sha256_server_public_ke)y|log_mask|mempool_default_size|net_(?:cmd_buffer_size|read_(?:buffer_size|timeout))|trace_alloc)))|o(?:ci8.(?:(?:connection_clas|event|old_oci_close_semantic)s|default_prefetch|max_persistent|p(?:ersistent_timeout|ing_interval|r(?:efetch_lob_size|ivileged_connect))|statement_cache_size)|dbc.(?:(?:allow|check)_persistent|default(?:_(?:cursortype|db|pw|user)|binmode|lrl)|max_(?:links|persistent))|p(?:cache.(?:blacklist_filename|c(?:ache_id|onsistency_checks)|dups_fix|e(?:nable(?:_(?:cli|file_override))?|rror_log)|f(?:ast_shutdown|ile_(?:cache(?:_(?:consistency_checks|fallback|only))?|update_protection)|orce_restart_timeout)|(?:huge_code_page|save_comment)s|in(?:herited_hack|terned_strings_buffer)|jit(?:_(?:b(?:isect_limit|(?:lacklist_(?:root|side)_trac|uffer_siz)e)|debug|hot_(?:func|loop|return|side_exit)|max_(?:exit_counter|(?:loop_unro|polymorphic_ca)ll|r(?:ecursive_(?:call|return)|oot_trace)|side_trace)s|prof_threshold))?|lo(?:ckfile_path|g_verbosity_level)|m(?:ax_(?:accelerated_files|(?:file_siz|wasted_percentag)e)|emory_consumption|map_base)|opt(?:_debug|imization)_level|pr(?:e(?:ferred_memory_model|load(?:_user)?)|otect_memory)|re(?:cord_warnings|strict_api|validate_(?:freq|path))|use_cwd|validate_(?:permission|root|timestamps))|en(?:_basedir|ssl.ca(?:file|path)))|utput_(?:(?:buffer|encod)ing|handler))|p(?:cre.(?:(?:backtrack|recursion)_lim|j)it|do(?:_odbc.(?:connection_pooling|db2_instance_name)|.dsn)|gsql.(?:a(?:llow|uto_reset)_persistent|(?:ignore|log)_notice|max_(?:links|persistent))|h(?:ar.(?:cache_list|re(?:adonly|quire_hash))|pdbg.(?:eol|path))|recision|ost_max_size)|r(?:e(?:alpath_cache_(?:size|ttl)|gister_argc_argv|port_(?:memleaks|zend_debug)|quest_order)|unkit.(?:internal_override|superglobal))|s(?:e(?:aslog.(?:appender(?:_retry)?|buffer_(?:disabled_in_cli|size)|d(?:efault_(?:basepath|datetime_format|logger|template)|isting_(?:(?:by_hou|folde)r|type))|ignore_warning|level|re(?:call_depth|mote_(?:hos|por|timeou)t)|t(?:hrow_exception|r(?:ace_(?:e(?:rror|xception)|notice|warning)|im_wrap))|use_buffer)|ndmail_(?:from|path)|rialize_precision|ssion.(?:auto_start|c(?:ache_(?:expire|limiter)|ookie_(?:domain|httponly|(?:lifetim|s(?:amesit|ecur))e|path))|entropy_(?:file|length)|gc_(?:divisor|maxlifetime|probability)|hash_(?:bits_per_character|function)|(?:lazy_writ|nam)e|referer_check|s(?:ave_(?:handler|path)|erialize_handler|id_(?:bits_per_character|length))|trans_sid_(?:host|tag)s|u(?:pload_progress.(?:cleanup|enabled|(?:min_)?freq|name|prefix)|se_(?:(?:only_)?cookies|strict_mode|trans_sid))))|hort_open_tag|mtp(?:_port)?|oap.wsdl_cache(?:_(?:dir|enabled|limit|ttl))?|ql(?:.safe_mode|ite3.(?:defensive|extension_dir))|tomp.default_(?:broker|(?:connection|read)_timeout_u?sec)|woole.(?:aio_thread_num|display_errors|enable_(?:coroutine|library|preemptive_scheduler)|(?:fast_serializ|u(?:nixsock_buffer_siz|se_(?:namespac|shortnam)))e)|ys(?:_temp_dir|log.(?:f(?:acility|ilter)|ident)|vshm.init_mem))|t(?:aint.e(?:nable|rror_level)|idy.(?:clean_output|default_config)|ra(?:ck_errors|der.real_(?:precision|round_mode)))|u(?:nserialize_(?:callback_func|max_depth)|opz.(?:disable|exit|overloads)|pload(?:_(?:max_filesize|tmp_dir)|progress.file.filename_template)|rl_rewriter.(?:host|tag)s|ser_(?:agent|dir|ini.(?:cache_ttl|filename)))|v(?:8js.(?:flag|max_disposed_context)s|ariables_order|ld.(?:(?:activ|execut)e|skip_(?:ap|pre)pend))|w(?:in(?:cache.(?:chkinterval|enablecli|f(?:c(?:achesize|enabled(?:filter)?|ndetect)|ile(?:count|mapdir))|(?:ignorelis|namesal)t|maxfilesize|oc(?:achesize|enabled(?:filter)?)|reroute(?:_enabled|ini)|s(?:cachesize|rwlocks)|ttlmax|uc(?:achesize|enabled))|dows.show_crt_warning)|khtmltox.graphics)|x(?:bithack|hprof.output_dir|mlrpc_error(?:_number|s))|ya(?:c(?:.(?:compress_threshold|debug|enable(?:_cli)?|(?:key|value)s_memory_size|serializer)|onf.(?:check_dela|director)y)|f.(?:action_prefer|cache_config|environ|forward_limit|l(?:ibrary|owcase_path)|name_s(?:eparator|uffix)|use_(?:namespace|spl_autoload))|ml.(?:decode_(?:binary|(?:ph|timestam)p)|output_(?:canonical|indent|width))|r.(?:(?:connect_)?timeout|debug|expose_info|packager)|z.(?:keepalive|log_mask))|z(?:end(?:_extension|.(?:assertions|(?:detect_unicod|multibyt)e|e(?:nable_gc|xception_(?:ignore_args|string_param_max_len))|s(?:cript_encoding|ignal_check)))|lib.output_(?:compression(?:_level)?|handler)|ookeeper.(?:recv_timeout|sess(?:_lock_wait|ion_lock))))[\\s\\x0b]*=[^=]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Configuration Directive Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":933120,"phase":2,"chain":false}},{"id":"933130","description":"PHP Injection Attack: Variables Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"php-variables.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Variables Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath","UrlDecodeUni"],"id":933130,"phase":2,"chain":false}},{"id":"933135","description":"PHP Injection Attack: Variable Access Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\$\\s*\\{\\s*\\S[^\\{\\}]*\\}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Variable Access Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933135,"phase":2,"chain":false}},{"id":"933140","description":"PHP Injection Attack: I/O Stream Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: I/O Stream Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933140,"phase":2,"chain":false}},{"id":"933200","description":"PHP Injection Attack: Wrapper scheme detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:bzip2|expect|glob|ogg|(?:ph|r)ar|ssh2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?|z(?:ip|lib))://"},"actions":["Block",{"Msg":"PHP Injection Attack: Wrapper scheme detected"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","RemoveNulls"],"id":933200,"phase":2,"chain":false}},{"id":"933150","description":"PHP Injection Attack: High-Risk PHP Function Name Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"php-function-names-933150.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: High-Risk PHP Function Name Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":933150,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"@pm ( )"},"actions":[{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"933180","description":"PHP Injection Attack: Variable Function Call Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\$+(?:[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*|\\s*\\{.+})(?:\\s|\\[.+\\]|\\{.+}|/\\*.*\\*/|//.*|#.*)*\\(.*\\)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Variable Function Call Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933180,"phase":2,"chain":false}},{"id":"933220","description":"PHP Injection Attack: PHP Session File Upload Attempt","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"Tx":"FILES_NAMES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X.Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"Rx":"(?:^|[/\\x5c])sess_[,\\-0-9a-z]{20,256}$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Session File Upload Attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":933220,"phase":2,"chain":false}},{"id":"933013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933013,"phase":1,"chain":false}},{"id":"933014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933014,"phase":2,"chain":false}},{"id":"933151","description":"PHP Injection Attack: Medium-Risk PHP Function Name Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:c(?:cel_chdir|osh?)|ddc?slashes|pache_(?:child_terminate|get(?:_(?:modules|version)|env)|lookup_uri|note |re(?:quest|sponse)_headers|setenv)|r(?:ray_(?:c(?:h(?:ange_key_case|unk)|o(?:lumn|mbine|unt_values))|diff(?:_(?:assoc|key|u(?:assoc|key)))?|f(?:ill(?:_keys)?|lip)|i(?:ntersect(?:_(?:assoc|key|u(?:assoc|key)))?|s_list)|key(?:_(?:fir|la)st|s)|m(?:ap|erge(?:_recursive)?|ultisort)|p(?:ad|op|roduct)|r(?:and|e(?:(?:duc|vers)e|place(?:_recursive)?))|s(?:earch|p?lice|um)|u(?:(?:diff|intersect)(?:_u?assoc)?|n(?:ique|shift))|walk(?:_recursive)?)|sort)|s(?:inh|ort|sert_options)|tan[2h]?)|b(?:ase(?:64_(?:de|en)code|_convert)|c(?:add|comp|div|m(?:od|ul)|pow(?:mod)?|s(?:cale|qrt|ub))|in(?:2hex|d(?:_textdomain_codeset|ec|textdomain))|oolval|z(?:(?:de)?compress|err(?:no|(?:o|st)r)|open|read))|c(?:al(?:_(?:days_in_month|(?:from|to)_jd|info)|l_user_func_array)|eil|h(?:(?:di)?r|grp|mod|own|unk_split)|l(?:ass_(?:alia|(?:implem|par)ent|use)s|earstatcache|ose(?:dir|log))|o(?:llator_(?:asort|c(?:ompar|reat)e|get_(?:(?:attribut|error_(?:cod|messag)|local)e|s(?:ort_key|trength))|s(?:et_(?:attribute|strength)|ort(?:_with_sort_keys)?))|m_(?:create_guid|event_sink|get_active_object|load_typelib|message_pump|print_typeinfo)|n(?:fig_get_hash|nection_(?:aborted|status)|vert_uu(?:de|en)code)|unt_chars)|rc32|type_(?:al(?:num|pha)|cntrl|(?:x?digi|p(?:rin|unc))t|graph|(?:low|upp)er|space)|url_(?:(?:c(?:los|opy_handl)|file_creat|paus)e|e(?:rr(?:no|or)|scape|xec)|getinfo|(?:ini|rese)t|multi_(?:(?:(?:add|remove)_handl|clos)e|e(?:rrno|xec)|getcontent|in(?:fo_read|it)|s(?:e(?:lec|top)t|trerror))|s(?:etopt(?:_array)?|hare_(?:close|errno|init|s(?:etopt|trerror))|trerror)|u(?:nescape|pkeep)|version))|d(?:ate(?:_(?:add|create(?:_(?:from_format|immutable(?:_from_format)?))?|d(?:(?:ate_s|efault_timezone_[gs])et|iff)|(?:forma|(?:offset_g|time(?:_s|(?:stamp|zone)_[gs]))e)t|get_last_errors|i(?:nterval_(?:create_from_date_string|format)|sodate_set)|modify|parse(?:_from_format)?|su(?:b|n(?:_info|rise|set)))|fmt_(?:(?:creat|localtim|pars)e|format(?:_object)?|get_(?:calendar(?:_object)?|(?:datetyp|error_(?:cod|messag)|local)e|pattern|time(?:type|zone(?:_id)?))|is_lenient|set_(?:calendar|lenient|pattern|timezone)))|ba_(?:(?:clos|delet|replac)e|(?:exist|handler)s|f(?:etch|irstkey)|(?:inser|key_spli|lis)t|nextkey|op(?:en|timize)|popen|sync)|(?:cn?)?gettext|e(?:bug_(?:(?:print_)?backtrace|zval_dump)|c(?:bin|hex)|flate_(?:add|init)|g2rad)|isk_(?:free|total)_space|l_test_test[12]|n(?:gettext|s_(?:check_record|get_(?:mx|record)))|om_import_simplexml)|e(?:aster_da(?:te|ys)|n(?:chant_(?:broker_(?:d(?:escribe|ict_exists)|free(?:_dict)?|get_(?:dict_path|error)|(?:ini|request_(?:pwl_)?dic)t|list_dicts|set_(?:dict_path|ordering))|dict_(?:add(?:_to_session)?|(?:quick_)?check|describe|get_error|is_added|s(?:tore_replacemen|ugges)t))|um_exists)|rror_(?:(?:clear|get)_last|(?:lo|reportin)g)|scapeshell(?:arg|cmd)|x(?:if_(?:imagetype|read_data|t(?:agname|humbnail))|pm1|tension_loaded))|f(?:astcgi_finish_request|d(?:atasync|iv)|eof|f(?:i_trampoline|lush)|get(?:c(?:sv)?|s)|i(?:l(?:e_put_contents|ter_(?:has_var|i(?:d|nput(?:_array)?)|list|var(?:_array)?))|nfo_(?:buffer|(?:clos|fil)e|open|set_flags))|loatval|(?:mo|re(?:a|nchtoj))d|nmatch|orward_static_call(?:_array)?|p(?:assthru|m_get_status|rintf|utcsv)|s(?:canf|eek|ockopen|tat|ync)|t(?:ell|ok|p_(?:a(?:lloc|ppend)|c(?:dup|h(?:dir|mod)|lose|onnect)|delete|exec|f(?:ge|pu)t|get(?:_option)?|login|m(?:dtm|kdir|lsd)|n(?:b_(?:continue|(?:f(?:ge|pu)|ge|pu)t)|list)|p(?:asv|ut|wd)|r(?:aw(?:list)?|ename|mdir)|s(?:et_option|(?:i[tz]|ystyp)e|sl_connect))|runcate)|unc_(?:get_args?|num_args)|write)|g(?:c_(?:(?:(?:collect_cycl|mem_cach)e|statu)s|disable|enabled?)|d_info|et(?:_(?:browser|c(?:(?:alled_clas|lass_(?:method|var))s|(?:fg_va|urrent_use)r)|de(?:bug_type|(?:clared_(?:(?:class|interfac)e|trait)|fined_(?:constant|function|var))s)|(?:extension_func|loaded_extension|m(?:angled_object_var|eta_tag)|parent_clas)s|h(?:eaders|tml_translation_table)|include(?:_path|d_files)|o(?:bject_vars|pen_basedir)|resource(?:_(?:id|type)|s))|(?:cw|lastmo)d|(?:dat|rusag)e|env|host(?:by(?:addr|namel?)|name)|imagesize(?:fromstring)?|my(?:[gpu]id|inode)|opt|protobyn(?:ame|umber)|servby(?:name|port)|t(?:ext|imeofday|ype))|m(?:(?:dat|(?:mk|strf)tim)e|p_(?:a(?:bs|[dn]d)|binomial|c(?:lrbit|mp|om)|div(?:_(?:qr?|r)|exact)|(?:expor|fac|hamdis|testbi)t|gcd(?:ext)?|i(?:mport|n(?:(?:i|ver)t|tval))|jacobi|(?:kronecke|x?o)r|l(?:cm|egendre)|m(?:od|ul)|ne(?:g|xtprime)|p(?:erfect_(?:power|square)|o(?:pcount|wm?)|rob_prime)|r(?:andom_(?:bits|range|seed)|oot(?:rem)?)|s(?:can[01]|etbit|ign|qrt(?:rem)?|trval|ub)))|r(?:apheme_(?:extract|s(?:tr(?:i(?:pos|str)|len|(?:ri?)?pos|str)|ubstr))|egoriantojd)|z(?:(?:un)?compress|(?:de(?:cod|flat)|encod|fil|inflat)e|open))|h(?:ash_(?:(?:algo|equal)s|copy|fi(?:le|nal)|h(?:kdf|mac(?:_(?:algos|file))?)|init|pbkdf2|update(?:_(?:file|stream))?)|e(?:ader(?:_re(?:gister_callback|move)|s_(?:lis|sen)t)|brev|x(?:2bin|dec))|ighlight_(?:file|string)|rtime|t(?:ml(?:(?:_entity|specialchars)_decode|entities)|tp_(?:build_query|response_code))|ypot)|i(?:conv(?:_(?:get_encoding|mime_(?:decode(?:_headers)?|encode)|s(?:et_encoding|tr(?:len|r?pos)|ubstr)))?|dn_to_(?:ascii|utf8)|gnore_user_abort|ma(?:ge(?:_type_to_(?:extension|mime_type)|a(?:ffine(?:matrix(?:conca|ge)t)?|lphablending|ntialias|rc|vif)|(?:bm|w(?:bm|eb))p|c(?:har(?:up)?|o(?:lor(?:a(?:llocate(?:alpha)?|t)|closest(?:alpha|hwb)?|deallocate|(?:exact|resolve)(?:alpha)?|match|s(?:et|forindex|total)|transparent)|nvolution|py(?:merge(?:gray)?|res(?:ampl|iz)ed)?)|r(?:eate(?:from(?:avif|(?:bm|w(?:bm|eb))p|g(?:d(?:2(?:part)?)?|if)|(?:jpe|(?:p|stri)n)g|tga|x[bp]m)|truecolor)?|op(?:auto)?))|d(?:ashedline|estroy)|ellipse|f(?:il(?:l(?:ed(?:arc|(?:ellips|rectangl)e|polygon)|toborder)?|ter)|lip|ont(?:height|width)|t(?:bbox|text))|g(?:ammacorrect|d2?|et(?:clip|interpolation)|if|rab(?:screen|window))|i(?:nterlace|struecolor)|jpeg|l(?:(?:ayereffec|oadfon)t|ine)|openpolygon|p(?:alette(?:copy|totruecolor)|ng|olygon)|r(?:e(?:ctangle|solution)|otate)|s(?:avealpha|cale|et(?:brush|clip|interpolation|pixel|style|t(?:hickness|ile))|tring(?:up)?|[xy])|t(?:ruecolortopalette|ypes)|xbm)|p_(?:(?:8bi|qprin)t|a(?:lerts|ppend)|b(?:ase64|inary|ody(?:struct)?)|c(?:heck|l(?:earflag_full|ose)|reatemailbox)|delete(?:mailbox)?|e(?:rrors|xpunge)|fetch(?:_overview|body|header|(?:mim|structur)e)|g(?:c|et(?:_quota(?:root)?|acl|mailboxes|subscribed))|header(?:info|s)|(?:is_)?open|l(?:ast_error|ist(?:scan)?|sub)|m(?:ail(?:_(?:co(?:mpose|py)|move)|boxmsginfo)?|ime_header_decode|sgno|utf7_to_utf8)|num_(?:msg|recent)|ping|r(?:e(?:namemailbox|open)|fc822_(?:parse_(?:adrlist|headers)|write_address))|s(?:avebody|e(?:arch|t(?:_quota|(?:ac|flag_ful)l))|ort|tatus|ubscribe)|t(?:hread|imeout)|u(?:id|n(?:delet|subscrib)e|tf(?:7_(?:de|en)code|8(?:_to_mutf7)?))))|n(?:_array|et_(?:ntop|pton)|flate_(?:add|get_(?:read_len|status)|init)|i_(?:get(?:_all)?|parse_quantity|restore|set)|t(?:div|erface_exists|l(?:_(?:error_nam|get_error_(?:cod|messag)|is_failur)e|cal_(?:a(?:dd|fter)|(?:befor|f(?:ield_differenc|rom_date_tim)|to_date_tim)e|c(?:lear|reate_instance)|equals|get(?:_(?:a(?:ctual_m(?:ax|in)imum|vailable_locales)|(?:day_of_week_typ|error_(?:cod|messag)|keyword_values_for_local)e|first_day_of_week|greatest_minimum|l(?:east_maximum|ocale)|m(?:aximum|inim(?:al_days_in_first_week|um))|now|(?:(?:repeat|skipp)ed_wall_time_op|weekend_transi)tion|t(?:ime(?:_zone)?|ype)))?|i(?:n_daylight_time|s_(?:equivalent_to|(?:lenien|se)t|weekend))|roll|set(?:_(?:(?:first_day_of|minimal_days_in_first)_week|lenient|(?:repeat|skipp)ed_wall_time_option|time(?:_zone)?))?)|gregcal_(?:(?:create_instanc|[gs]et_gregorian_chang)e|is_leap_year)|tz_(?:c(?:ount_equivalent_ids|reate_(?:default|enumeration|time_zone(?:_id_enumeration)?))|(?:(?:from|to)_date_time_zon|use_daylight_tim)e|get_(?:(?:canonical|windows)_id|d(?:isplay_name|st_savings)|e(?:quivalent_id|rror_(?:cod|messag)e)|(?:gm|offse)t|id(?:_for_windows_id)?|r(?:aw_offset|egion)|(?:tz_data_versio|unknow)n)|has_same_rules))))|p(?:2long|tc(?:embed|parse))|s_(?:bool|(?:(?:(?:c(?:all|ount)|(?:execu|wri)t)ab|uploaded_fi)l|i(?:nfinit|terabl)|re(?:adabl|sourc))e|f(?:i(?:l|nit)e|loat)|link|nan|s(?:calar|oap_fault|tring|ubclass_of))|terator_(?:(?:appl|to_arra)y|count))|j(?:d(?:dayofweek|monthname|to(?:french|gregorian|j(?:ewish|ulian)|unix))|(?:ewish|ulian)tojd|son_(?:last_error(?:_msg)?|validate)))[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Medium-Risk PHP Function Name Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933151,"phase":2,"chain":false}},{"id":"933152","description":"PHP Injection Attack: Medium-Risk PHP Function Name Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:kr?sort|l(?:c(?:first|g_value|h(?:grp|own))|dap_(?:8859_to_t61|(?:ad|bin)d(?:_ext)?|co(?:mpare|nnect(?:_wallet)?|unt_(?:entri|referenc)es)|d(?:elete(?:_ext)?|n2ufn)|e(?:rr(?:(?:2st|o)r|no)|scape|x(?:op(?:_(?:passwd|refresh|sync|whoami))?|plode_dn))|f(?:irst_(?:(?:attribut|referenc)e|entry)|ree_result)|get_(?:(?:attribut|entri)es|(?:d|optio|values_le)n)|list|mod(?:_(?:add|del|replace)(?:_ext)?|ify_batch)|next_(?:(?:attribut|referenc)e|entry)|parse_(?:exop|re(?:ference|sult))|re(?:ad|name(?:_ext)?)|s(?:asl_bind|e(?:arch|t_(?:option|rebind_proc))|tart_tls)|t61_to_8859|unbind)|evenshtein|i(?:bxml_(?:(?:clear|use_internal)_errors|disable_entity_loader|get_(?:e(?:rrors|xternal_entity_loader)|last_error)|set_(?:external_entity_loader|streams_context))|nkinfo|tespeed_(?:finish_request|re(?:quest|sponse)_headers))|o(?:cal(?:e(?:_(?:(?:accept_from_htt|looku)p|(?:c(?:anonicaliz|ompos)|pars)e|filter_matches|get_(?:(?:all_variant|keyword)s|d(?:efault|isplay_(?:(?:languag|nam)e|region|(?:scrip|varian)t))|primary_language|region|script)|set_default)|conv)|time)|g1[0p]|ng2ip)|stat|trim)|m(?:b_(?:c(?:h(?:eck_encoding|r)|onvert_(?:case|encoding|kana|variables))|de(?:code_(?:mimeheader|numericentity)|tect_(?:encoding|order))|e(?:ncod(?:e_(?:mimeheader|numericentity)|ing_aliases)|reg(?:_(?:match|replace(?:_callback)?|search(?:_(?:(?:get(?:po|reg)|(?:set)?po|reg)s|init))?)|i(?:_replace)?)?)|get_info|http_(?:in|out)put|internal_encoding|l(?:anguage|ist_encodings)|o(?:rd|utput_handler)|p(?:arse_str|referred_mime_name)|regex_(?:encoding|set_options)|s(?:crub|end_mail|plit|tr(?:_(?:pad|split)|cut|i(?:mwidth|pos|str)|len|pos|r(?:chr|i(?:chr|pos)|pos)|(?:st|to(?:low|upp)e)r|width)|ubst(?:itute_character|r(?:_count)?)))|(?:(?:d5|ove_uploaded)_fil|e(?:mory_(?:get_(?:peak_)?|reset_peak_)usag|taphon)|i(?:crotim|me_content_typ))e|hash(?:_(?:count|get_(?:block_siz|hash_nam)e|keygen_s2k))?|k(?:dir|time)|sg(?:_(?:(?:get_queu|re(?:ceiv|move_queu))e|queue_exists|s(?:e(?:nd|t_queue)|tat_queue))|fmt_(?:create|(?:format|parse)(?:_message)?|get_(?:(?:error_(?:cod|messag)|local)e|pattern)|set_pattern))|t_(?:getrandmax|s?rand)|ysqli_(?:a(?:ffected_rows|utocommit)|begin_transaction|c(?:ha(?:nge_user|racter_set_name)|lose|o(?:mmit|nnect(?:_err(?:no|or))?))|d(?:ata_seek|ebug|ump_debug_info)|e(?:rr(?:no|or(?:_list)?)|xecute_query)|f(?:etch_(?:a(?:ll|rray|ssoc)|column|field(?:_direct|s)?|lengths|object|row)|ield_(?:count|seek|tell)|ree_result)|get_(?:c(?:harset|lient_(?:info|stats|version)|onnection_stats)|(?:host|proto)_info|(?:links_stat|warning)s|server_(?:info|version))|in(?:fo|it|sert_id)|kill|m(?:ore_results|ulti_query)|n(?:ext_result|um_(?:field|row)s)|options|p(?:ing|oll|repare)|query|r(?:e(?:a(?:l_(?:connect|escape_string|query)|p_async_query)|fresh|(?:lease_savepoin|por)t)|ollback)|s(?:(?:avepoin|sl_se)t|e(?:lect_db|t_charset)|qlstate|t(?:(?:a|ore_resul)t|mt_(?:a(?:ffected_rows|ttr_[gs]et)|bind_(?:param|result)|close|data_seek|e(?:rr(?:no|or(?:_list)?)|xecute)|f(?:etch|(?:ield_coun|ree_resul)t)|get_(?:result|warnings)|in(?:it|sert_id)|more_results|n(?:ext_result|um_rows)|p(?:aram_count|repare)|res(?:et|ult_metadata)|s(?:end_long_data|qlstate|tore_result))))|thread_(?:id|safe)|(?:use_resul|warning_coun)t))|n(?:(?:at(?:case)?sor|gettex)t|et_get_interfaces|l(?:2br|_langinfo)|ormalizer_(?:get_raw_decomposition|is_normalized|normalize)|umfmt_(?:create|(?:format|parse)(?:_currency)?|get_(?:(?:(?:text_)?attribut|error_(?:cod|messag)|local)e|pattern|symbol)|set_(?:(?:text_)?attribute|pattern|symbol)))|o(?:b_(?:clean|end_(?:clean|flush)|(?:implicit_)?flush|g(?:et_(?:c(?:lean|ontents)|flush|le(?:ngth|vel)|status)|zhandler)|list_handlers)|c(?:i(?:_(?:(?:bind_(?:array_)?|define_)by_name|c(?:ancel|l(?:ient_version|ose)|o(?:llection_(?:a(?:ppend|ssign)|element_(?:assign|get)|max|size|trim)|(?:mmi|nnec)t))|e(?:rror|xecute)|f(?:etch(?:_(?:a(?:ll|rray|ssoc)|object|row))?|ield_(?:is_null|(?:nam|s(?:cal|iz))e|precision|type(?:_raw)?)|ree_(?:collection|descriptor|statement))|get_implicit_resultset|lob_(?:(?:appen|loa|re(?:a|win))d|copy|e(?:of|rase|xport)|flush|i(?:mport|s_equal)|s(?:(?:av|iz)e|eek)|t(?:ell|runcate)|write)|n(?:ew_(?:c(?:o(?:llection|nnect)|ursor)|descriptor)|um_(?:field|row)s)|p(?:a(?:rs|ssword_chang)e|connect)|r(?:e(?:gister_taf_callback|sult)|ollback)|s(?:e(?:rver_version|t_(?:(?:ac|db_opera|edi)tion|c(?:all_timeout|lient_i(?:dentifier|nfo))|module_name|prefetch(?:_lob)?))|tatement_type)|unregister_taf_callback)|fetchinto|[gs]etbufferinglob)|tdec)|dbc_(?:autocommit|(?:binmod|data_sourc)e|c(?:lose(?:_all)?|o(?:lumn(?:privilege)?s|mmit|nnect(?:ion_string_(?:is_quoted|(?:should_)?quote))?)|ursor)|e(?:rror(?:msg)?|xec(?:ute)?)|f(?:etch_(?:array|into|object|row)|ield_(?:len|n(?:ame|um)|(?:scal|typ)e)|oreignkeys|ree_result)|gettypeinfo|longreadlen|n(?:ext_result|um_(?:field|row)s)|p(?:connect|r(?:epare|(?:imarykey|ocedure(?:column)?)s))|r(?:esult(?:_all)?|ollback)|s(?:etoption|(?:pecialcolumn|tatistic)s)|table(?:privilege)?s)|p(?:cache_(?:compile_file|get_(?:configuration|status)|i(?:nvalidate|s_script_cached)|reset)|en(?:dir|log|ssl_(?:c(?:ipher_(?:iv|key)_length|ms_(?:(?:de|en)crypt|read|sign|verify)|sr_(?:export(?:_to_file)?|get_(?:public_key|subject)|new|sign))|d(?:(?:ecryp|iges)t|h_compute_key)|e(?:ncrypt|rror_string)|(?:get_(?:c(?:ert_location|ipher_method|urve_name)|md_method)|random_pseudo_byte)s|open|p(?:bkdf2|k(?:cs(?:12_(?:export(?:_to_file)?|read)|7_(?:(?:de|en)crypt|read|sign|verify))|ey_(?:(?:deriv|fre)e|export(?:_to_file)?|get_(?:details|p(?:rivate|ublic))|new))|(?:rivate|ublic)_(?:de|en)crypt)|s(?:eal|ign|pki_(?:export(?:_challenge)?|new|verify))|verify|x509_(?:check(?:_private_key|purpose)|export(?:_to_file)?|f(?:ingerprint|ree)|parse|read|verify))))|utput_(?:add_rewrite_var|reset_rewrite_vars))|p(?:a(?:rse_(?:ini_(?:file|string)|str)|ss(?:thru|word_(?:algos|get_info|(?:needs_re)?hash|verify))|thinfo)|c(?:lose|ntl_(?:a(?:larm|sync_signals)|exec|forkx?|get(?:_last_error|priority)|rfork|s(?:etpriority|ig(?:nal(?:_(?:dispatch|get_handler))?|procmask|timedwait|waitinfo)|trerror)|unshare|w(?:ait(?:pid)?|exitstatus|if(?:continu|exit|s(?:ignal|topp))ed|(?:stop|term)sig)))|do_drivers|fsockopen|g_(?:(?:affected_row|num_(?:field|row)|option)s|c(?:ancel_query|l(?:ient_encoding|ose)|o(?:n(?:nect(?:_poll|ion_(?:busy|reset|status))?|(?:sume_inpu|ver)t)|py_(?:from|to)))|d(?:bnam|elet)e|e(?:n(?:d_copy|ter_pipeline_mode)|scape_(?:bytea|identifier|literal|string)|x(?:ecut|it_pipeline_mod)e)|f(?:etch_(?:a(?:ll(?:_columns)?|rray|ssoc)|object|r(?:esult|ow))|ield(?:_(?:is_null|n(?:ame|um)|prtlen|size|t(?:able|ype(?:_oid)?))|isnull|prtlen)|lush|ree_result)|get_(?:notify|pid|result)|(?:hos|inser)t|l(?:ast_(?:error|notice|oid)|o_(?:(?:c(?:los|reat)|writ)e|(?:ex|im)port|open|read(?:_all)?|(?:see|unlin)k|t(?:ell|runcate)))|meta_data|p(?:arameter_status|(?:connec|or)t|i(?:ng|peline_s(?:tatus|ync))|(?:repar|ut_lin)e)|query(?:_params)?|result_(?:error(?:_field)?|s(?:eek|tatus))|s(?:e(?:lect|nd_(?:(?:execut|prepar)e|query(?:_params)?)|t_(?:client_encoding|error_(?:context_visibil|verbos)ity))|ocket)|t(?:ra(?:ce|nsaction_status)|ty)|u(?:n(?:escape_bytea|trace)|pdate)|version)|hp(?:_(?:ini_(?:loaded_file|scanned_files)|(?:s(?:api_nam|trip_whitespac)|unam)e)|credits|dbg_(?:break_(?:f(?:ile|unction)|method|next)|c(?:lea|olo)r|e(?:nd_oplog|xec)|get_executable|prompt|start_oplog)|info|version)|osix_(?:e?access|ctermid|f?pathconf|get(?:_last_error|(?:cw|(?:e[gu]|[su])i)d|g(?:id|r(?:gid|nam|oups))|login|p(?:g(?:id|rp)|p?id|w(?:nam|uid))|rlimit)|i(?:nitgroups|satty)|kill|mk(?:fifo|nod)|s(?:et(?:(?:e[gu]|p?g|[su])id|rlimit)|trerror|ysconf)|t(?:imes|tyname)|uname)|r(?:eg_(?:filter|grep|last_error(?:_msg)?|match_all|quote|replace_callback(?:_array)?|split)|o(?:c_(?:(?:clos|nic|terminat)e|get_status|open)|perty_exists))|spell_(?:add_to_(?:personal|session)|c(?:heck|lear_session|onfig_(?:(?:creat|ignor|mod)e|d(?:ata|ict)_dir|(?:persona|save_rep)l|r(?:epl|untogether)))|new(?:_(?:config|personal))?|s(?:(?:ave_wordli|ugge)s|tore_replacemen)t)|utenv)|quote(?:d_printable_(?:de|en)code|meta))[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Medium-Risk PHP Function Name Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933152,"phase":2,"chain":false}},{"id":"933153","description":"PHP Injection Attack: Medium-Risk PHP Function Name Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:r(?:a(?:d2deg|ndom_(?:bytes|int)|wurl(?:de|en)code)|e(?:a(?:d(?:dir|(?:gz)?file|lin(?:e(?:_(?:(?:(?:add|list|write)_histor|re(?:ad_histor|displa))y|c(?:allback_(?:handler_(?:install|remove)|read_char)|lear_history|ompletion_function)|info|on_new_line))?|k))|lpath(?:_cache_(?:get|size))?)|gister_(?:shutdown|tick)_function|s(?:ourcebundle_(?:c(?:ount|reate)|get(?:_error_(?:cod|messag)e)?|locales)|tore_e(?:rror|xception)_handler)|wind(?:dir)?)|mdir|sort)|s(?:api_windows_(?:cp_(?:conv|[gs]et|is_utf8)|(?:generate_ctrl_even|vt100_suppor)t|set_ctrl_handler)|candir|e(?:m_(?:(?:acquir|re(?:leas|mov))e|get)|ssion_(?:(?:abor|unse)t|c(?:ache_(?:expire|limiter)|reate_id)|de(?:code|stroy)|(?:encod|(?:module_)?nam|write_clos)e|g(?:c|et_cookie_params)|id|re(?:g(?:enerate_id|ister_shutdown)|set)|s(?:ave_path|et_(?:cookie_params|save_handler)|ta(?:rt|tus)))|t(?:_(?:e(?:rror|xception)_handler|include_path|time_limit)|(?:(?:raw)?cooki|local)e))|h(?:a1(?:_file)?|ell_exec|m(?:_(?:(?:at|de)tach|(?:(?:ge|pu)t|has)_var|remove(?:_var)?)|op_(?:(?:clos|(?:dele|wri)t|siz)e|open|read)))|i(?:m(?:ilar_text|plexml_(?:import_dom|load_(?:file|string)))|nh)|nmp(?:[23]_(?:get(?:next)?|(?:real_)?walk|set)|_(?:get_(?:quick_print|valueretrieval)|read_mib|set_(?:(?:(?:enum|quick)_prin|oid_output_forma)t|valueretrieval))|get(?:next)?|(?:real)?walk|set)|o(?:cket_(?:a(?:ccept|ddrinfo_(?:bind|connect|explain|lookup)|tmark)|bind|c(?:l(?:ear_error|ose)|msg_space|onnect|reate(?:_(?:listen|pair))?)|(?:ex|im)port_stream|get(?:_option|(?:peer|sock)name)|l(?:ast_error|isten)|re(?:ad|cv(?:from|msg)?)|s(?:e(?:lect|nd(?:msg|to)?|t_(?:(?:non)?block|option))|hutdown|trerror)|w(?:rite|saprotocol_info_(?:(?:ex|im)port|release)))|dium_(?:(?:ad|(?:un)?pa)d|b(?:ase642bin|in2(?:base64|hex))|c(?:ompare|rypto_(?:a(?:ead_(?:aes256gcm_(?:(?:de|en)crypt|is_available|keygen)|chacha20poly1305_(?:(?:de|en)crypt|ietf_(?:(?:de|en)crypt|keygen)|keygen)|xchacha20poly1305_ietf_(?:(?:de|en)crypt|keygen))|uth(?:_(?:keygen|verify))?)|box(?:_(?:keypair(?:_from_secretkey_and_publickey)?|open|publickey(?:_from_secretkey)?|se(?:al(?:_open)?|cretkey|ed_keypair)))?|core_ristretto255_(?:add|from_hash|is_valid_point|random|s(?:calar_(?:add|(?:complemen|inver)t|mul|negate|r(?:andom|educe)|sub)|ub))|generichash(?:_(?:final|init|keygen|update))?|k(?:df_(?:derive_from_key|keygen)|x_(?:client_session_keys|keypair|publickey|se(?:cretkey|ed_keypair|rver_session_keys)))|pwhash(?:_s(?:cryptsalsa208sha256(?:_str(?:_verify)?)?|tr(?:_(?:needs_rehash|verify))?))?|s(?:calarmult(?:_ristretto255(?:_base)?)?|ecret(?:box(?:_(?:keyg|op)en)?|stream_xchacha20poly1305_(?:(?:init_)?pu(?:ll|sh)|keygen|rekey))|horthash(?:_keygen)?|ign(?:_(?:(?:verify_)?detached|ed25519_[ps]k_to_curve25519|keypair(?:_from_secretkey_and_publickey)?|open|publickey(?:_from_secretkey)?|se(?:cretkey|ed_keypair)))?|tream(?:_(?:keygen|x(?:chacha20(?:_(?:keygen|xor(?:_ic)?))?|or)))?)))|hex2bin|increment|mem(?:cmp|zero))|undex)|p(?:l_(?:autoload(?:_(?:call|(?:extens|funct)ions|(?:un)?register))?|classes|object_(?:hash|id))|rintf)|qrt|scanf|tr(?:_(?:contains|(?:decreme|word_cou)nt|ends_with|getcsv|i(?:ncrement|replace)|pad|r(?:epeat|ot13)|s(?:huffle|plit|tarts_with))|c(?:(?:asec)?mp|oll|spn)|eam_(?:bucket_(?:(?:ap|pre)pend|make_writeable|new)|co(?:ntext_(?:create|get_(?:default|(?:option|param)s)|set_(?:default|options?|params))|py_to_stream)|filter_(?:(?:ap|pre)pend|re(?:gister|move))|get_(?:(?:(?:conten|transpor)t|(?:filt|wrapp)er)s|line|meta_data)|is(?:_local|atty)|resolve_include_path|s(?:e(?:lect|t_(?:blocking|chunk_size|(?:read|write)_buffer|timeout))|ocket_(?:(?:accep|clien)t|enable_crypto|get_name|pair|recvfrom|s(?:e(?:ndto|rver)|hutdown))|upports_lock)|wrapper_(?:re(?:gister|store)|unregister))|ftime|i(?:p(?:c?slashe|o)s|str)|n(?:at)?c(?:asec)?mp|p(?:brk|time)|r(?:chr|ev|i?pos)|s(?:pn|tr)|t(?:ok|r)|val)|ubstr_(?:co(?:mpare|unt)|replace)|ys_get(?:_temp_dir|loadavg))|t(?:anh|e(?:mpnam|st[12]|xtdomain)|i(?:dy_(?:(?:access|error|warning)_count|c(?:lean_repair|onfig_count)|diagnose|get(?:_(?:body|config|error_buffer|h(?:ead|tml(?:_ver)?)|o(?:pt_doc|utput)|r(?:elease|oot)|status)|opt)|is_x(?:ht)?ml|(?:parse|repair)_(?:file|string))|me(?:_(?:nanosleep|sleep_until)|zone_(?:(?:(?:abbreviation|identifier)s_lis|(?:(?:locat|vers)ion|transitions)_ge)t|name_(?:from_abbr|get)|o(?:ffset_get|pen))))|mpfile|oken_(?:get_all|name)|r(?:a(?:it_exists|nsliterator_(?:create(?:_(?:from_rules|inverse))?|(?:get_error_(?:cod|messag)|transliterat)e|list_ids))|igger_error))|u(?:[ak]sort|cwords|mask|n(?:i(?:qi|xtoj)d|register_tick_function)|(?:rlde|tf8_(?:de|en))code|s(?:e_soap_error_handler|leep|ort))|v(?:ar(?:_(?:dump|export)|iant_(?:a(?:bs|[dn]d)|c(?:as?t|mp)|d(?:ate_(?:from|to)_timestamp|iv)|eqv|fix|get_type|i(?:div|mp|nt)|m(?:od|ul)|n(?:eg|ot)|x?or|pow|round|s(?:et(?:_type)?|ub)))|ersion_compare|[fs]?printf)|wordwrap|xml(?:_(?:error_string|get_(?:current_(?:byte_index|(?:column|line)_number)|error_code)|parse(?:_into_struct|r_(?:create(?:_ns)?|free|[gs]et_option))?|set_(?:(?:character_data|default|e(?:lement|nd_namespace_decl|xternal_entity_ref)|(?:notation|start_namespace|unparsed_entity)_decl|processing_instruction)_handler|object))|writer_(?:end_(?:attribute|c(?:data|omment)|d(?:ocument|td(?:_(?:attlist|e(?:lement|ntity)))?)|element|pi)|f(?:lush|ull_end_element)|o(?:pen_(?:memory|uri)|utput_memory)|s(?:et_indent(?:_string)?|tart_(?:(?:attribute|element)(?:_ns)?|c(?:data|omment)|d(?:ocument|td(?:_(?:attlist|e(?:lement|ntity)))?)|pi))|text|write_(?:(?:attribute|element)(?:_ns)?|c(?:data|omment)|dtd(?:_(?:attlist|e(?:lement|ntity)))?|pi|raw)))|z(?:end_(?:c(?:all_method|reate_unterminated_string)|get_(?:current_func_name|map_ptr_last|unit_enum)|iterable(?:_legacy)?|leak_(?:bytes|variable)|(?:number_or_string|string_or_(?:object|stdclass))(?:_or_null)?|t(?:e(?:rminate_string|st_(?:(?:(?:nullable_)?array|void)_return|c(?:ompile_string|r(?:ash|eate_throwing_resource))|deprecated|f(?:ill_packed_array|unc)|is_string_marked_as_valid_utf8|(?:override_libxml_global_sta|parameter_with_attribu)te|zend_(?:call_stack_(?:get|use_all)|ini_(?:parse_u?quantity|str))))|hread_id)|version|weakmap_(?:attach|dump|remove))|ip_(?:close|entry_(?:c(?:lose|ompress(?:edsize|ionmethod))|(?:filesiz|nam)e|open|read)|open|read)|lib_(?:(?:de|en)cod|get_coding_typ)e)|ZendTestNS2_(?:ZendSubNS_)?namespaced_(?:deprecated_)?func)[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Medium-Risk PHP Function Name Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933153,"phase":2,"chain":false}},{"id":"933015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933015,"phase":1,"chain":false}},{"id":"933016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933016,"phase":2,"chain":false}},{"id":"933131","description":"PHP Injection Attack: Variables Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"AUTH_TYPE|HTTP_(?:ACCEPT(?:_(?:CHARSET|ENCODING|LANGUAGE))?|CONNECTION|(?:HOS|USER_AGEN)T|KEEP_ALIVE|(?:REFERE|X_FORWARDED_FO)R)|ORIG_PATH_INFO|PATH_(?:INFO|TRANSLATED)|QUERY_STRING|REQUEST_URI"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Variables Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath","UrlDecodeUni"],"id":933131,"phase":2,"chain":false}},{"id":"933161","description":"PHP Injection Attack: Low-Value PHP Function Call Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:bs|s(?:in|sert(?:_options)?))|basename|c(?:h(?:eckdate|r(?:oot)?)|o(?:(?:mpac|(?:nsta|u)n)t|py|sh?)|r(?:eate_function|ypt)|urrent)|d(?:ate|e(?:coct|fined?)|ir)|e(?:nd|val|x(?:ec|p(?:lode)?|tract))|f(?:ile(?:(?:[acm]tim|inod|siz|typ)e|group|owner|perms)?|l(?:o(?:ck|or)|ush))|glob|h(?:ash|eader)|i(?:date|m(?:age(?:gif|(?:jpe|pn)g|wbmp|xbm)|plode)|s_a)|key|l(?:ink|og)|m(?:a(?:il|x)|d5|in)|n(?:ame|ext)|o(?:pendir|rd)|p(?:a(?:ck|ss(?:thru)?)|i|o(?:pen|w)|rev)|r(?:an(?:d|ge)|e(?:(?:adfil|nam)e|set)|ound)|s(?:(?:erializ|huffl)e|in|leep|(?:or|ta)t|ubstr|y(?:mlink|s(?:log|tem)))|t(?:an|(?:im|mpfil)e|ouch|rim)|u(?:cfirst|n(?:lin|pac)k)|virtual)(?:[\\s\\x0b]|/\\*.*\\*/|(?:#|//).*)*\\(.*\\)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Low-Value PHP Function Call Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933161,"phase":2,"chain":false}},{"id":"933111","description":"PHP Injection Attack: PHP Script File Upload Found","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X.Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"Rx":".*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\..*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Script File Upload Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":933111,"phase":2,"chain":false}},{"id":"933190","description":"PHP Injection Attack: PHP Closing Tag Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"@pm ?>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Closing Tag Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":933190,"phase":2,"chain":false}},{"id":"933017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933017,"phase":1,"chain":false}},{"id":"933018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933018,"phase":2,"chain":false}},{"id":"934011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934011,"phase":1,"chain":false}},{"id":"934012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934012,"phase":2,"chain":false}},{"id":"934110","description":"Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"ssrf.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-ssrf"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/225/664"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934110,"phase":2,"chain":false}},{"id":"934130","description":"JavaScript Prototype Pollution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:__proto__|constructor\\s*(?:\\.|\\]?\\[)\\s*prototype)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"JavaScript Prototype Pollution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-javascript"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1/180/77"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":934130,"phase":2,"chain":false}},{"id":"934150","description":"Ruby Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"Process[\\s\\x0b]*\\.[\\s\\x0b]*spawn[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Ruby Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-ruby"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934150,"phase":2,"chain":false}},{"id":"934013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934013,"phase":1,"chain":false}},{"id":"934014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934014,"phase":2,"chain":false}},{"id":"934101","description":"Node.js Injection Attack 2/2","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:close|exists|fork|(?:ope|spaw)n|re(?:ad|quire)|w(?:atch|rite))[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Node.js Injection Attack 2/2"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-javascript"},{"Tag":"platform-nodejs"},{"Tag":"attack-rce"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","Base64Decode","UrlDecodeUni"],"id":934101,"phase":2,"chain":false}},{"id":"934120","description":"Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip):/?/?(?:[0-9]{7,10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-ssrf"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/225/664"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934120,"phase":2,"chain":false}},{"id":"934140","description":"Perl Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"^(?:[^@]|@[^\\{])*@+\\{[^\\}]*\\}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Perl Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-perl"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934140,"phase":2,"chain":false}},{"id":"934180","description":"SSTI Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:\\{%[^%}]*%}|<%=?[^%>]*%>)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SSTI Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-ssti"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934180,"phase":2,"chain":false}},{"id":"934015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934015,"phase":1,"chain":false}},{"id":"934016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934016,"phase":2,"chain":false}},{"id":"934017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934017,"phase":1,"chain":false}},{"id":"934018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934018,"phase":2,"chain":false}},{"id":"941011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941011,"phase":1,"chain":false}},{"id":"941012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941012,"phase":2,"chain":false}},{"id":"941010","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"Rx":"!@validateByteRange 20,45-47,48-57,65-90,95,97-122"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Ctl":["","ruleRemoveTargetByTag=xss-perf-disable;REQUEST_FILENAME"]},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":941010,"phase":1,"chain":false}},{"id":"941100","description":"XSS Attack Detected via libinjection","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":"DetectXSS","actions":["Block",{"Msg":"XSS Attack Detected via libinjection"},{"LogData":"Matched Data: XSS data found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941100,"phase":2,"chain":false}},{"id":"941110","description":"XSS Filter - Category 1: Script Tag Vector","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<script[^>]*>[\\s\\S]*?"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Filter - Category 1: Script Tag Vector"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941110,"phase":2,"chain":false}},{"id":"941130","description":"XSS Filter - Category 3: Attribute Vector","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i).(?:\\b(?:(?:x(?:link:href|html|mlns)|data:text/html|formaction)\\b|pattern[\\s\\x0b]*=)|(?:!ENTITY[\\s\\x0b]+(?:%[\\s\\x0b]+)?[^\\s\\x0b]+[\\s\\x0b]+(?:SYSTEM|PUBLIC)|@import|;base64)\\b)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Filter - Category 3: Attribute Vector"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941130,"phase":2,"chain":false}},{"id":"941140","description":"XSS Filter - Category 4: Javascript URI Vector","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)[a-z]+=(?:[^:=]+:.+;)*?[^:=]+:url\\(javascript"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Filter - Category 4: Javascript URI Vector"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls","RemoveWhitespace"],"id":941140,"phase":2,"chain":false}},{"id":"941180","description":"Node-Validator Deny List Keywords","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":"NoOp","actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Node-Validator Deny List Keywords"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-nodejs"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941180,"phase":2,"chain":false}},{"id":"941190","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:<style.*?>.*?(?:@[i\\x5c]|(?:[:=]|&#x?0*(?:58|3A|61|3D);?).*?(?:[(\\x5c]|&#x?0*(?:40|28|92|5C);?)))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941190,"phase":2,"chain":false}},{"id":"941200","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:<.*[:]?vmlframe.*?[\\s/+]*?src[\\s/+]*=)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941200,"phase":2,"chain":false}},{"id":"941210","description":"Javascript Word Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:j|&#(?:0*(?:74|106)|x0*[46]A);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:v|&#(?:0*(?:86|118)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;))."},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Javascript Word Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941210,"phase":2,"chain":false}},{"id":"941220","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:v|&#(?:0*(?:118|86)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:b|&#(?:0*(?:98|66)|x0*[46]2);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;))."},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941220,"phase":2,"chain":false}},{"id":"941230","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<EMBED[\\s/+].*?(?:src|type).*?="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941230,"phase":2,"chain":false}},{"id":"941240","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"<[?]?import[\\s/+\\S]*?implementation[\\s/+]*?="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","Lowercase","RemoveNulls"],"id":941240,"phase":2,"chain":false}},{"id":"941260","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:<META[\\s/+].*?charset[\\s/+]*=)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941260,"phase":2,"chain":false}},{"id":"941270","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<LINK[\\s/+].*?href[\\s/+]*="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941270,"phase":2,"chain":false}},{"id":"941280","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<BASE[\\s/+].*?href[\\s/+]*="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941280,"phase":2,"chain":false}},{"id":"941290","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<APPLET[\\s/+>]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941290,"phase":2,"chain":false}},{"id":"941300","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<OBJECT[\\s/+].*?(?:type|codetype|classid|code|data)[\\s/+]*="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941300,"phase":2,"chain":false}},{"id":"941310","description":"US-ASCII Malformed Encoding XSS Filter - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\xbc[^\\xbe>]*[\\xbe>]|<[^\\xbe]*\\xbe"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"US-ASCII Malformed Encoding XSS Filter - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-tomcat"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":["Lowercase","UrlDecodeUni","HtmlEntityDecode"],"id":941310,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"(?:\\xbc\\s*/\\s*[^\\xbe>]*[\\xbe>])|(?:<\\s*/\\s*[^\\xbe]*\\xbe)"},"actions":[{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"941350","description":"UTF-7 Encoding IE XSS - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\+ADw-.*(?:\\+AD4-|>)|<.*\\+AD4-"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"UTF-7 Encoding IE XSS - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode"],"id":941350,"phase":2,"chain":false}},{"id":"941360","description":"JSFuck / Hieroglyphy obfuscation detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"![!+ ]\\[\\]"},"actions":["Block",{"Msg":"JSFuck / Hieroglyphy obfuscation detected"},{"LogData":"Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242/63"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":941360,"phase":2,"chain":false}},{"id":"941370","description":"JavaScript global variable found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:self|document|this|top|window)\\s*(?:/\\*|[\\[)]).+?(?:\\]|\\*/)"},"actions":["Block",{"Msg":"JavaScript global variable found"},{"LogData":"Matched Data: Suspicious JS global variable found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242/63"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","CompressWhitespace"],"id":941370,"phase":2,"chain":false}},{"id":"941390","description":"Javascript method detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:eval|set(?:timeout|interval)|new[\\s\\x0b]+Function|a(?:lert|tob)|btoa|(?:promp|impor)t|con(?:firm|sole\\.(?:log|dir))|fetch)[\\s\\x0b]*[\\(\\{]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Javascript method detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-nodejs"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode"],"id":941390,"phase":2,"chain":false}},{"id":"941400","description":"XSS JavaScript function without parentheses","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"((?:\\[[^\\]]*\\][^.]*\\.)|Reflect[^.]*\\.).*(?:map|sort|apply)[^.]*\\..*call[^`]*`.*`"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS JavaScript function without parentheses"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","CompressWhitespace"],"id":941400,"phase":2,"chain":false}},{"id":"941013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941013,"phase":1,"chain":false}},{"id":"941014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941014,"phase":2,"chain":false}},{"id":"941101","description":"XSS Attack Detected via libinjection","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":"DetectXSS","actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Attack Detected via libinjection"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941101,"phase":1,"chain":false}},{"id":"941150","description":"XSS Filter - Category 5: Disallowed HTML Attributes","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:s(?:tyle|rc)|href)\\b[\\s\\S]*?="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Filter - Category 5: Disallowed HTML Attributes"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941150,"phase":2,"chain":false}},{"id":"941181","description":"Node-Validator Deny List Keywords","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Contains":"-->"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Node-Validator Deny List Keywords"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","Lowercase","RemoveNulls"],"id":941181,"phase":2,"chain":false}},{"id":"941320","description":"Possible XSS Attack Detected - HTML Tag Handler","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"<(?:a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|hr|html|i|iframe|ilayer|img|input|ins|isindex|kdb|keygen|label|layer|legend|li|limittext|link|listing|map|marquee|menu|meta|multicol|nobr|noembed|noframes|noscript|nosmartquotes|object|ol|optgroup|option|p|param|plaintext|pre|q|rt|ruby|s|samp|script|select|server|shadow|sidebar|small|spacer|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|title|tr|tt|u|ul|var|wbr|xml|xmp)\\W"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible XSS Attack Detected - HTML Tag Handler"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242/63"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":941320,"phase":2,"chain":false}},{"id":"941380","description":"AngularJS client side template injection detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\{\\{.*?}}"},"actions":["Block",{"Msg":"AngularJS client side template injection detected"},{"LogData":"Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242/63"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":941380,"phase":2,"chain":false}},{"id":"941015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941015,"phase":1,"chain":false}},{"id":"941016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941016,"phase":2,"chain":false}},{"id":"941017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941017,"phase":1,"chain":false}},{"id":"941018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941018,"phase":2,"chain":false}},{"id":"942011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942011,"phase":1,"chain":false}},{"id":"942012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942012,"phase":2,"chain":false}},{"id":"942100","description":"SQL Injection Attack Detected via libinjection","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":"DetectSQLi","actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack Detected via libinjection"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","RemoveNulls"],"id":942100,"phase":2,"chain":false}},{"id":"942140","description":"SQL Injection Attack: Common DB Names Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:d(?:atabas|b_nam)e[^0-9A-Z_a-z]*\\(|(?:information_schema|m(?:aster\\.\\.sysdatabases|s(?:db|ys(?:ac(?:cess(?:objects|storage|xml)|es)|modules2?|(?:object|querie|relationship)s))|ysql\\.db)|northwind|pg_(?:catalog|toast)|tempdb)\\b|s(?:chema(?:_name\\b|[^0-9A-Z_a-z]*\\()|(?:qlite_(?:temp_)?master|ys(?:aux|\\.database_name))\\b))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack: Common DB Names Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942140,"phase":2,"chain":false}},{"id":"942151","description":"SQL Injection Attack: SQL function name detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|eil(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert_tz)?)|t)|rc32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|s_(?:de|en)crypt)|ump)|e(?:n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|insert|object(?:_(?:agg|keys))?|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|insert_id)|case|east|i(?:kely|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2))|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:lygon|w)|rocedure_analyse)|qu(?:ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp))|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack: SQL function name detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942151,"phase":2,"chain":false}},{"id":"942160","description":"Detects blind sqli tests using sleep() or benchmark()","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:sleep\\s*?\\(.*?\\)|benchmark\\s*?\\(.*?\\,.*?\\))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects blind sqli tests using sleep() or benchmark()"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942160,"phase":2,"chain":false}},{"id":"942170","description":"Detects SQL benchmark and sleep injection attempts including conditional queries","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:select|;)[\\s\\x0b]+(?:benchmark|if|sleep)[\\s\\x0b]*?\\([\\s\\x0b]*?\\(?[\\s\\x0b]*?[0-9A-Z_a-z]+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects SQL benchmark and sleep injection attempts including conditional queries"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942170,"phase":2,"chain":false}},{"id":"942230","description":"Detects conditional SQL injection attempts","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)[\\s\\x0b\\(\\)]case[\\s\\x0b]+when.*?then|\\)[\\s\\x0b]*?like[\\s\\x0b]*?\\(|select.*?having[\\s\\x0b]*?[^\\s\\x0b]+[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z]|if[\\s\\x0b]?\\([0-9A-Z_a-z]+[\\s\\x0b]*?[<->~]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects conditional SQL injection attempts"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942230,"phase":2,"chain":false}},{"id":"942270","description":"Looking for basic sql injection. Common attack string for mysql, oracle and others","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)union.*?select.*?from"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Looking for basic sql injection. Common attack string for mysql, oracle and others"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942270,"phase":2,"chain":false}},{"id":"942290","description":"Finds basic MongoDB SQL injection attempts","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Finds basic MongoDB SQL injection attempts"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942290,"phase":2,"chain":false}},{"id":"942320","description":"Detects MySQL and PostgreSQL stored procedure/function injections","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects MySQL and PostgreSQL stored procedure/function injections"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942320,"phase":2,"chain":false}},{"id":"942350","description":"Detects MySQL UDF injection and other data/structure manipulation attempts","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)create[\\s\\x0b]+function[\\s\\x0b].+[\\s\\x0b]returns|;[\\s\\x0b]*?(?:alter|(?:(?:cre|trunc|upd)at|re(?:nam|plac))e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)\\b[\\s\\x0b]*?[\\(\\[]?[0-9A-Z_a-z]{2,}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects MySQL UDF injection and other data/structure manipulation attempts"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942350,"phase":2,"chain":false}},{"id":"942500","description":"MySQL in-line comment detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"MySQL in-line comment detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942500,"phase":2,"chain":false}},{"id":"942560","description":"MySQL Scientific Notation payload detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)1\\.e(?:[\\(\\),]|\\.[\\$0-9A-Z_a-z])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"MySQL Scientific Notation payload detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942560,"phase":2,"chain":false}},{"id":"942013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942013,"phase":1,"chain":false}},{"id":"942014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942014,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":{"StrEq":"%{TX.2}"},"actions":[{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"942150","description":"SQL Injection Attack: SQL function name detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:json(?:_[0-9A-Z_a-z]+)?|a(?:bs|(?:cos|sin)h?|tan[2h]?|vg)|c(?:eil(?:ing)?|h(?:a(?:nges|r(?:set)?)|r)|o(?:alesce|sh?|unt)|ast)|d(?:e(?:grees|fault)|a(?:te|y))|exp|f(?:loor(?:avg)?|ormat|ield)|g(?:lob|roup_concat)|h(?:ex|our)|i(?:f(?:null)?|if|n(?:str)?)|l(?:ast(?:_insert_rowid)?|ength|ike(?:l(?:ihood|y))?|n|o(?:ad_extension|g(?:10|2)?|wer(?:pi)?|cal)|trim)|m(?:ax|in(?:ute)?|o(?:d|nth))|n(?:ullif|ow)|p(?:i|ow(?:er)?|rintf|assword)|quote|r(?:a(?:dians|ndom(?:blob)?)|e(?:p(?:lace|eat)|verse)|ound|trim|ight)|s(?:i(?:gn|nh?)|oundex|q(?:lite_(?:compileoption_(?:get|used)|offset|source_id|version)|rt)|u(?:bstr(?:ing)?|m)|econd|leep)|t(?:anh?|otal(?:_changes)?|r(?:im|unc)|ypeof|ime)|u(?:n(?:icode|likely)|(?:pp|s)er)|zeroblob|bin|v(?:alues|ersion)|week|year)[^0-9A-Z_a-z]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack: SQL function name detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942150,"phase":2,"chain":false}},{"id":"942361","description":"Detects basic SQL injection based on keyword alter or union","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:^[\\W\\d]+\\s*?(?:alter|union)\\b)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects basic SQL injection based on keyword alter or union"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942361,"phase":2,"chain":false}},{"id":"942410","description":"SQL Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:(?:b|co)s|dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:in|cii(?:str)?)|tan2?|vg)|b(?:enchmark|i(?:n(?:_to_num)?|t_(?:and|count|length|x?or)))|c(?:ast|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|o(?:alesce|ercibility|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|(?:un)?t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|time(?:stamp)?|user)))|d(?:a(?:t(?:abase|e(?:_(?:add|format|sub)|diff)?)|y(?:name|of(?:month|week|year))?)|count|e(?:code|(?:faul|s_(?:de|en)cryp)t|grees)|ump)|e(?:lt|nc(?:ode|rypt)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:eld(?:_in_set)?|nd_in_set)|loor|o(?:rmat|und_rows)|rom_(?:base64|days|unixtime))|g(?:et_(?:format|lock)|r(?:eates|oup_conca)t)|h(?:ex(?:toraw)?|our)|i(?:f(?:null)?|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)?|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull))|null)?)|l(?:ast(?:_(?:day|insert_id))?|case|e(?:(?:as|f)t|ngth)|n|o(?:ad_file|ca(?:l(?:timestamp)?|te)|g(?:10|2)?|wer)|pad|trim)|m(?:a(?:ke(?:date|_set)|ster_pos_wait|x)|d5|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:d|nth(?:name)?))|n(?:ame_const|o(?:t_in|w)|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:assword|eriod_(?:add|diff)|g_sleep|i|o(?:sition|w(?:er)?)|rocedure_analyse)|qu(?:arter|ote)|r(?:a(?:dians|nd|wto(?:hex|nhex(?:toraw)?))|e(?:lease_lock|p(?:eat|lace)|verse)|ight|o(?:und|w_count)|pad|trim)|s(?:chema|e(?:c(?:ond|_to_time)|ssion_user)|ha[12]?|ig?n|leep|oundex|pace|qrt|t(?:d(?:dev(?:_(?:po|sam)p)?)?|r(?:cmp|_to_date))|u(?:b(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|m)|ys(?:date|tem_user))|t(?:an|ime(?:diff|_(?:format|to_sec)|stamp(?:add|diff)?)?|o_(?:base64|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|ix_timestamp)|p(?:datexml|per)|ser|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|v(?:a(?:lues|r(?:iance|_(?:po|sam)p))|ersion)|we(?:ek(?:day|ofyear)?|ight_string)|xmltype|year(?:week)?)[^0-9A-Z_a-z]*?\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942410,"phase":2,"chain":false}},{"id":"942470","description":"SQL Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)autonomous_transaction|(?:current_use|n?varcha|tbcreato)r|db(?:a_users|ms_java)|open(?:owa_util|query|rowset)|s(?:p_(?:(?:addextendedpro|sqlexe)c|execute(?:sql)?|help|is_srvrolemember|makewebtask|oacreate|p(?:assword|repare)|replwritetovarbin)|ql_(?:longvarchar|variant))|utl_(?:file|http)|xp_(?:availablemedia|(?:cmdshel|servicecontro)l|dirtree|e(?:numdsn|xecresultset)|filelist|loginconfig|makecab|ntsec(?:_enumdomains)?|reg(?:addmultistring|delete(?:key|value)|enum(?:key|value)s|re(?:ad|movemultistring)|write)|terminate(?:_process)?)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942470,"phase":2,"chain":false}},{"id":"942480","description":"SQL Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:(?:d(?:bms_[0-9A-Z_a-z]+\\.|elete\\b[^0-9A-Z_a-z]*?\\bfrom)|(?:group\\b.*?\\bby\\b.{1,100}?\\bhav|overlay\\b[^0-9A-Z_a-z]*?\\(.*?\\b[^0-9A-Z_a-z]*?plac)ing|in(?:ner\\b[^0-9A-Z_a-z]*?\\bjoin|sert\\b[^0-9A-Z_a-z]*?\\binto|to\\b[^0-9A-Z_a-z]*?\\b(?:dump|out)file)|load\\b[^0-9A-Z_a-z]*?\\bdata\\b.*?\\binfile|s(?:elect\\b.{1,100}?\\b(?:(?:.*?\\bdump\\b.*|(?:count|length)\\b.{1,100}?)\\bfrom|(?:data_typ|from\\b.{1,100}?\\bwher)e|instr|to(?:_(?:cha|numbe)r|p\\b.{1,100}?\\bfrom))|ys_context)|u(?:nion\\b.{1,100}?\\bselect|tl_inaddr))\\b|print\\b[^0-9A-Z_a-z]*?@@)|(?:collation[^0-9A-Z_a-z]*?\\(a|@@version|;[^0-9A-Z_a-z]*?\\b(?:drop|shutdown))\\b|'(?:dbo|msdasql|s(?:a|qloledb))'"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942480,"phase":2,"chain":false}},{"id":"942440","description":"SQL Comment Sequence Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"/\\*!?|\\*/|[';]--|--(?:[\\s\\x0b]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\x0b]|;?\\x00"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Comment Sequence Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":["UrlDecodeUni"],"id":942440,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^(?:ey[\\-0-9A-Z_a-z]+\\.ey[\\-0-9A-Z_a-z]+\\.)?[\\-0-9A-Z_a-z]+$"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"942450","description":"SQL Bin or Hex Encoding Identified","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:\\b0x[a-f\\d]{3,}|x\\'[a-f\\d]{3,}\\'|b\\'[0-1]{10,}\\')"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Bin or Hex Encoding Identified"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942450,"phase":2,"chain":false}},{"id":"942510","description":"SQLi bypass attempt by ticks or backticks detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:`(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)`)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQLi bypass attempt by ticks or backticks detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942510,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":{"Rx":"^(?:and|or)$"},"actions":[{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"942101","description":"SQL Injection Attack Detected via libinjection","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false}],"operator":"DetectSQLi","actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack Detected via libinjection"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","RemoveNulls"],"id":942101,"phase":1,"chain":false}},{"id":"942152","description":"SQL Injection Attack: SQL function name detected","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|eil(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|t)|rc32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|grees|s_(?:de|en)crypt)|ump)|e(?:lt|n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|object(?:_(?:agg|keys))?|e(?:ac|xtract_pat)h(?:_text)?|insert|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|insert_id)|case|e(?:as|f)t|i(?:kel(?:ihood|y)|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2)|wer)|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:(?:lyg|siti)on|w)|rocedure_analyse)|qu(?:arter|ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|pace|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp)|likely)|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack: SQL function name detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942152,"phase":1,"chain":false}},{"id":"942321","description":"Detects MySQL and PostgreSQL stored procedure/function injections","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"(?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects MySQL and PostgreSQL stored procedure/function injections"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942321,"phase":1,"chain":false}},{"id":"942015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942015,"phase":1,"chain":false}},{"id":"942016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942016,"phase":2,"chain":false}},{"id":"942251","description":"Detects HAVING injections","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\W+\\d*?\\s*?\\bhaving\\b\\s*?[^\\s\\-]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects HAVING injections"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942251,"phase":2,"chain":false}},{"id":"942460","description":"Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"\\W{4}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.sql_injection_score=+%{tx.warning_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":942460,"phase":2,"chain":false}},{"id":"942511","description":"SQLi bypass attempt by ticks detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:'(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)')"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQLi bypass attempt by ticks detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942511,"phase":2,"chain":false}},{"id":"942530","description":"SQLi query termination detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"';"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQLi query termination detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942530,"phase":2,"chain":false}},{"id":"942017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942017,"phase":1,"chain":false}},{"id":"942018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942018,"phase":2,"chain":false}},{"id":"943011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943011,"phase":1,"chain":false}},{"id":"943012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943012,"phase":2,"chain":false}},{"id":"943100","description":"Possible Session Fixation Attack: Setting Cookie Values in HTML","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:\\.cookie\\b.*?;\\W*?(?:expires|domain)\\W*?=|\\bhttp-equiv\\W+set-cookie\\b)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Session Fixation Attack: Setting Cookie Values in HTML"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-fixation"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SESSION-FIXATION"},{"Tag":"capec/1000/225/21/593/61"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.session_fixation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":943100,"phase":2,"chain":false}},{"id":"943110","description":"Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer"},{"LogData":"Matched Data: %{TX.0} found within %{TX.943110_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-fixation"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SESSION-FIXATION"},{"Tag":"capec/1000/225/21/593/61"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.943110_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase"],"id":943110,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"^(?:ht|f)tps?://(.*?)/"},"actions":[{"Tag":"FLAG:capture"}],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.session_fixation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"943120","description":"Possible Session Fixation Attack: SessionID Parameter Name with No Referer","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Session Fixation Attack: SessionID Parameter Name with No Referer"},{"LogData":"Matched Data: %{TX.0} found within %{TX.943120_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-fixation"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SESSION-FIXATION"},{"Tag":"capec/1000/225/21/593/61"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.943120_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase"],"id":943120,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.session_fixation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"943013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943013,"phase":1,"chain":false}},{"id":"943014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943014,"phase":2,"chain":false}},{"id":"943015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943015,"phase":1,"chain":false}},{"id":"943016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943016,"phase":2,"chain":false}},{"id":"943017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943017,"phase":1,"chain":false}},{"id":"943018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943018,"phase":2,"chain":false}},{"id":"944011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944011,"phase":1,"chain":false}},{"id":"944012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944012,"phase":2,"chain":false}},{"id":"944100","description":"Remote Command Execution: Suspicious Java class detected","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"java\\.lang\\.(?:runtime|processbuilder)"},"actions":["Block",{"Msg":"Remote Command Execution: Suspicious Java class detected"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/137/6"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":944100,"phase":2,"chain":false}},{"id":"944110","description":"Remote Command Execution: Java process spawn (CVE-2017-9805)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:runtime|processbuilder)"},"actions":["Block",{"Msg":"Remote Command Execution: Java process spawn (CVE-2017-9805)"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":["Lowercase"],"id":944110,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:unmarshaller|base64data|java\\.)"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"944120","description":"Remote Command Execution: Java serialization (CVE-2015-4852)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"},"actions":["Block",{"Msg":"Remote Command Execution: Java serialization (CVE-2015-4852)"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":["Lowercase"],"id":944120,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"(?:runtime|processbuilder)"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"944130","description":"Suspicious Java class detected","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"PmFromFile":"java-classes.data"},"actions":["Block",{"Msg":"Suspicious Java class detected"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":944130,"phase":2,"chain":false}},{"id":"944140","description":"Java Injection Attack: Java Script File Upload Found","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X.Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"Rx":".*\\.(?:jsp|jspx)\\.*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Java Injection Attack: Java Script File Upload Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-injection-java"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":944140,"phase":2,"chain":false}},{"id":"944150","description":"Potential Remote Command Execution: Log4j / Log4shell","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"},"actions":["Block","Log",{"Msg":"Potential Remote Command Execution: Log4j / Log4shell"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/137/6"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode"],"id":944150,"phase":2,"chain":false}},{"id":"944013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944013,"phase":1,"chain":false}},{"id":"944014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944014,"phase":2,"chain":false}},{"id":"944151","description":"Potential Remote Command Execution: Log4j / Log4shell","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"},"actions":["Block","Log",{"Msg":"Potential Remote Command Execution: Log4j / Log4shell"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/137/6"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode"],"id":944151,"phase":2,"chain":false}},{"id":"944200","description":"Magic bytes Detected, probable java serialization in use","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"\\xac\\xed\\x00\\x05"},"actions":["Block",{"Msg":"Magic bytes Detected, probable java serialization in use"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":944200,"phase":2,"chain":false}},{"id":"944210","description":"Magic bytes Detected Base64 Encoded, probable java serialization in use","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:rO0ABQ|KztAAU|Cs7QAF)"},"actions":["Block",{"Msg":"Magic bytes Detected Base64 Encoded, probable java serialization in use"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":944210,"phase":2,"chain":false}},{"id":"944240","description":"Remote Command Execution: Java serialization (CVE-2015-4852)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"},"actions":["Block",{"Msg":"Remote Command Execution: Java serialization (CVE-2015-4852)"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":944240,"phase":2,"chain":false}},{"id":"944250","description":"Remote Command Execution: Suspicious Java method detected","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"java\\b.+(?:runtime|processbuilder)"},"actions":["Block",{"Msg":"Remote Command Execution: Suspicious Java method detected"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":944250,"phase":2,"chain":false}},{"id":"944260","description":"Remote Command Execution: Malicious class-loading payload","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:class\\.module\\.classLoader\\.resources\\.context\\.parent\\.pipeline|springframework\\.context\\.support\\.FileSystemXmlApplicationContext)"},"actions":["Block",{"Msg":"Remote Command Execution: Malicious class-loading payload"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":944260,"phase":2,"chain":false}},{"id":"944015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944015,"phase":1,"chain":false}},{"id":"944016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944016,"phase":2,"chain":false}},{"id":"944300","description":"Base64 encoded string matched suspicious keyword","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:cnVudGltZQ|HJ1bnRpbWU|BydW50aW1l|cHJvY2Vzc2J1aWxkZXI|HByb2Nlc3NidWlsZGVy|Bwcm9jZXNzYnVpbGRlcg|Y2xvbmV0cmFuc2Zvcm1lcg|GNsb25ldHJhbnNmb3JtZXI|BjbG9uZXRyYW5zZm9ybWVy|Zm9yY2xvc3VyZQ|GZvcmNsb3N1cmU|Bmb3JjbG9zdXJl|aW5zdGFudGlhdGVmYWN0b3J5|Gluc3RhbnRpYXRlZmFjdG9yeQ|BpbnN0YW50aWF0ZWZhY3Rvcnk|aW5zdGFudGlhdGV0cmFuc2Zvcm1lcg|Gluc3RhbnRpYXRldHJhbnNmb3JtZXI|BpbnN0YW50aWF0ZXRyYW5zZm9ybWVy|aW52b2tlcnRyYW5zZm9ybWVy|Gludm9rZXJ0cmFuc2Zvcm1lcg|BpbnZva2VydHJhbnNmb3JtZXI|cHJvdG90eXBlY2xvbmVmYWN0b3J5|HByb3RvdHlwZWNsb25lZmFjdG9yeQ|Bwcm90b3R5cGVjbG9uZWZhY3Rvcnk|cHJvdG90eXBlc2VyaWFsaXphdGlvbmZhY3Rvcnk|HByb3RvdHlwZXNlcmlhbGl6YXRpb25mYWN0b3J5|Bwcm90b3R5cGVzZXJpYWxpemF0aW9uZmFjdG9yeQ|d2hpbGVjbG9zdXJl|HdoaWxlY2xvc3VyZQ|B3aGlsZWNsb3N1cmU)"},"actions":["Block",{"Msg":"Base64 encoded string matched suspicious keyword"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":944300,"phase":2,"chain":false}},{"id":"944017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944017,"phase":1,"chain":false}},{"id":"944018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944018,"phase":2,"chain":false}},{"id":"944152","description":"Potential Remote Command Execution: Log4j / Log4shell","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"},"actions":["Block","Log",{"Msg":"Potential Remote Command Execution: Log4j / Log4shell"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/137/6"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode"],"id":944152,"phase":2,"chain":false}},{"id":"949052","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"}],"transformations":[],"id":949052,"phase":1,"chain":false}},{"id":"949152","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"}],"transformations":[],"id":949152,"phase":1,"chain":false}},{"id":"949053","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"}],"transformations":[],"id":949053,"phase":1,"chain":false}},{"id":"949153","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"}],"transformations":[],"id":949153,"phase":1,"chain":false}},{"id":"949054","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"}],"transformations":[],"id":949054,"phase":1,"chain":false}},{"id":"949154","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"}],"transformations":[],"id":949154,"phase":1,"chain":false}},{"id":"949055","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"}],"transformations":[],"id":949055,"phase":1,"chain":false}},{"id":"949155","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"}],"transformations":[],"id":949155,"phase":1,"chain":false}},{"id":"949060","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"}],"transformations":[],"id":949060,"phase":2,"chain":false}},{"id":"949160","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"}],"transformations":[],"id":949160,"phase":2,"chain":false}},{"id":"949061","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"}],"transformations":[],"id":949061,"phase":2,"chain":false}},{"id":"949161","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"}],"transformations":[],"id":949161,"phase":2,"chain":false}},{"id":"949062","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"}],"transformations":[],"id":949062,"phase":2,"chain":false}},{"id":"949162","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"}],"transformations":[],"id":949162,"phase":2,"chain":false}},{"id":"949063","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"}],"transformations":[],"id":949063,"phase":2,"chain":false}},{"id":"949163","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"}],"transformations":[],"id":949163,"phase":2,"chain":false}},{"id":"949111","description":"Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_INBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Msg":"Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"},{"Tag":"anomaly-evaluation"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":949111,"phase":1,"chain":true}},{"id":"949110","description":"Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_INBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Msg":"Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"},{"Tag":"anomaly-evaluation"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":949110,"phase":2,"chain":false}},{"id":"949011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949011,"phase":1,"chain":false}},{"id":"949012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949012,"phase":2,"chain":false}},{"id":"949013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949013,"phase":1,"chain":false}},{"id":"949014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949014,"phase":2,"chain":false}},{"id":"949015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949015,"phase":1,"chain":false}},{"id":"949016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949016,"phase":2,"chain":false}},{"id":"949017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949017,"phase":1,"chain":false}},{"id":"949018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949018,"phase":2,"chain":false}},{"id":"950021","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"crs_skip_response_analysis"},"count":false,"negation":false}],"operator":{"Eq":"1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":950021,"phase":3,"chain":false}},{"id":"950010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950010,"phase":4,"chain":false}},{"id":"950011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950011,"phase":3,"chain":false}},{"id":"950012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950012,"phase":4,"chain":false}},{"id":"950130","description":"Directory Listing","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?:<(?:TITLE>Index of.*?<H|title>Index of.*?<h)1>Index of|>\\[To Parent Directory\\]</[Aa]><br>)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Directory Listing"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Tag":"capec/1000/118/116/54/127"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":950130,"phase":4,"chain":false}},{"id":"950140","description":"CGI source code leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^#\\!\\s?/"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"CGI source code leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":950140,"phase":4,"chain":false}},{"id":"950150","description":"ASP.NET exception leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"asp-dotnet-errors.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"ASP.NET exception leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-aspnet"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Tag":"capec/1000/118/116/54/127"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":950150,"phase":4,"chain":false}},{"id":"950013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950013,"phase":3,"chain":false}},{"id":"950014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950014,"phase":4,"chain":false}},{"id":"950100","description":"The Application Returned a 500-Level Status Code","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_STATUS"},"count":false,"negation":false}],"operator":{"Rx":"^5\\d{2}$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"The Application Returned a 500-Level Status Code"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Tag":"capec/1000/152"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"}],"transformations":[],"id":950100,"phase":3,"chain":false}},{"id":"950015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950015,"phase":3,"chain":false}},{"id":"950016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950016,"phase":4,"chain":false}},{"id":"950017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950017,"phase":3,"chain":false}},{"id":"950018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950018,"phase":4,"chain":false}},{"id":"951010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951010,"phase":4,"chain":false}},{"id":"951011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951011,"phase":3,"chain":false}},{"id":"951012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951012,"phase":4,"chain":false}},{"id":"951100","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"!@pmFromFile sql-errors.data"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-SQL-ERROR-MATCH-PL1"}],"transformations":[],"id":951100,"phase":4,"chain":false}},{"id":"951110","description":"Microsoft Access SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:JET Database Engine|Access Database Engine|\\[Microsoft\\]\\[ODBC Microsoft Access Driver\\])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Microsoft Access SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-msaccess"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951110,"phase":4,"chain":false}},{"id":"951120","description":"Oracle SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\bORA-[0-9][0-9][0-9][0-9][0-9]:|java\\.sql\\.SQLException|Oracle(?: erro|[^\\(\\)]{0,20}Drive)r|Warning.{1,10}o(?:ci_.{1,30}|ra_.{1,20})"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Oracle SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-oracle"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951120,"phase":4,"chain":false}},{"id":"951130","description":"DB2 SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:DB2 SQL error:|\\[IBM\\]\\[CLI Driver\\]\\[DB2/6000\\]|CLI Driver.*DB2|DB2 SQL error|db2_\\w+\\()"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"DB2 SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-db2"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951130,"phase":4,"chain":false}},{"id":"951140","description":"EMC SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:\\[DM_QUERY_E_SYNTAX\\]|has occurred in the vicinity of:)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"EMC SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-emc"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951140,"phase":4,"chain":false}},{"id":"951150","description":"firebird SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)Dynamic SQL Error"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"firebird SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-firebird"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951150,"phase":4,"chain":false}},{"id":"951160","description":"Frontbase SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)Exception (?:condition )?\\d+\\. Transaction rollback\\."},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Frontbase SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-frontbase"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951160,"phase":4,"chain":false}},{"id":"951170","description":"hsqldb SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)org\\.hsqldb\\.jdbc"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"hsqldb SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-hsqldb"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951170,"phase":4,"chain":false}},{"id":"951180","description":"informix SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:An illegal character has been found in the statement|com\\.informix\\.jdbc|Exception.*Informix)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"informix SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-informix"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951180,"phase":4,"chain":false}},{"id":"951190","description":"ingres SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:Warning.*ingres_|Ingres SQLSTATE|Ingres\\W.*Driver)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"ingres SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-ingres"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951190,"phase":4,"chain":false}},{"id":"951200","description":"interbase SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:<b>Warning</b>: ibase_|Unexpected end of command in statement)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"interbase SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-interbase"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951200,"phase":4,"chain":false}},{"id":"951210","description":"maxDB SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)Warning.{1,10}maxdb[\\(\\)_a-z:]{1,26}:"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"maxDB SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-maxdb"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951210,"phase":4,"chain":false}},{"id":"951220","description":"mssql SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:System\\.Data\\.OleDb\\.OleDbException|\\[Microsoft\\]\\[ODBC SQL Server Driver\\]|\\[Macromedia\\]\\[SQLServer JDBC Driver\\]|\\[SqlException|System\\.Data\\.SqlClient\\.SqlException|Unclosed quotation mark after the character string|'80040e14'|mssql_query\\(\\)|Microsoft OLE DB Provider for ODBC Drivers|Microsoft OLE DB Provider for SQL Server|Incorrect syntax near|Sintaxis incorrecta cerca de|Syntax error in string in query expression|Procedure or function '.{1,128}' expects parameter|Unclosed quotation mark before the character string|Syntax error .* in query expression|Data type mismatch in criteria expression\\.|ADODB\\.Field \\(0x800A0BCD\\)|the used select statements have different number of columns|OLE DB.*SQL Server|Warning.*mssql_.*|Driver.*SQL[ _-]*Server|Exception.*\\WSystem\\.Data\\.SqlClient\\.|Conversion failed when converting the varchar value .*? to data type int\\.)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"mssql SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-mssql"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951220,"phase":4,"chain":false}},{"id":"951230","description":"mysql SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:supplied argument is not a valid |SQL syntax.*)MySQL|Column count doesn't match(?: value count at row)?|mysql_fetch_array\\(\\)|on MySQL result index|You have an error in your SQL syntax(?:;| near)|MyS(?:QL server version for the right syntax to use|qlClient\\.)|\\[MySQL\\]\\[ODBC|(?:Table '[^']+' doesn't exis|valid MySQL resul)t|Warning.{1,10}mysql_(?:[\\(\\)_a-z]{1,26})?|(?:ERROR [0-9]{4} \\([0-9a-z]{5}\\)|XPATH syntax error):"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"mysql SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-mysql"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951230,"phase":4,"chain":false}},{"id":"951240","description":"postgres SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)P(?:ostgreSQL(?: query failed:|.{1,20}ERROR)|G::[a-z]*Error)|(?:pg_(?:query|exec)\\(\\) \\[|org\\.postgresql\\.util\\.PSQLException):|Warning.{1,20}\\bpg_.*|valid PostgreSQL result|Npgsql\\.|Supplied argument is not a valid PostgreSQL .*? resource|(?:Unable to connect to PostgreSQL serv|invalid input syntax for integ)er"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"postgres SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-pgsql"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951240,"phase":4,"chain":false}},{"id":"951250","description":"sqlite SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:Warning.*sqlite_|Warning.*SQLite3::|SQLite/JDBCDriver|SQLite\\.Exception|System\\.Data\\.SQLite\\.SQLiteException)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"sqlite SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-sqlite"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951250,"phase":4,"chain":false}},{"id":"951260","description":"Sybase SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:Sybase message:|Warning.{2,20}sybase|Sybase.*Server message)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Sybase SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-sybase"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951260,"phase":4,"chain":false}},{"id":"951013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951013,"phase":3,"chain":false}},{"id":"951014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951014,"phase":4,"chain":false}},{"id":"951015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951015,"phase":3,"chain":false}},{"id":"951016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951016,"phase":4,"chain":false}},{"id":"951017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951017,"phase":3,"chain":false}},{"id":"951018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951018,"phase":4,"chain":false}},{"id":"952010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-JAVA"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952010,"phase":4,"chain":false}},{"id":"952011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952011,"phase":3,"chain":false}},{"id":"952012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952012,"phase":4,"chain":false}},{"id":"952013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952013,"phase":3,"chain":false}},{"id":"952014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952014,"phase":4,"chain":false}},{"id":"952015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952015,"phase":3,"chain":false}},{"id":"952016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952016,"phase":4,"chain":false}},{"id":"952017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952017,"phase":3,"chain":false}},{"id":"952018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952018,"phase":4,"chain":false}},{"id":"953010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-PHP"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953010,"phase":4,"chain":false}},{"id":"953011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953011,"phase":3,"chain":false}},{"id":"953012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953012,"phase":4,"chain":false}},{"id":"953100","description":"PHP Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"php-errors.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-PHP"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":953100,"phase":4,"chain":false}},{"id":"953110","description":"PHP source code leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?:\\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\\$_(?:(?:pos|ge)t|session))\\b"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP source code leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-PHP"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":953110,"phase":4,"chain":false}},{"id":"953120","description":"PHP source code leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<\\?(?:=|php)?\\s+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP source code leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-PHP"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":953120,"phase":4,"chain":false}},{"id":"953013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953013,"phase":3,"chain":false}},{"id":"953014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953014,"phase":4,"chain":false}},{"id":"953015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953015,"phase":3,"chain":false}},{"id":"953016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953016,"phase":4,"chain":false}},{"id":"953017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953017,"phase":3,"chain":false}},{"id":"953018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953018,"phase":4,"chain":false}},{"id":"954010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954010,"phase":4,"chain":false}},{"id":"954011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954011,"phase":3,"chain":false}},{"id":"954012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954012,"phase":4,"chain":false}},{"id":"954100","description":"Disclosure of IIS install location","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)[a-z]:[\\x5c/]inetpub\\b"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Disclosure of IIS install location"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":954100,"phase":4,"chain":false}},{"id":"954110","description":"Application Availability Error","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?:Microsoft OLE DB Provider for SQL Server(?:</font>.{1,20}?error '800(?:04005|40e31)'.{1,40}?Timeout expired| \\(0x80040e31\\)<br>Timeout expired<br>)|<h1>internal server error</h1>.*?<h2>part of the server has crashed or it has a configuration error\\.</h2>|cannot connect to the server: timed out)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Application Availability Error"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":954110,"phase":4,"chain":false}},{"id":"954120","description":"IIS Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"iis-errors.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IIS Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":954120,"phase":4,"chain":false}},{"id":"954130","description":"IIS Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_STATUS"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^404$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IIS Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"}],"transformations":[],"id":954130,"phase":4,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"\\bServer Error in.{0,50}?\\bApplication\\b"},"actions":[{"Tag":"FLAG:capture"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"954013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954013,"phase":3,"chain":false}},{"id":"954014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954014,"phase":4,"chain":false}},{"id":"954101","description":"Disclosure of IIS install location","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)[\\x5c/]inetpub\\b"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Disclosure of IIS install location"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"}],"transformations":[],"id":954101,"phase":4,"chain":false}},{"id":"954015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954015,"phase":3,"chain":false}},{"id":"954016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954016,"phase":4,"chain":false}},{"id":"954017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954017,"phase":3,"chain":false}},{"id":"954018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954018,"phase":4,"chain":false}},{"id":"955010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955010,"phase":4,"chain":false}},{"id":"955011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955011,"phase":3,"chain":false}},{"id":"955012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955012,"phase":4,"chain":false}},{"id":"955100","description":"PHP Web shell detected","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"web-shells-php.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Web shell detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955100,"phase":4,"chain":false}},{"id":"955110","description":"r57 web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>r57 Shell Version [0-9.]+</title>|<title>r57 shell</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"r57 web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955110,"phase":4,"chain":false}},{"id":"955120","description":"WSO web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html><head><meta http-equiv='Content-Type' content='text/html; charset=(?:Windows-1251|UTF-8)?'><title>.*?(?: -)? W[Ss][Oo] [0-9.]+</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"WSO web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955120,"phase":4,"chain":false}},{"id":"955130","description":"b4tm4n web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"B4TM4N SH3LL</title>[^<]*<meta name='author' content='k4mpr3t'/>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"b4tm4n web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955130,"phase":4,"chain":false}},{"id":"955140","description":"Mini Shell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>Mini Shell</title>[^D]*Developed By LameHacker"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Mini Shell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955140,"phase":4,"chain":false}},{"id":"955150","description":"Ashiyane web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>\\.:: [^~]*~ Ashiyane V [0-9.]+ ::\\.</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Ashiyane web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955150,"phase":4,"chain":false}},{"id":"955160","description":"Symlink_Sa web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>Symlink_Sa [0-9.]+</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Symlink_Sa web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955160,"phase":4,"chain":false}},{"id":"955170","description":"CasuS web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>CasuS [0-9.]+ by MafiABoY</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"CasuS web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955170,"phase":4,"chain":false}},{"id":"955180","description":"GRP WebShell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html>\\r\\n<head>\\r\\n<title>GRP WebShell [0-9.]+ "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"GRP WebShell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955180,"phase":4,"chain":false}},{"id":"955190","description":"NGHshell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<small>NGHshell [0-9.]+ by Cr4sh</body></html>\\n$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"NGHshell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955190,"phase":4,"chain":false}},{"id":"955200","description":"SimAttacker web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>SimAttacker - (?:Version|Vrsion) : [0-9.]+ - "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SimAttacker web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955200,"phase":4,"chain":false}},{"id":"955210","description":"Unknown web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<!DOCTYPE html>\\n<html>\\n<!-- By Artyum [^<]*<title>Web Shell</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Unknown web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955210,"phase":4,"chain":false}},{"id":"955220","description":"lama\\'s\\'hell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>lama's'hell v. [0-9.]+</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"lama\\'s\\'hell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955220,"phase":4,"chain":false}},{"id":"955230","description":"lostDC web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^ *<html>\\n[ ]+<head>\\n[ ]+<title>lostDC - "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"lostDC web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955230,"phase":4,"chain":false}},{"id":"955240","description":"Unknown web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<title>PHP Web Shell</title>\\r\\n<html>\\r\\n<body>\\r\\n    <!-- Replaces command with Base64-encoded Data -->"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Unknown web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955240,"phase":4,"chain":false}},{"id":"955260","description":"Ru24PostWebShell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html>\\n<head>\\n<title>Ru24PostWebShell "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Ru24PostWebShell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955260,"phase":4,"chain":false}},{"id":"955270","description":"s72 Shell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>s72 Shell v[0-9.]+ Codinf by Cr@zy_King</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"s72 Shell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955270,"phase":4,"chain":false}},{"id":"955290","description":"g00nshell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^ <html>\\n\\n<head>\\n\\n<title>g00nshell v[0-9.]+ "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"g00nshell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955290,"phase":4,"chain":false}},{"id":"955300","description":"PuNkHoLic shell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Contains":"<title>punkholicshell</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PuNkHoLic shell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["RemoveWhitespace","Lowercase"],"id":955300,"phase":4,"chain":false}},{"id":"955310","description":"azrail web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html>\\n      <head>\\n             <title>azrail [0-9.]+ by C-W-M</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"azrail web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955310,"phase":4,"chain":false}},{"id":"955320","description":"SmEvK_PaThAn Shell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":">SmEvK_PaThAn Shell v[0-9]+ coded by <a href="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SmEvK_PaThAn Shell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955320,"phase":4,"chain":false}},{"id":"955330","description":"Shell I web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html>\\n<title>[^~]*~ Shell I</title>\\n<head>\\n<style>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Shell I web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955330,"phase":4,"chain":false}},{"id":"955340","description":"b374k m1n1 web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^ <html><head><title>:: b374k m1n1 [0-9.]+ ::</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"b374k m1n1 web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955340,"phase":4,"chain":false}},{"id":"955400","description":"ASP Web shell detected","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"web-shells-asp.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"ASP Web shell detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955400,"phase":4,"chain":false}},{"id":"955013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955013,"phase":3,"chain":false}},{"id":"955014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955014,"phase":4,"chain":false}},{"id":"955015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955015,"phase":3,"chain":false}},{"id":"955016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955016,"phase":4,"chain":false}},{"id":"955017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955017,"phase":3,"chain":false}},{"id":"955018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955018,"phase":4,"chain":false}},{"id":"956010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-RUBY"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956010,"phase":4,"chain":false}},{"id":"956011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956011,"phase":3,"chain":false}},{"id":"956012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956012,"phase":4,"chain":false}},{"id":"956100","description":"RUBY Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"ruby-errors.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RUBY Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-ruby"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-RUBY"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":956100,"phase":4,"chain":false}},{"id":"956013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956013,"phase":3,"chain":false}},{"id":"956014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956014,"phase":4,"chain":false}},{"id":"956110","description":"Ruby source code leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:<%[=#\\s]|#\\{[^}]+\\})"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Ruby source code leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-ruby"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-RUBY"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"}],"transformations":[],"id":956110,"phase":4,"chain":false}},{"id":"956015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956015,"phase":3,"chain":false}},{"id":"956016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956016,"phase":4,"chain":false}},{"id":"956017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956017,"phase":3,"chain":false}},{"id":"956018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956018,"phase":4,"chain":false}},{"id":"959052","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"}],"transformations":[],"id":959052,"phase":3,"chain":false}},{"id":"959152","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"}],"transformations":[],"id":959152,"phase":3,"chain":false}},{"id":"959053","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"}],"transformations":[],"id":959053,"phase":3,"chain":false}},{"id":"959153","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"}],"transformations":[],"id":959153,"phase":3,"chain":false}},{"id":"959054","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"}],"transformations":[],"id":959054,"phase":3,"chain":false}},{"id":"959154","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"}],"transformations":[],"id":959154,"phase":3,"chain":false}},{"id":"959055","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"}],"transformations":[],"id":959055,"phase":3,"chain":false}},{"id":"959155","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"}],"transformations":[],"id":959155,"phase":3,"chain":false}},{"id":"959060","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"}],"transformations":[],"id":959060,"phase":4,"chain":false}},{"id":"959160","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"}],"transformations":[],"id":959160,"phase":4,"chain":false}},{"id":"959061","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"}],"transformations":[],"id":959061,"phase":4,"chain":false}},{"id":"959161","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"}],"transformations":[],"id":959161,"phase":4,"chain":false}},{"id":"959062","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"}],"transformations":[],"id":959062,"phase":4,"chain":false}},{"id":"959162","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"}],"transformations":[],"id":959162,"phase":4,"chain":false}},{"id":"959063","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"}],"transformations":[],"id":959063,"phase":4,"chain":false}},{"id":"959163","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"}],"transformations":[],"id":959163,"phase":4,"chain":false}},{"id":"959101","description":"Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_OUTBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Msg":"Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})"},{"Tag":"anomaly-evaluation"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":959101,"phase":3,"chain":true}},{"id":"959100","description":"Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_OUTBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Msg":"Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})"},{"Tag":"anomaly-evaluation"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":959100,"phase":4,"chain":false}},{"id":"959011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959011,"phase":3,"chain":false}},{"id":"959012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959012,"phase":4,"chain":false}},{"id":"959013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959013,"phase":3,"chain":false}},{"id":"959014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959014,"phase":4,"chain":false}},{"id":"959015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959015,"phase":3,"chain":false}},{"id":"959016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959016,"phase":4,"chain":false}},{"id":"959017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959017,"phase":3,"chain":false}},{"id":"959018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959018,"phase":4,"chain":false}},{"id":"980041","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980041,"phase":5,"chain":false}},{"id":"980042","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 5"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980042,"phase":5,"chain":false}},{"id":"980043","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980043,"phase":5,"chain":false}},{"id":"980044","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_INBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980044,"phase":5,"chain":false}},{"id":"980045","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_OUTBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980045,"phase":5,"chain":false}},{"id":"980046","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980046,"phase":5,"chain":false}},{"id":"980047","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_INBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980047,"phase":5,"chain":false}},{"id":"980048","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_OUTBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980048,"phase":5,"chain":false}},{"id":"980049","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980049,"phase":5,"chain":false}},{"id":"980050","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":{"Gt":0},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980050,"phase":5,"chain":false}},{"id":"980051","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980051,"phase":5,"chain":false}},{"id":"980011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980011,"phase":1,"chain":false}},{"id":"980012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980012,"phase":2,"chain":false}},{"id":"980013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980013,"phase":1,"chain":false}},{"id":"980014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980014,"phase":2,"chain":false}},{"id":"980015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980015,"phase":1,"chain":false}},{"id":"980016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980016,"phase":2,"chain":false}},{"id":"980017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980017,"phase":1,"chain":false}},{"id":"980018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980018,"phase":2,"chain":false}},{"id":"901001","description":"CRS is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"crs_setup_version"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"Deny":403},{"Tag":"UNKNOWN:status:500"},"Log",{"Tag":"FLAG:auditlog"},{"Msg":"CRS is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":901001,"phase":1,"chain":false}},{"id":"901100","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"inbound_anomaly_score_threshold"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.inbound_anomaly_score_threshold=5"}],"transformations":[],"id":901100,"phase":1,"chain":false}},{"id":"901110","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"outbound_anomaly_score_threshold"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.outbound_anomaly_score_threshold=4"}],"transformations":[],"id":901110,"phase":1,"chain":false}},{"id":"901111","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"reporting_level"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.reporting_level=4"}],"transformations":[],"id":901111,"phase":1,"chain":false}},{"id":"901115","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"early_blocking"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.early_blocking=0"}],"transformations":[],"id":901115,"phase":1,"chain":false}},{"id":"901120","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"blocking_paranoia_level"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_paranoia_level=1"}],"transformations":[],"id":901120,"phase":1,"chain":false}},{"id":"901125","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"detection_paranoia_level"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_paranoia_level=%{TX.blocking_paranoia_level}"}],"transformations":[],"id":901125,"phase":1,"chain":false}},{"id":"901130","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"sampling_percentage"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.sampling_percentage=100"}],"transformations":[],"id":901130,"phase":1,"chain":false}},{"id":"901140","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"critical_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.critical_anomaly_score=5"}],"transformations":[],"id":901140,"phase":1,"chain":false}},{"id":"901141","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"error_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.error_anomaly_score=4"}],"transformations":[],"id":901141,"phase":1,"chain":false}},{"id":"901142","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"warning_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.warning_anomaly_score=3"}],"transformations":[],"id":901142,"phase":1,"chain":false}},{"id":"901143","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"notice_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.notice_anomaly_score=2"}],"transformations":[],"id":901143,"phase":1,"chain":false}},{"id":"901160","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allowed_methods"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allowed_methods=GET HEAD POST OPTIONS"}],"transformations":[],"id":901160,"phase":1,"chain":false}},{"id":"901162","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allowed_request_content_type"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |text/xml| |application/xml| |application/soap+xml| |application/json|"}],"transformations":[],"id":901162,"phase":1,"chain":false}},{"id":"901168","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allowed_request_content_type_charset"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allowed_request_content_type_charset=|utf-8| |iso-8859-1| |iso-8859-15| |windows-1252|"}],"transformations":[],"id":901168,"phase":1,"chain":false}},{"id":"901163","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allowed_http_versions"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0"}],"transformations":[],"id":901163,"phase":1,"chain":false}},{"id":"901164","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"restricted_extensions"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.restricted_extensions=.ani/ .asa/ .asax/ .ascx/ .back/ .backup/ .bak/ .bck/ .bk/ .bkp/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .cnf/ .com/ .compositefont/ .config/ .conf/ .copy/ .crt/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dist/ .dll/ .dos/ .dpkg-dist/ .drv/ .gadget/ .hta/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .inf/ .ini/ .jks/ .jse/ .key/ .licx/ .lnk/ .log/ .mdb/ .msc/ .ocx/ .old/ .pass/ .pdb/ .pfx/ .pif/ .pem/ .pol/ .prf/ .printer/ .pwd/ .rdb/ .rdp/ .reg/ .resources/ .resx/ .sav/ .save/ .scr/ .sct/ .sh/ .shs/ .sql/ .sqlite/ .sqlite3/ .swap/ .swo/ .swp/ .sys/ .temp/ .tfstate/ .tlb/ .tmp/ .vb/ .vbe/ .vbs/ .vbproj/ .vsdisco/ .vxd/ .webinfo/ .ws/ .wsc/ .wsf/ .wsh/ .xsd/ .xsx/"}],"transformations":[],"id":901164,"phase":1,"chain":false}},{"id":"901165","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"restricted_headers_basic"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.restricted_headers_basic=/content-encoding/ /proxy/ /lock-token/ /content-range/ /if/ /x-http-method-override/ /x-http-method/ /x-method-override/ /x-middleware-subrequest/ /expect/"}],"transformations":[],"id":901165,"phase":1,"chain":false}},{"id":"901171","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"restricted_headers_extended"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.restricted_headers_extended=/accept-charset/"}],"transformations":[],"id":901171,"phase":1,"chain":false}},{"id":"901510","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allow_method_override_parameter"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.allow_method_override_parameter=0"}],"transformations":[],"id":901510,"phase":1,"chain":false}},{"id":"901167","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"enforce_bodyproc_urlencoded"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.enforce_bodyproc_urlencoded=0"}],"transformations":[],"id":901167,"phase":1,"chain":false}},{"id":"901169","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"crs_validate_utf8_encoding"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.crs_validate_utf8_encoding=0"}],"transformations":[],"id":901169,"phase":1,"chain":false}},{"id":"901170","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"crs_skip_response_analysis"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.crs_skip_response_analysis=0"}],"transformations":[],"id":901170,"phase":1,"chain":false}},{"id":"901320","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ENABLE_DEFAULT_COLLECTIONS"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.ua_hash=%{REQUEST_HEADERS.User-Agent}"}],"transformations":[],"id":901320,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ENABLE_DEFAULT_COLLECTIONS"},"count":false,"negation":false}],"operator":{"Eq":"1"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ua_hash"},"count":false,"negation":false}],"operator":{"Rx":"@unconditionalMatch"},"actions":[{"Tag":"UNKNOWN:initcol:global=global"},{"Tag":"UNKNOWN:initcol:ip=%{remote_addr}_%{MATCHED_VAR}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"901340","description":"Enabling body inspection","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQBODY_PROCESSOR"},"count":false,"negation":false}],"operator":{"Rx":"!@rx (?:URLENCODED|MULTIPART|XML|JSON)"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"FLAG:noauditlog"},{"Msg":"Enabling body inspection"},{"Tag":"OWASP_CRS"},{"Ctl":["","forceRequestBodyVariable=On"]},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":901340,"phase":1,"chain":false}},{"id":"901350","description":"Enabling forced body inspection for ASCII content","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"enforce_bodyproc_urlencoded"},"count":false,"negation":false}],"operator":{"Eq":"1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"FLAG:noauditlog"},{"Msg":"Enabling forced body inspection for ASCII content"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":["UrlDecodeUni"],"id":901350,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQBODY_PROCESSOR"},"count":false,"negation":false}],"operator":{"Rx":"!@rx (?:URLENCODED|MULTIPART|XML|JSON)"},"actions":[{"Ctl":["","requestBodyProcessor=URLENCODED"]}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"901400","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"sampling_percentage"},"count":false,"negation":false}],"operator":{"Eq":"100"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-SAMPLING"}],"transformations":[],"id":901400,"phase":1,"chain":false}},{"id":"901410","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"UNIQUE_ID"},"count":false,"negation":false}],"operator":{"Rx":"^[a-f]*([0-9])[a-f]*([0-9])"},"actions":["Pass",{"Tag":"FLAG:capture"},{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"TX.sampling_rnd100=%{TX.1}%{TX.2}"}],"transformations":[],"id":901410,"phase":1,"chain":false}},{"id":"901450","description":"Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"sampling_rnd100"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass","Log",{"Tag":"FLAG:noauditlog"},{"Msg":"Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}"},{"Tag":"OWASP_CRS"},{"Ctl":["","ruleRemoveByTag=OWASP_CRS"]},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":901450,"phase":1,"chain":false}},{"id":"901500","description":"Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"detection_paranoia_level"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Tag":"UNKNOWN:status:500"},"Log",{"Msg":"Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":901500,"phase":1,"chain":false}},{"id":"905100","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false}],"operator":{"StrEq":"GET /"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-apache"},{"Tag":"attack-generic"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":905100,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RemoteAddr","count":false,"negation":false}],"operator":{"Rx":"@ipMatch 127.0.0.1,::1"},"actions":[{"Ctl":["","ruleRemoveByTag=OWASP_CRS"]},{"Ctl":["","auditEngine=Off"]}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"905110","description":"No description","enabled":true,"details":{"variables":[{"variable":"RemoteAddr","count":false,"negation":false}],"operator":{"Rx":"@ipMatch 127.0.0.1,::1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-apache"},{"Tag":"attack-generic"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":905110,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"EndsWith":"(internal dummy connection)"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false}],"operator":{"Rx":"^(?:GET /|OPTIONS \\*) HTTP/[12]\\.[01]$"},"actions":[{"Ctl":["","ruleRemoveByTag=OWASP_CRS"]},{"Ctl":["","auditEngine=Off"]}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"911011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911011,"phase":1,"chain":false}},{"id":"911012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911012,"phase":2,"chain":false}},{"id":"911100","description":"Method is not allowed by policy","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":"NoOp","actions":["Block",{"Msg":"Method is not allowed by policy"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-generic"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/METHOD-ENFORCEMENT"},{"Tag":"capec/1000/210/272/220/274"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":911100,"phase":1,"chain":false}},{"id":"911013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911013,"phase":1,"chain":false}},{"id":"911014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911014,"phase":2,"chain":false}},{"id":"911015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911015,"phase":1,"chain":false}},{"id":"911016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911016,"phase":2,"chain":false}},{"id":"911017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911017,"phase":1,"chain":false}},{"id":"911018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-911-METHOD-ENFORCEMENT"}],"transformations":[],"id":911018,"phase":2,"chain":false}},{"id":"913011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913011,"phase":1,"chain":false}},{"id":"913012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913012,"phase":2,"chain":false}},{"id":"913100","description":"Found User-Agent associated with security scanner","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"PmFromFile":"scanners-user-agents.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Found User-Agent associated with security scanner"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-reputation-scanner"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/SCANNER-DETECTION"},{"Tag":"capec/1000/118/224/541/310"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":913100,"phase":1,"chain":false}},{"id":"913013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913013,"phase":1,"chain":false}},{"id":"913014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913014,"phase":2,"chain":false}},{"id":"913015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913015,"phase":1,"chain":false}},{"id":"913016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913016,"phase":2,"chain":false}},{"id":"913017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913017,"phase":1,"chain":false}},{"id":"913018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-913-SCANNER-DETECTION"}],"transformations":[],"id":913018,"phase":2,"chain":false}},{"id":"920011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920011,"phase":1,"chain":false}},{"id":"920012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920012,"phase":2,"chain":false}},{"id":"920100","description":"Invalid HTTP Request Line","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false}],"operator":{"Rx":"!@rx (?i)^(?:get /[^#\\?]*(?:\\?[^\\s\\x0b#]*)?(?:#[^\\s\\x0b]*)?|(?:connect (?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\.?(?::[0-9]+)?|[\\--9A-Z_a-z]+:[0-9]+)|options \\*|[a-z]{3,10}[\\s\\x0b]+(?:[0-9A-Z_a-z]{3,7}?://[\\--9A-Z_a-z]*(?::[0-9]+)?)?/[^#\\?]*(?:\\?[^\\s\\x0b#]*)?(?:#[^\\s\\x0b]*)?)[\\s\\x0b]+[\\.-9A-Z_a-z]+)$"},"actions":["Block",{"Msg":"Invalid HTTP Request Line"},{"LogData":"%{request_line}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920100,"phase":1,"chain":false}},{"id":"920160","description":"Content-Length HTTP header is not numeric","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^\\d+$"},"actions":["Block",{"Msg":"Content-Length HTTP header is not numeric"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920160,"phase":1,"chain":false}},{"id":"920170","description":"GET or HEAD Request with Body Content","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"^(?:GET|HEAD)$"},"actions":["Block",{"Msg":"GET or HEAD Request with Body Content"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920170,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^0?$"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920171","description":"GET or HEAD Request with Transfer-Encoding","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"^(?:GET|HEAD)$"},"actions":["Block",{"Msg":"GET or HEAD Request with Transfer-Encoding"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920171,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Transfer-Encoding"},"count":true,"negation":false}],"operator":{"Rx":"!@eq 0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920180","description":"POST without Content-Length and Transfer-Encoding headers","enabled":true,"details":{"variables":[{"variable":"RequestProtocol","count":false,"negation":false}],"operator":{"Rx":"!@within HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0"},"actions":["Block",{"Msg":"POST without Content-Length and Transfer-Encoding headers"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920180,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"StrEq":"POST"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Transfer-Encoding"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920181","description":"Content-Length and Transfer-Encoding headers present","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Transfer-Encoding"},"count":true,"negation":false}],"operator":{"Rx":"!@eq 0"},"actions":["Block",{"Msg":"Content-Length and Transfer-Encoding headers present"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920181,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":true,"negation":false}],"operator":{"Rx":"!@eq 0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920190","description":"Range: Invalid Last Byte Value","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Request-Range"},"count":false,"negation":false}],"operator":{"Rx":"(\\d+)-(\\d+)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Range: Invalid Last Byte Value"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920190,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"2"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920210","description":"Multiple/Conflicting Connection Header Data Found","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Connection"},"count":false,"negation":false}],"operator":{"Rx":"\\b(?:keep-alive|close),\\s?(?:keep-alive|close)\\b"},"actions":["Block",{"Msg":"Multiple/Conflicting Connection Header Data Found"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920210,"phase":1,"chain":false}},{"id":"920250","description":"UTF8 Encoding Abuse Attack Attempt","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"CRS_VALIDATE_UTF8_ENCODING"},"count":false,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"UTF8 Encoding Abuse Attack Attempt"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920250,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"@validateUtf8Encoding"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920260","description":"Unicode Full/Half Width Abuse Attack Attempt","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"(?i)%uff[0-9a-f]{2}"},"actions":["Block",{"Msg":"Unicode Full/Half Width Abuse Attack Attempt"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267/72"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920260,"phase":2,"chain":false}},{"id":"920270","description":"Invalid character in request (null character)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"@validateByteRange 1-255"},"actions":["Block",{"Msg":"Invalid character in request (null character)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920270,"phase":2,"chain":false}},{"id":"920280","description":"Request Missing a Host Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Host"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Block",{"Msg":"Request Missing a Host Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SkipAfter":"END-HOST-CHECK"}],"transformations":[],"id":920280,"phase":1,"chain":false}},{"id":"920290","description":"Empty Host Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Host"},"count":false,"negation":false}],"operator":{"Rx":"^$"},"actions":["Block",{"Msg":"Empty Host Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920290,"phase":1,"chain":false}},{"id":"920310","description":"Request Has an Empty Accept Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept"},"count":false,"negation":false}],"operator":{"Rx":"^$"},"actions":["Block",{"Msg":"Request Has an Empty Accept Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"}],"transformations":[],"id":920310,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"!@rx ^OPTIONS$"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"!@pm AppleWebKit Android Business Enterprise Entreprise"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920311","description":"Request Has an Empty Accept Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept"},"count":false,"negation":false}],"operator":{"Rx":"^$"},"actions":["Block",{"Msg":"Request Has an Empty Accept Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"}],"transformations":[],"id":920311,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"!@rx ^OPTIONS$"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920330","description":"Empty User Agent Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"^$"},"actions":["Block",{"Msg":"Empty User Agent Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":920330,"phase":1,"chain":false}},{"id":"920340","description":"Content-Type header missing from request with non-zero Content-Length","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^0$"},"actions":["Block",{"Msg":"Content-Type header missing from request with non-zero Content-Length"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920340,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920350","description":"Host header is a numeric IP address","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Host"},"count":false,"negation":false}],"operator":{"Rx":"(?:^([\\d.]+|\\[[\\da-f:]+\\]|[\\da-f:]+)(:[\\d]+)?$)"},"actions":["Block",{"Msg":"Host header is a numeric IP address"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920350,"phase":1,"chain":false}},{"id":"920380","description":"Too many arguments in request","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"MAX_NUM_ARGS"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Too many arguments in request"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920380,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":true,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920360","description":"Argument name too long","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ARG_NAME_LENGTH"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Argument name too long"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920360,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Length"],"id":0,"phase":2,"chain":false}},{"id":"920370","description":"Argument value too long","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"ARG_LENGTH"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Argument value too long"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920370,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Length"],"id":0,"phase":2,"chain":false}},{"id":"920390","description":"Total arguments size exceeded","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"TOTAL_ARG_LENGTH"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Total arguments size exceeded"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920390,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"ArgsCombinedSize","count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920400","description":"Uploaded file size too large","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"MAX_FILE_SIZE"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Uploaded file size too large"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920400,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^(?i)multipart/form-data"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920410","description":"Total uploaded files size too large","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"COMBINED_FILE_SIZES"},"count":true,"negation":false}],"operator":{"Eq":"1"},"actions":["Block",{"Msg":"Total uploaded files size too large"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920410,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES_COMBINED_SIZE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920420","description":"Request content type is not allowed by policy","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^[^;\\s]+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Request content type is not allowed by policy"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.content_type=|%{tx.0}|"}],"transformations":[],"id":920420,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"content_type"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"content_type_charset"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Ctl":["","forceRequestBodyVariable=On"]},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"920530","description":"Multiple charsets detected in content type header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"charset.*?charset"},"actions":["Block",{"Msg":"Multiple charsets detected in content type header"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":920530,"phase":1,"chain":false}},{"id":"920640","description":"Content-Type header missing from request with body","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_BODY_LENGTH"},"count":false,"negation":false}],"operator":{"Gt":0},"actions":["Block",{"Msg":"Content-Type header missing from request with body"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920640,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920430","description":"HTTP protocol version is not allowed by policy","enabled":true,"details":{"variables":[{"variable":"RequestProtocol","count":false,"negation":false}],"operator":"NoOp","actions":["Block",{"Msg":"HTTP protocol version is not allowed by policy"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920430,"phase":1,"chain":false}},{"id":"920440","description":"URL file extension is restricted by policy","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false}],"operator":{"Rx":"\\.([^.]+)$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"URL file extension is restricted by policy"},{"LogData":"%{TX.0}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.extension=.%{tx.1}/"}],"transformations":["UrlDecodeUni"],"id":920440,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"EXTENSION"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"920500","description":"Attempt to access a backup or working file","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"Rx":"\\.[^.~]+~(?:/.*|)$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Attempt to access a backup or working file"},{"LogData":"%{TX.0}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920500,"phase":1,"chain":false}},{"id":"920450","description":"HTTP header is restricted by policy (%{MATCHED_VAR})","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_HEADERS_NAMES"},"count":false,"negation":false}],"operator":{"Rx":"^.*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP header is restricted by policy (%{MATCHED_VAR})"},{"LogData":"Restricted header detected: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.header_name_920450_%{tx.0}=/%{tx.0}/"}],"transformations":["Lowercase"],"id":920450,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"/^header_name_920450_/"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920520","description":"Accept-Encoding header exceeded sensible length","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept-Encoding"},"count":false,"negation":false}],"operator":{"Gt":100},"actions":["Block",{"Msg":"Accept-Encoding header exceeded sensible length"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase","Length"],"id":920520,"phase":1,"chain":false}},{"id":"920540","description":"Possible Unicode character bypass detected","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQBODY_PROCESSOR"},"count":false,"negation":false}],"operator":{"Rx":"!@streq JSON"},"actions":["Block",{"Msg":"Possible Unicode character bypass detected"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267/72"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920540,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"(?i)\\x5cu[0-9a-f]{4}"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920610","description":"Raw (unencoded) fragment in request URI","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false}],"operator":{"Contains":"#"},"actions":["Block",{"Msg":"Raw (unencoded) fragment in request URI"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920610,"phase":1,"chain":false}},{"id":"920620","description":"Multiple Content-Type Request Headers","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":true,"negation":false}],"operator":{"Gt":1},"actions":["Block",{"Msg":"Multiple Content-Type Request Headers"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920620,"phase":1,"chain":false}},{"id":"920013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920013,"phase":1,"chain":false}},{"id":"920014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920014,"phase":2,"chain":false}},{"id":"920200","description":"Range: Too many fields (6 or more)","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Request-Range"},"count":false,"negation":false}],"operator":{"Rx":"^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}"},"actions":["Block",{"Msg":"Range: Too many fields (6 or more)"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920200,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false}],"operator":{"Rx":"!@endsWith .pdf"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920201","description":"Range: Too many fields for pdf request (63 or more)","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false}],"operator":{"EndsWith":".pdf"},"actions":["Block",{"Msg":"Range: Too many fields for pdf request (63 or more)"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":["UrlDecodeUni"],"id":920201,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Request-Range"},"count":false,"negation":false}],"operator":{"Rx":"^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){63}"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920230","description":"Multiple URL Encoding Detected","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"%[0-9a-fA-F]{2}"},"actions":["Block",{"Msg":"Multiple URL Encoding Detected"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267/120"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":920230,"phase":2,"chain":false}},{"id":"920271","description":"Invalid character in request (non printable characters)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"@validateByteRange 9,10,13,32-126,128-255"},"actions":["Block",{"Msg":"Invalid character in request (non printable characters)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920271,"phase":2,"chain":false}},{"id":"920320","description":"Missing User Agent Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Block",{"Msg":"Missing User Agent Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":920320,"phase":1,"chain":false}},{"id":"920451","description":"HTTP header is restricted by policy (%{MATCHED_VAR})","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_HEADERS_NAMES"},"count":false,"negation":false}],"operator":{"Rx":"^.*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP header is restricted by policy (%{MATCHED_VAR})"},{"LogData":"Restricted header detected: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.header_name_920451_%{tx.0}=/%{tx.0}/"}],"transformations":["Lowercase"],"id":920451,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"/^header_name_920451_/"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920240","description":"URL Encoding Abuse Attack Attempt","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^(?i)application/x-www-form-urlencoded"},"actions":["Block",{"Msg":"URL Encoding Abuse Attack Attempt"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153/267/72"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":[],"id":920240,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"\\x25"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"@validateUrlEncoding"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920650","description":"HTTP method override attempt via _method parameter","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"allow_method_override_parameter"},"count":false,"negation":false}],"operator":{"Eq":"0"},"actions":["Block",{"Msg":"HTTP method override attempt via _method parameter"},{"LogData":"Requested method override: %{ARGS._method}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920650,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"ArgsSpecific":"_method"},"count":false,"negation":false}],"operator":{"Rx":"^[a-z]{3,10}$"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"920015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920015,"phase":1,"chain":false}},{"id":"920016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920016,"phase":2,"chain":false}},{"id":"920272","description":"Invalid character in request (outside of printable chars below ascii 127)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"@validateByteRange 32-36,38-126"},"actions":["Block",{"Msg":"Invalid character in request (outside of printable chars below ascii 127)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920272,"phase":2,"chain":false}},{"id":"920300","description":"Request Missing an Accept Header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Block",{"Msg":"Request Missing an Accept Header"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Notice"}],"transformations":[],"id":920300,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestMethod","count":false,"negation":false}],"operator":{"Rx":"!@rx ^(?:OPTIONS|CONNECT)$"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"!@pm AppleWebKit Android"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.notice_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920490","description":"Request header x-up-devcap-post-charset detected in combination with prefix \\'UP\\' to User-Agent","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"x-up-devcap-post-charset"},"count":true,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Block",{"Msg":"Request header x-up-devcap-post-charset detected in combination with prefix \\'UP\\' to User-Agent"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"language-aspnet"},{"Tag":"platform-windows"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920490,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"^(?i)up"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920510","description":"Invalid Cache-Control request header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Cache-Control"},"count":true,"negation":false}],"operator":{"Gt":0},"actions":["Block",{"Msg":"Invalid Cache-Control request header"},{"LogData":"Invalid Cache-Control value in request found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"header-allowlist"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":920510,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Cache-Control"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^(?:(?:max-age=[0-9]+|min-fresh=[0-9]+|no-cache|no-store|no-transform|only-if-cached|max-stale(?:=[0-9]+)?)(?:\\s*\\,\\s*|$)){1,7}$"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920521","description":"Illegal Accept-Encoding header","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Accept-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"!@rx br|compress|deflate|(?:pack200-)?gzip|identity|\\*|^$|aes128gcm|exi|zstd|x-(?:compress|gzip)"},"actions":["Block",{"Msg":"Illegal Accept-Encoding header"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":920521,"phase":1,"chain":false}},{"id":"920017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920017,"phase":1,"chain":false}},{"id":"920018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920018,"phase":2,"chain":false}},{"id":"920202","description":"Range: Too many fields for pdf request (6 or more)","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false}],"operator":{"EndsWith":".pdf"},"actions":["Block",{"Msg":"Range: Too many fields for pdf request (6 or more)"},{"LogData":"%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"}],"transformations":["UrlDecodeUni"],"id":920202,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Request-Range"},"count":false,"negation":false}],"operator":{"Rx":"^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"920273","description":"Invalid character in request (outside of very strict set)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"@validateByteRange 38,44-46,48-58,61,65-90,95,97-122"},"actions":["Block",{"Msg":"Invalid character in request (outside of very strict set)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920273,"phase":2,"chain":false}},{"id":"920274","description":"Invalid character in request headers (outside of very strict set)","enabled":true,"details":{"variables":[{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Cookie"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Sec-Fetch-User"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Sec-CH-UA"},"count":false,"negation":true},{"variable":{"RequestHeadersSpecific":"Sec-CH-UA-Mobile"},"count":false,"negation":true}],"operator":{"Rx":"@validateByteRange 32,34,38,42-59,61,65-90,95,97-122"},"actions":["Block",{"Msg":"Invalid character in request headers (outside of very strict set)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920274,"phase":1,"chain":false}},{"id":"920275","description":"Invalid character in request headers (outside of very strict set)","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Sec-Fetch-User"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Sec-CH-UA-Mobile"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^(?:\\?[01])?$"},"actions":["Block",{"Msg":"Invalid character in request headers (outside of very strict set)"},{"LogData":"%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/210/272"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":920275,"phase":1,"chain":false}},{"id":"920460","description":"Abnormal character escapes in request","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"(?:^|[^\\x5c])\\x5c[cdeghijklmpqwxyz123456789]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Abnormal character escapes in request"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ENFORCEMENT"},{"Tag":"capec/1000/153/267"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode","Lowercase"],"id":920460,"phase":2,"chain":false}},{"id":"921011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921011,"phase":1,"chain":false}},{"id":"921012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921012,"phase":2,"chain":false}},{"id":"921110","description":"HTTP Request Smuggling Attack","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:get|post|head|options|connect|put|delete|trace|track|patch|propfind|propatch|mkcol|copy|move|lock|unlock)\\s+[^\\s]+\\s+http/\\d"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Request Smuggling Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode","Lowercase"],"id":921110,"phase":2,"chain":false}},{"id":"921120","description":"HTTP Response Splitting Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"[\\r\\n]\\W*?(?:content-(?:type|length)|set-cookie|location):\\s*\\w"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Response Splitting Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/34"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921120,"phase":2,"chain":false}},{"id":"921130","description":"HTTP Response Splitting Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:\\bhttp/\\d|<(?:html|meta)\\b)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Response Splitting Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/34"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode","Lowercase"],"id":921130,"phase":2,"chain":false}},{"id":"921140","description":"HTTP Header Injection Attack via headers","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_HEADERS_NAMES"},"count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Header Injection Attack via headers"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/273"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":921140,"phase":1,"chain":false}},{"id":"921150","description":"HTTP Header Injection Attack via payload (CR/LF detected)","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Header Injection Attack via payload (CR/LF detected)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921150,"phase":2,"chain":false}},{"id":"921160","description":"HTTP Header Injection Attack via payload (CR/LF and header-name detected)","enabled":true,"details":{"variables":[{"variable":{"Tx":"ARGS_GET_NAMES"},"count":false,"negation":false},{"variable":{"Tx":"ARGS_GET"},"count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]+(?:\\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\\s*:"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Header Injection Attack via payload (CR/LF and header-name detected)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921160,"phase":1,"chain":false}},{"id":"921190","description":"HTTP Splitting (CR/LF in request filename detected)","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Splitting (CR/LF in request filename detected)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/34"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":921190,"phase":1,"chain":false}},{"id":"921200","description":"LDAP Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"^[^:\\(\\)\\&\\|\\!<>\\~]*\\)\\s*(?:\\((?:[^,\\(\\)\\=\\&\\|\\!<>\\~]+[><~]?=|\\s*[&!|]\\s*(?:\\)|\\()?\\s*)|\\)\\s*\\(\\s*[\\&\\|\\!]\\s*|[&!|]\\s*\\([^\\(\\)\\=\\&\\|\\!<>\\~]+[><~]?=[^:\\(\\)\\&\\|\\!<>\\~]*)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"LDAP Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-ldap"},{"Tag":"platform-multi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/248/136"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode"],"id":921200,"phase":2,"chain":false}},{"id":"921421","description":"Content-Type header: Dangerous content type outside the mime type declaration","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^[^\\s\\x0b,;]+[\\s\\x0b,;].*?(?:application/(?:.+\\+)?json|(?:application/(?:soap\\+)?|text/)xml)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Content-Type header: Dangerous content type outside the mime type declaration"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921421,"phase":1,"chain":false}},{"id":"921240","description":"mod_proxy attack attempt detected","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false}],"operator":{"Rx":"unix:[^|]*\\|"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"mod_proxy attack attempt detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-apache"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","Lowercase"],"id":921240,"phase":1,"chain":false}},{"id":"921250","description":"Old Cookies V1 usage attempt detected","enabled":true,"details":{"variables":[{"variable":{"RequestCookiesSpecific":"/\\x22?\\x24Version/"},"count":false,"negation":false}],"operator":{"StrEq":"1"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Old Cookies V1 usage attempt detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921250,"phase":1,"chain":false}},{"id":"921013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921013,"phase":1,"chain":false}},{"id":"921014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921014,"phase":2,"chain":false}},{"id":"921151","description":"HTTP Header Injection Attack via payload (CR/LF detected)","enabled":true,"details":{"variables":[{"variable":{"Tx":"ARGS_GET"},"count":false,"negation":false}],"operator":{"Rx":"[\\n\\r]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"HTTP Header Injection Attack via payload (CR/LF detected)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220/33"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921151,"phase":1,"chain":false}},{"id":"921422","description":"Content-Type header: Dangerous content type outside the mime type declaration","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Type"},"count":false,"negation":false}],"operator":{"Rx":"^[^\\s\\x0b,;]+[\\s\\x0b,;].*?\\b(?:((?:tex|multipar)t|application)|((?:audi|vide)o|image|cs[sv]|(?:vn|relate)d|p(?:df|lain)|json|(?:soa|cs)p|x(?:ml|-www-form-urlencoded)|form-data|x-amf|(?:octe|repor)t|stream)|([\\+/]))\\b"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Content-Type header: Dangerous content type outside the mime type declaration"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":921422,"phase":1,"chain":false}},{"id":"921015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921015,"phase":1,"chain":false}},{"id":"921016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921016,"phase":2,"chain":false}},{"id":"921230","description":"HTTP Range Header detected","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Range"},"count":true,"negation":false}],"operator":{"Gt":0},"actions":["Block",{"Msg":"HTTP Range Header detected"},{"LogData":"Matched Data: Header %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/210/272/220"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921230,"phase":1,"chain":false}},{"id":"921170","description":"No description","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"."},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/137/15/460"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"TX.paramcounter_%{MATCHED_VAR_NAME}=+1"}],"transformations":[],"id":921170,"phase":2,"chain":false}},{"id":"921180","description":"HTTP Parameter Pollution (%{MATCHED_VAR_NAME})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"/paramcounter_.*/"},"count":false,"negation":false}],"operator":{"Gt":1},"actions":["Block",{"Msg":"HTTP Parameter Pollution (%{MATCHED_VAR_NAME})"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/137/15/460"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921180,"phase":2,"chain":false}},{"id":"921210","description":"HTTP Parameter Pollution after detecting bogus char after parameter array","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"(][^\\]]+$|][^\\]]+\\[)"},"actions":["Block",{"Tag":"FLAG:capture"},"Log",{"Msg":"HTTP Parameter Pollution after detecting bogus char after parameter array"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/137/15/460"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921210,"phase":2,"chain":false}},{"id":"921017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921017,"phase":1,"chain":false}},{"id":"921018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-921-PROTOCOL-ATTACK"}],"transformations":[],"id":921018,"phase":2,"chain":false}},{"id":"921220","description":"HTTP Parameter Pollution possible via array notation","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"\\["},"actions":["Block",{"Tag":"FLAG:capture"},"Log",{"Msg":"HTTP Parameter Pollution possible via array notation"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-protocol"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/PROTOCOL-ATTACK"},{"Tag":"capec/1000/152/137/15/460"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.http_violation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":921220,"phase":2,"chain":false}},{"id":"922100","description":"Multipart content type global _charset_ definition is not allowed by policy","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"MULTIPART_PART_HEADERS:_charset_"},"count":true,"negation":false}],"operator":{"Rx":"!@eq 0"},"actions":["Block",{"Msg":"Multipart content type global _charset_ definition is not allowed by policy"},{"LogData":"Matched Data: %{ARGS._charset_}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-multipart-header"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Tag":"capec/1000/255/153"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.922100_charset=|%{ARGS._charset_}|"}],"transformations":[],"id":922100,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"922100_CHARSET"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":0,"phase":2,"chain":false}},{"id":"922140","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MULTIPART_PART_HEADERS"},"count":true,"negation":false}],"operator":{"Gt":0},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"attack-multipart-header"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.multipart_headers_content_counter=0"}],"transformations":[],"id":922140,"phase":2,"chain":false}},{"id":"922150","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MULTIPART_PART_HEADERS"},"count":false,"negation":false}],"operator":{"Rx":"^content-type\\s*:\\s*(.*)$"},"actions":["Pass",{"Tag":"FLAG:capture"},{"Tag":"FLAG:nolog"},{"Tag":"attack-multipart-header"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.multipart_headers_content_types_%{tx.multipart_headers_content_counter}=%{tx.1}"},{"SetVar":"tx.multipart_headers_content_counter=+1"}],"transformations":["Lowercase"],"id":922150,"phase":2,"chain":false}},{"id":"922120","description":"Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used","enabled":true,"details":{"variables":[{"variable":{"Tx":"MULTIPART_PART_HEADERS"},"count":false,"negation":false}],"operator":{"Rx":"content-transfer-encoding:(.*)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used"},{"LogData":"Matched Data: %{TX.0}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-multipart-header"},{"Tag":"attack-deprecated-header"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Tag":"capec/272/220"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":922120,"phase":2,"chain":false}},{"id":"922130","description":"Multipart header contains characters outside of valid range","enabled":true,"details":{"variables":[{"variable":{"Tx":"MULTIPART_PART_HEADERS"},"count":false,"negation":false}],"operator":{"Rx":"[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Multipart header contains characters outside of valid range"},{"LogData":"Matched Data: %{TX.0}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-multipart-header"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/MULTIPART-ATTACK"},{"Tag":"capec/272/220"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":922130,"phase":2,"chain":false}},{"id":"930011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930011,"phase":1,"chain":false}},{"id":"930012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930012,"phase":2,"chain":false}},{"id":"930100","description":"Path Traversal Attack (/../) or (/.../)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":true},{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[56]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))(?:\\.(?:%0[01]|\\?)?|\\?\\.?|%(?:2(?:(?:5(?:2|c0%25a))?e|%45)|c0(?:\\.|%[256aef]e)|u(?:(?:ff0|002)e|2024)|%32(?:%(?:%6|4)5|E)|(?:e|f(?:(?:8|c%80)%8)?0%8)0%80%ae)|0x2e){2,3}(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[56]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Path Traversal Attack (/../) or (/.../)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":930100,"phase":2,"chain":false}},{"id":"930110","description":"Path Traversal Attack (/../) or (/.../)","enabled":true,"details":{"variables":[{"variable":{"Tx":"REQUEST_URI_RAW"},"count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":true},{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Path Traversal Attack (/../) or (/.../)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","RemoveNulls"],"id":930110,"phase":2,"chain":false}},{"id":"930120","description":"OS File Access Attempt","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"lfi-os-files.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"OS File Access Attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":930120,"phase":2,"chain":false}},{"id":"930130","description":"Restricted File Access Attempt","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"PmFromFile":"restricted-files.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Restricted File Access Attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":930130,"phase":1,"chain":false}},{"id":"930013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930013,"phase":1,"chain":false}},{"id":"930014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930014,"phase":2,"chain":false}},{"id":"930121","description":"OS File Access Attempt in REQUEST_HEADERS","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"PmFromFile":"lfi-os-files.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"OS File Access Attempt in REQUEST_HEADERS"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-lfi"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-LFI"},{"Tag":"capec/1000/255/153/126"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.lfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":930121,"phase":1,"chain":false}},{"id":"930015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930015,"phase":1,"chain":false}},{"id":"930016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930016,"phase":2,"chain":false}},{"id":"930017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930017,"phase":1,"chain":false}},{"id":"930018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-930-APPLICATION-ATTACK-LFI"}],"transformations":[],"id":930018,"phase":2,"chain":false}},{"id":"931011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931011,"phase":1,"chain":false}},{"id":"931012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931012,"phase":2,"chain":false}},{"id":"931100","description":"Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)^(file|ftps?|https?|ssh)://(?:\\[?[a-f0-9]+:[a-f0-9:]+\\]?|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":931100,"phase":2,"chain":false}},{"id":"931110","description":"Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload","enabled":true,"details":{"variables":[{"variable":"QueryString","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false}],"operator":{"Rx":"(?i)(?:\\binclude\\s*\\([^)]*|mosConfig_absolute_path|_CONF\\[path\\]|_SERVER\\[DOCUMENT_ROOT\\]|GALLERY_BASEDIR|path\\[docroot\\]|appserv_root|config\\[root_dir\\])=(?:file|ftps?|https?)://"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":931110,"phase":2,"chain":false}},{"id":"931120","description":"Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"^(?i:file|ftps?|https?).*?\\?+$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":931120,"phase":2,"chain":false}},{"id":"931013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931013,"phase":1,"chain":false}},{"id":"931014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931014,"phase":2,"chain":false}},{"id":"931130","description":"Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}"}],"transformations":[],"id":931130,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"/rfi_parameter_.*/"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.rfi_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"931131","description":"Possible Remote File Inclusion (RFI) Attack","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"Rx":"(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[^@]+@)?([^/]*)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Remote File Inclusion (RFI) Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rfi"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RFI"},{"Tag":"capec/1000/152/175/253"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":931131,"phase":1,"chain":false}},{"id":"931015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931015,"phase":1,"chain":false}},{"id":"931016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931016,"phase":2,"chain":false}},{"id":"931017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931017,"phase":1,"chain":false}},{"id":"931018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-931-APPLICATION-ATTACK-RFI"}],"transformations":[],"id":931018,"phase":2,"chain":false}},{"id":"932011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932011,"phase":1,"chain":false}},{"id":"932012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932012,"phase":2,"chain":false}},{"id":"932120","description":"Remote Command Execution: Windows PowerShell Command Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"windows-powershell-commands.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Windows PowerShell Command Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"language-powershell"},{"Tag":"platform-windows"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932120,"phase":2,"chain":false}},{"id":"932130","description":"Remote Command Execution: Unix Shell Expression Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Expression Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932130,"phase":2,"chain":false}},{"id":"932140","description":"Remote Command Execution: Windows FOR/IF Command Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Windows FOR/IF Command Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-windows"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932140,"phase":2,"chain":false}},{"id":"932270","description":"Remote Command Execution: Unix Shell Expression Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"~[\\+\\-](?:$|[0-9]+)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Expression Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932270,"phase":2,"chain":false}},{"id":"932280","description":"Remote Command Execution: Brace Expansion Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\{[0-9A-Z_a-z]*,[,\\-0-9A-Z_a-z]*\\}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Brace Expansion Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932280,"phase":2,"chain":false}},{"id":"932330","description":"Remote Command Execution: Unix shell history invocation","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"!-\\d"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix shell history invocation"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932330,"phase":2,"chain":false}},{"id":"932160","description":"Remote Command Execution: Unix Shell Code Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"unix-shell.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Code Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":932160,"phase":2,"chain":false}},{"id":"932170","description":"Remote Command Execution: Shellshock (CVE-2014-6271)","enabled":true,"details":{"variables":[{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"RequestLine","count":false,"negation":false}],"operator":{"Rx":"^\\(\\s*\\)\\s+\\{"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Shellshock (CVE-2014-6271)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":932170,"phase":1,"chain":false}},{"id":"932171","description":"Remote Command Execution: Shellshock (CVE-2014-6271)","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"Tx":"FILES_NAMES"},"count":false,"negation":false}],"operator":{"Rx":"^\\(\\s*\\)\\s+\\{"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Shellshock (CVE-2014-6271)"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":932171,"phase":2,"chain":false}},{"id":"932180","description":"Restricted File Upload Attempt","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"PmFromFile":"restricted-upload.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Restricted File Upload Attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":932180,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"!@rx (?i)(?:\\.boto|buddyinfo|mtrr|acpi|zoneinfo)\\B"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932013,"phase":1,"chain":false}},{"id":"932014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932014,"phase":2,"chain":false}},{"id":"932131","description":"Remote Command Execution: Unix Shell Expression Found","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"\\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Expression Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932131,"phase":1,"chain":false}},{"id":"932200","description":"RCE Bypass Technique","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RCE Bypass Technique"},{"LogData":"Matched Data: %{TX.0} found within %{TX.932200_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.932200_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase","UrlDecodeUni"],"id":932200,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"/"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"\\s"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932205","description":"RCE Bypass Technique","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"^[^#]+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RCE Bypass Technique"},{"LogData":"Matched Data: %{TX.2} found within %{TX.932205_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.932205_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase","UrlDecodeUni"],"id":932205,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"0"},"count":false,"negation":false}],"operator":{"Rx":"^[^\\.]+\\.[^;\\?]+[;\\?](.*(['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]))"},"actions":[{"Tag":"FLAG:capture"}],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":{"Rx":"/"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":{"Rx":"\\s"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932206","description":"RCE Bypass Technique","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"^[^\\.]*?(?:['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RCE Bypass Technique"},{"LogData":"Matched Data: %{TX.0} found within %{TX.932206_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.932206_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase","UrlDecodeUni"],"id":932206,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"/"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"\\s"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932207","description":"RCE Bypass Technique","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"#.*"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RCE Bypass Technique"},{"LogData":"Matched Data: %{TX.0} found within %{TX.932207_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.932207_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase","UrlDecodeUni"],"id":932207,"phase":1,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"0"},"count":false,"negation":false}],"operator":{"Rx":"['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]"},"actions":[{"Tag":"FLAG:capture"}],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VAR"},"count":false,"negation":false}],"operator":{"Rx":"/"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VAR"},"count":false,"negation":false}],"operator":{"Rx":"\\s"},"actions":[],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VAR"},"count":false,"negation":false}],"operator":{"Rx":"!@beginsWith #:~:text="},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"!@rx [0-9]\\s*\\'\\s*[0-9]"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"932281","description":"Remote Command Execution: Brace Expansion Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\{[^\\s\\x0b,:\\}]*,[^\\s\\x0b]*\\}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Brace Expansion Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932281,"phase":2,"chain":false}},{"id":"932271","description":"Remote Command Execution: Unix Shell Expression Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"~[0-9]+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Expression Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932271,"phase":2,"chain":false}},{"id":"932300","description":"Remote Command Execution: SMTP Command Execution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\r\\n.*?\\b(?:E(?:HLO[\\s\\x0b][\\-\\.a-z]{1,255}|XPN[\\s\\x0b].{1,64})|HELO[\\s\\x0b][\\-\\.a-z]{1,255}|MAIL[\\s\\x0b]FROM:<.{1,64}@.{1,255}>|R(?:CPT[\\s\\x0b]TO:(?:<.{1,64}@.{1,255}>| )?<.{1,64}>|SET\\b)|VRFY[\\s\\x0b].{1,64}(?:[\\s\\x0b]<.{1,64}@.{1,255}>|@.{1,255})|AUTH[\\s\\x0b][\\-0-9_a-z]{1,20}[\\s\\x0b](?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=|STARTTLS\\b|NOOP\\b(?:[\\s\\x0b].{1,255})?)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: SMTP Command Execution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/137/134"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932300,"phase":2,"chain":false}},{"id":"932320","description":"Remote Command Execution: POP3 Command Execution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?is)\\r\\n.*?\\b(?:(?:LIST|TOP [0-9]+)(?: [0-9]+)?|U(?:SER .+?|IDL(?: [0-9]+)?)|PASS .+?|(?:RETR|DELE) [0-9]+?|A(?:POP [0-9A-Z_a-z]+ [0-9a-f]{32}|UTH [\\-0-9_a-z]{1,20} (?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: POP3 Command Execution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/137/134"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932320,"phase":2,"chain":false}},{"id":"932161","description":"Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"PmFromFile":"unix-shell.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":932161,"phase":1,"chain":false}},{"id":"932015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932015,"phase":1,"chain":false}},{"id":"932016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932016,"phase":2,"chain":false}},{"id":"932237","description":"Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|(?:(?:GE|POS)T|y(?:e(?:s|lp)|um|arn)|HEAD)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get|itude(?:[\\s\\x0b&\\),<>\\|]|$))|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:[\\s\\x0b&\\),<>\\|]|$|h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|t(?:[\\s\\x0b&\\),<>\\|]|$|obm(?:[\\s\\x0b&\\),<>\\|]|$))|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|io(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:t(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|on(?:[\\s\\x0b&\\),<>\\|]|$|tab)))|d(?:(?:[dfu]|i(?:(?:alo)?g|r|ff)|a(?:sh|te)|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|nf(?:[\\s\\x0b&\\),<>\\|]|$)?|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:[bd]|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|le(?:[\\s\\x0b&\\),<>\\|]|$|test)|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|d(?:(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oupmod)|tester|unzip)|h(?:(?:d|up|ash|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:(?:d|rb|conv|nstall)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|ava|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|[qx](?:[\\s\\x0b&\\),<>\\|]|$)))|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:(?:re|unt)(?:[\\s\\x0b&\\),<>\\|]|$)|squitto)|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|cman|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|hp(?:[\\s\\x0b&\\),<>\\|]|$|-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[\\s\\x0b&\\),<>\\|]|$|[^\\s\\x0b]{1,10}\\b)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|(?:(?:w|op)d|xz|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|y(?:3?versions|thon[23]))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|name|p(?:eat|lace))(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|r(?:een|ipt))|g|ash|diff|ftp|l(?:eep|sh)|plit)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|u(?:f|tdown)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|h(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass))|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:(?:(?:ca|r)t|urce)(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|qlite3|t(?:art-stop-daemon|dbuf|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|sk(?:[\\s\\x0b&\\),<>\\|]|$|set))|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|me(?:[\\s\\x0b&\\),<>\\|]|$|datectl|out(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:l?sh(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:dump|ing|traceroute))|r(?:a(?:ceroute6?|p(?:[\\s\\x0b&\\),<>\\|]|$))|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:ame|compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|p(?:2date(?:[\\s\\x0b&\\),<>\\|]|$)|date-alternatives)|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:[\\s\\x0b&\\),<>\\|]|$|m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:[ep]w|gr|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|a(?:ll|tch))(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:o(?:[\\s\\x0b&\\),<>\\|]|$|ami|is(?:[\\s\\x0b&\\),<>\\|]|$))?|iptail(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|[ef]grep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))(?:\\b|[^0-9A-Z_a-z])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":932237,"phase":1,"chain":false}},{"id":"932190","description":"Remote Command Execution: Wildcard bypass technique attempt","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"/(?:[?*]+[a-z/]+|[a-z/]+[?*]+)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Wildcard bypass technique attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":932190,"phase":2,"chain":false}},{"id":"932301","description":"Remote Command Execution: SMTP Command Execution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\r\\n.*?\\b(?:DATA|QUIT|HELP(?: .{1,255})?)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: SMTP Command Execution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/137/134"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932301,"phase":2,"chain":false}},{"id":"932321","description":"Remote Command Execution: POP3 Command Execution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\r\\n.*?\\b(?:(?:QUI|STA|RSE)T|NOOP|CAPA)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: POP3 Command Execution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/137/134"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932321,"phase":2,"chain":false}},{"id":"932331","description":"Remote Command Execution: Unix shell history invocation","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"!(?:\\d|!)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Remote Command Execution: Unix shell history invocation"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-shell"},{"Tag":"platform-unix"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-RCE"},{"Tag":"capec/1000/152/248/88"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":932331,"phase":2,"chain":false}},{"id":"932017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932017,"phase":1,"chain":false}},{"id":"932018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-932-APPLICATION-ATTACK-RCE"}],"transformations":[],"id":932018,"phase":2,"chain":false}},{"id":"933011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933011,"phase":1,"chain":false}},{"id":"933012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933012,"phase":2,"chain":false}},{"id":"933100","description":"PHP Injection Attack: PHP Open Tag Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<\\?(?:[^x]|x(?:[^m]|m(?:[^l]|l(?:[^\\s\\x0b]|[\\s\\x0b]+[^a-z]|$)))|$|php)|\\[[/\\x5c]?php\\]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Open Tag Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933100,"phase":2,"chain":false}},{"id":"933110","description":"PHP Injection Attack: PHP Script File Upload Found","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X.Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"Rx":".*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Script File Upload Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":933110,"phase":2,"chain":false}},{"id":"933120","description":"PHP Injection Attack: Configuration Directive Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:llow_url_(?:fopen|include)|pc.(?:coredump_unmap|en(?:able(?:_cli|d)|tries_hint)|(?:gc_)?ttl|mmap_file_mask|preload_path|s(?:erializer|hm_s(?:egments|ize)|lam_defense)|use_request_time)|rg_separator.(?:in|out)put|ssert.(?:active|(?:bai|quiet_eva)l|callback|exception|warning)|uto_(?:(?:ap|pre)pend_file|detect_line_endings|globals_jit))|b(?:cmath.scale|rowscap)|c(?:gi.(?:check_shebang_line|(?:discard_pat|np)h|f(?:ix_pathinfo|orce_redirect)|r(?:edirect_status_env|fc2616_headers))|hild_terminate|li(?:_server.color|.p(?:ager|rompt))|om.(?:a(?:llow_dcom|utoregister_(?:(?:casesensitiv|verbos)e|typelib))|(?:code_pag|typelib_fil)e|dotnet_version)|url.cainfo)|d(?:ate.(?:(?:default_l(?:at|ong)itud|timezon)e|sun(?:rise|set)_zenith)|ba.default_handler|efault_(?:(?:charse|socket_timeou)t|mimetype)|is(?:able_(?:classe|function)|play_(?:startup_)?error)s|oc(?:_roo|ref_(?:ex|roo))t)|e(?:n(?:able_(?:dl|post_data_reading)|gine)|rror_(?:(?:(?:ap|pre)pend_str|report)in|lo)g|x(?:i(?:f.(?:decode_(?:jis|unicode)_(?:intel|motorola)|encode_(?:jis|unicode))|t_on_timeout)|tension(?:_dir)?|p(?:ect.(?:log(?:file|user)|match_max|timeout)|ose_php)))|f(?:astcgi.(?:impersonate|logging)|fi.(?:enable|preload)|il(?:e_uploads|ter.default(?:_flags)?))|g(?:d.jpeg_ignore_warning|eoip.custom_directory)|h(?:ard_timeout|ighlight.(?:(?:commen|defaul)t|html|keyword|string)|tml_errors)|i(?:b(?:ase.(?:(?:allow_persisten|time(?:stamp)?forma)t|d(?:ateformat|efault_(?:charset|db|password|user))|max_(?:links|persistent))|m_db2.(?:binmode|i(?:5_(?:all(?:_pconnec|ow_commi)t|dbcs_alloc|ignore_userid)|nstance_name)))|conv.(?:in(?:put|ternal)|output)_encoding|g(?:binary.compact_strings|nore_(?:repeated_(?:errors|source)|user_abort))|m(?:a(?:gick.(?:locale_fix|progress_monitor|skip_version_check)|p.enable_insecure_rsh)|plicit_flush)|n(?:clude_path|put_encoding|t(?:ernal_encoding|l.(?:default_locale|error_level|use_exceptions))))|l(?:dap.max_links|og_errors(?:_max_len)?)|m(?:a(?:gic_quotes_(?:gpc|runtime)|il(?:.(?:add_x_header|force_extra_parameters|log)|parse.def_charset)|x_(?:execution_time|file_uploads|input_(?:nesting_level|time|vars)))|bstring.(?:detect_order|encoding_translation|func_overload|http_(?:input|output(?:_conv_mimetypes)?)|internal_encoding|language|regex_(?:retry|stack)_limit|s(?:trict_detection|ubstitute_character))|crypt.(?:algorithm|mode)s_dir|em(?:cache(?:.(?:allow_failover|c(?:hunk_size|ompress_threshold)|(?:default_por|lock_timeou)t|hash_(?:function|strategy)|max_failover_attempts|protocol|(?:session_)?redundancy)|d.(?:compression_(?:factor|t(?:hreshold|ype))|default_(?:binary_protocol|con(?:nect_timeout|sistent_hash))|s(?:e(?:rializer|ss_(?:binary(?:_protocol)?|con(?:nect_timeout|sistent_hash(?:_type)?)|lock(?:_(?:expire|retries|wait(?:_m(?:ax|in))?)|ing)|number_of_replicas|p(?:ersistent|refix)|r(?:andomize_replica_read|emove_failed(?:_servers)?)|s(?:asl_(?:password|username)|erver_failure_limit)))|tore_retry_count)|use_sasl))|ory_limit)|ysql(?:.(?:allow_(?:local_infile|persistent)|connect_timeout|default_(?:(?:hos|socke)t|p(?:assword|ort)|user)|max_(?:links|persistent)|trace_mode)|i.(?:allow_(?:local_infile|persistent)|default_(?:(?:hos|socke)t|p(?:ort|w)|user)|local_infile_directory|max_(?:links|persistent)|r(?:econnect|ollback_on_cached_plink))|nd.(?:collect_(?:memory_)?statistics|debug|(?:fetch_data_cop|sha256_server_public_ke)y|log_mask|mempool_default_size|net_(?:cmd_buffer_size|read_(?:buffer_size|timeout))|trace_alloc)))|o(?:ci8.(?:(?:connection_clas|event|old_oci_close_semantic)s|default_prefetch|max_persistent|p(?:ersistent_timeout|ing_interval|r(?:efetch_lob_size|ivileged_connect))|statement_cache_size)|dbc.(?:(?:allow|check)_persistent|default(?:_(?:cursortype|db|pw|user)|binmode|lrl)|max_(?:links|persistent))|p(?:cache.(?:blacklist_filename|c(?:ache_id|onsistency_checks)|dups_fix|e(?:nable(?:_(?:cli|file_override))?|rror_log)|f(?:ast_shutdown|ile_(?:cache(?:_(?:consistency_checks|fallback|only))?|update_protection)|orce_restart_timeout)|(?:huge_code_page|save_comment)s|in(?:herited_hack|terned_strings_buffer)|jit(?:_(?:b(?:isect_limit|(?:lacklist_(?:root|side)_trac|uffer_siz)e)|debug|hot_(?:func|loop|return|side_exit)|max_(?:exit_counter|(?:loop_unro|polymorphic_ca)ll|r(?:ecursive_(?:call|return)|oot_trace)|side_trace)s|prof_threshold))?|lo(?:ckfile_path|g_verbosity_level)|m(?:ax_(?:accelerated_files|(?:file_siz|wasted_percentag)e)|emory_consumption|map_base)|opt(?:_debug|imization)_level|pr(?:e(?:ferred_memory_model|load(?:_user)?)|otect_memory)|re(?:cord_warnings|strict_api|validate_(?:freq|path))|use_cwd|validate_(?:permission|root|timestamps))|en(?:_basedir|ssl.ca(?:file|path)))|utput_(?:(?:buffer|encod)ing|handler))|p(?:cre.(?:(?:backtrack|recursion)_lim|j)it|do(?:_odbc.(?:connection_pooling|db2_instance_name)|.dsn)|gsql.(?:a(?:llow|uto_reset)_persistent|(?:ignore|log)_notice|max_(?:links|persistent))|h(?:ar.(?:cache_list|re(?:adonly|quire_hash))|pdbg.(?:eol|path))|recision|ost_max_size)|r(?:e(?:alpath_cache_(?:size|ttl)|gister_argc_argv|port_(?:memleaks|zend_debug)|quest_order)|unkit.(?:internal_override|superglobal))|s(?:e(?:aslog.(?:appender(?:_retry)?|buffer_(?:disabled_in_cli|size)|d(?:efault_(?:basepath|datetime_format|logger|template)|isting_(?:(?:by_hou|folde)r|type))|ignore_warning|level|re(?:call_depth|mote_(?:hos|por|timeou)t)|t(?:hrow_exception|r(?:ace_(?:e(?:rror|xception)|notice|warning)|im_wrap))|use_buffer)|ndmail_(?:from|path)|rialize_precision|ssion.(?:auto_start|c(?:ache_(?:expire|limiter)|ookie_(?:domain|httponly|(?:lifetim|s(?:amesit|ecur))e|path))|entropy_(?:file|length)|gc_(?:divisor|maxlifetime|probability)|hash_(?:bits_per_character|function)|(?:lazy_writ|nam)e|referer_check|s(?:ave_(?:handler|path)|erialize_handler|id_(?:bits_per_character|length))|trans_sid_(?:host|tag)s|u(?:pload_progress.(?:cleanup|enabled|(?:min_)?freq|name|prefix)|se_(?:(?:only_)?cookies|strict_mode|trans_sid))))|hort_open_tag|mtp(?:_port)?|oap.wsdl_cache(?:_(?:dir|enabled|limit|ttl))?|ql(?:.safe_mode|ite3.(?:defensive|extension_dir))|tomp.default_(?:broker|(?:connection|read)_timeout_u?sec)|woole.(?:aio_thread_num|display_errors|enable_(?:coroutine|library|preemptive_scheduler)|(?:fast_serializ|u(?:nixsock_buffer_siz|se_(?:namespac|shortnam)))e)|ys(?:_temp_dir|log.(?:f(?:acility|ilter)|ident)|vshm.init_mem))|t(?:aint.e(?:nable|rror_level)|idy.(?:clean_output|default_config)|ra(?:ck_errors|der.real_(?:precision|round_mode)))|u(?:nserialize_(?:callback_func|max_depth)|opz.(?:disable|exit|overloads)|pload(?:_(?:max_filesize|tmp_dir)|progress.file.filename_template)|rl_rewriter.(?:host|tag)s|ser_(?:agent|dir|ini.(?:cache_ttl|filename)))|v(?:8js.(?:flag|max_disposed_context)s|ariables_order|ld.(?:(?:activ|execut)e|skip_(?:ap|pre)pend))|w(?:in(?:cache.(?:chkinterval|enablecli|f(?:c(?:achesize|enabled(?:filter)?|ndetect)|ile(?:count|mapdir))|(?:ignorelis|namesal)t|maxfilesize|oc(?:achesize|enabled(?:filter)?)|reroute(?:_enabled|ini)|s(?:cachesize|rwlocks)|ttlmax|uc(?:achesize|enabled))|dows.show_crt_warning)|khtmltox.graphics)|x(?:bithack|hprof.output_dir|mlrpc_error(?:_number|s))|ya(?:c(?:.(?:compress_threshold|debug|enable(?:_cli)?|(?:key|value)s_memory_size|serializer)|onf.(?:check_dela|director)y)|f.(?:action_prefer|cache_config|environ|forward_limit|l(?:ibrary|owcase_path)|name_s(?:eparator|uffix)|use_(?:namespace|spl_autoload))|ml.(?:decode_(?:binary|(?:ph|timestam)p)|output_(?:canonical|indent|width))|r.(?:(?:connect_)?timeout|debug|expose_info|packager)|z.(?:keepalive|log_mask))|z(?:end(?:_extension|.(?:assertions|(?:detect_unicod|multibyt)e|e(?:nable_gc|xception_(?:ignore_args|string_param_max_len))|s(?:cript_encoding|ignal_check)))|lib.output_(?:compression(?:_level)?|handler)|ookeeper.(?:recv_timeout|sess(?:_lock_wait|ion_lock))))[\\s\\x0b]*=[^=]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Configuration Directive Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath"],"id":933120,"phase":2,"chain":false}},{"id":"933130","description":"PHP Injection Attack: Variables Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"php-variables.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Variables Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath","UrlDecodeUni"],"id":933130,"phase":2,"chain":false}},{"id":"933135","description":"PHP Injection Attack: Variable Access Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\$\\s*\\{\\s*\\S[^\\{\\}]*\\}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Variable Access Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933135,"phase":2,"chain":false}},{"id":"933140","description":"PHP Injection Attack: I/O Stream Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: I/O Stream Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933140,"phase":2,"chain":false}},{"id":"933200","description":"PHP Injection Attack: Wrapper scheme detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:bzip2|expect|glob|ogg|(?:ph|r)ar|ssh2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?|z(?:ip|lib))://"},"actions":["Block",{"Msg":"PHP Injection Attack: Wrapper scheme detected"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","RemoveNulls"],"id":933200,"phase":2,"chain":false}},{"id":"933150","description":"PHP Injection Attack: High-Risk PHP Function Name Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"php-function-names-933150.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: High-Risk PHP Function Name Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":[],"id":933150,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"@pm ( )"},"actions":[{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"933180","description":"PHP Injection Attack: Variable Function Call Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\$+(?:[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*|\\s*\\{.+})(?:\\s|\\[.+\\]|\\{.+}|/\\*.*\\*/|//.*|#.*)*\\(.*\\)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Variable Function Call Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933180,"phase":2,"chain":false}},{"id":"933220","description":"PHP Injection Attack: PHP Session File Upload Attempt","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"Tx":"FILES_NAMES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X.Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"Rx":"(?:^|[/\\x5c])sess_[,\\-0-9a-z]{20,256}$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Session File Upload Attempt"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":933220,"phase":2,"chain":false}},{"id":"933013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933013,"phase":1,"chain":false}},{"id":"933014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933014,"phase":2,"chain":false}},{"id":"933151","description":"PHP Injection Attack: Medium-Risk PHP Function Name Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:c(?:cel_chdir|osh?)|ddc?slashes|pache_(?:child_terminate|get(?:_(?:modules|version)|env)|lookup_uri|note |re(?:quest|sponse)_headers|setenv)|r(?:ray_(?:c(?:h(?:ange_key_case|unk)|o(?:lumn|mbine|unt_values))|diff(?:_(?:assoc|key|u(?:assoc|key)))?|f(?:ill(?:_keys)?|lip)|i(?:ntersect(?:_(?:assoc|key|u(?:assoc|key)))?|s_list)|key(?:_(?:fir|la)st|s)|m(?:ap|erge(?:_recursive)?|ultisort)|p(?:ad|op|roduct)|r(?:and|e(?:(?:duc|vers)e|place(?:_recursive)?))|s(?:earch|p?lice|um)|u(?:(?:diff|intersect)(?:_u?assoc)?|n(?:ique|shift))|walk(?:_recursive)?)|sort)|s(?:inh|ort|sert_options)|tan[2h]?)|b(?:ase(?:64_(?:de|en)code|_convert)|c(?:add|comp|div|m(?:od|ul)|pow(?:mod)?|s(?:cale|qrt|ub))|in(?:2hex|d(?:_textdomain_codeset|ec|textdomain))|oolval|z(?:(?:de)?compress|err(?:no|(?:o|st)r)|open|read))|c(?:al(?:_(?:days_in_month|(?:from|to)_jd|info)|l_user_func_array)|eil|h(?:(?:di)?r|grp|mod|own|unk_split)|l(?:ass_(?:alia|(?:implem|par)ent|use)s|earstatcache|ose(?:dir|log))|o(?:llator_(?:asort|c(?:ompar|reat)e|get_(?:(?:attribut|error_(?:cod|messag)|local)e|s(?:ort_key|trength))|s(?:et_(?:attribute|strength)|ort(?:_with_sort_keys)?))|m_(?:create_guid|event_sink|get_active_object|load_typelib|message_pump|print_typeinfo)|n(?:fig_get_hash|nection_(?:aborted|status)|vert_uu(?:de|en)code)|unt_chars)|rc32|type_(?:al(?:num|pha)|cntrl|(?:x?digi|p(?:rin|unc))t|graph|(?:low|upp)er|space)|url_(?:(?:c(?:los|opy_handl)|file_creat|paus)e|e(?:rr(?:no|or)|scape|xec)|getinfo|(?:ini|rese)t|multi_(?:(?:(?:add|remove)_handl|clos)e|e(?:rrno|xec)|getcontent|in(?:fo_read|it)|s(?:e(?:lec|top)t|trerror))|s(?:etopt(?:_array)?|hare_(?:close|errno|init|s(?:etopt|trerror))|trerror)|u(?:nescape|pkeep)|version))|d(?:ate(?:_(?:add|create(?:_(?:from_format|immutable(?:_from_format)?))?|d(?:(?:ate_s|efault_timezone_[gs])et|iff)|(?:forma|(?:offset_g|time(?:_s|(?:stamp|zone)_[gs]))e)t|get_last_errors|i(?:nterval_(?:create_from_date_string|format)|sodate_set)|modify|parse(?:_from_format)?|su(?:b|n(?:_info|rise|set)))|fmt_(?:(?:creat|localtim|pars)e|format(?:_object)?|get_(?:calendar(?:_object)?|(?:datetyp|error_(?:cod|messag)|local)e|pattern|time(?:type|zone(?:_id)?))|is_lenient|set_(?:calendar|lenient|pattern|timezone)))|ba_(?:(?:clos|delet|replac)e|(?:exist|handler)s|f(?:etch|irstkey)|(?:inser|key_spli|lis)t|nextkey|op(?:en|timize)|popen|sync)|(?:cn?)?gettext|e(?:bug_(?:(?:print_)?backtrace|zval_dump)|c(?:bin|hex)|flate_(?:add|init)|g2rad)|isk_(?:free|total)_space|l_test_test[12]|n(?:gettext|s_(?:check_record|get_(?:mx|record)))|om_import_simplexml)|e(?:aster_da(?:te|ys)|n(?:chant_(?:broker_(?:d(?:escribe|ict_exists)|free(?:_dict)?|get_(?:dict_path|error)|(?:ini|request_(?:pwl_)?dic)t|list_dicts|set_(?:dict_path|ordering))|dict_(?:add(?:_to_session)?|(?:quick_)?check|describe|get_error|is_added|s(?:tore_replacemen|ugges)t))|um_exists)|rror_(?:(?:clear|get)_last|(?:lo|reportin)g)|scapeshell(?:arg|cmd)|x(?:if_(?:imagetype|read_data|t(?:agname|humbnail))|pm1|tension_loaded))|f(?:astcgi_finish_request|d(?:atasync|iv)|eof|f(?:i_trampoline|lush)|get(?:c(?:sv)?|s)|i(?:l(?:e_put_contents|ter_(?:has_var|i(?:d|nput(?:_array)?)|list|var(?:_array)?))|nfo_(?:buffer|(?:clos|fil)e|open|set_flags))|loatval|(?:mo|re(?:a|nchtoj))d|nmatch|orward_static_call(?:_array)?|p(?:assthru|m_get_status|rintf|utcsv)|s(?:canf|eek|ockopen|tat|ync)|t(?:ell|ok|p_(?:a(?:lloc|ppend)|c(?:dup|h(?:dir|mod)|lose|onnect)|delete|exec|f(?:ge|pu)t|get(?:_option)?|login|m(?:dtm|kdir|lsd)|n(?:b_(?:continue|(?:f(?:ge|pu)|ge|pu)t)|list)|p(?:asv|ut|wd)|r(?:aw(?:list)?|ename|mdir)|s(?:et_option|(?:i[tz]|ystyp)e|sl_connect))|runcate)|unc_(?:get_args?|num_args)|write)|g(?:c_(?:(?:(?:collect_cycl|mem_cach)e|statu)s|disable|enabled?)|d_info|et(?:_(?:browser|c(?:(?:alled_clas|lass_(?:method|var))s|(?:fg_va|urrent_use)r)|de(?:bug_type|(?:clared_(?:(?:class|interfac)e|trait)|fined_(?:constant|function|var))s)|(?:extension_func|loaded_extension|m(?:angled_object_var|eta_tag)|parent_clas)s|h(?:eaders|tml_translation_table)|include(?:_path|d_files)|o(?:bject_vars|pen_basedir)|resource(?:_(?:id|type)|s))|(?:cw|lastmo)d|(?:dat|rusag)e|env|host(?:by(?:addr|namel?)|name)|imagesize(?:fromstring)?|my(?:[gpu]id|inode)|opt|protobyn(?:ame|umber)|servby(?:name|port)|t(?:ext|imeofday|ype))|m(?:(?:dat|(?:mk|strf)tim)e|p_(?:a(?:bs|[dn]d)|binomial|c(?:lrbit|mp|om)|div(?:_(?:qr?|r)|exact)|(?:expor|fac|hamdis|testbi)t|gcd(?:ext)?|i(?:mport|n(?:(?:i|ver)t|tval))|jacobi|(?:kronecke|x?o)r|l(?:cm|egendre)|m(?:od|ul)|ne(?:g|xtprime)|p(?:erfect_(?:power|square)|o(?:pcount|wm?)|rob_prime)|r(?:andom_(?:bits|range|seed)|oot(?:rem)?)|s(?:can[01]|etbit|ign|qrt(?:rem)?|trval|ub)))|r(?:apheme_(?:extract|s(?:tr(?:i(?:pos|str)|len|(?:ri?)?pos|str)|ubstr))|egoriantojd)|z(?:(?:un)?compress|(?:de(?:cod|flat)|encod|fil|inflat)e|open))|h(?:ash_(?:(?:algo|equal)s|copy|fi(?:le|nal)|h(?:kdf|mac(?:_(?:algos|file))?)|init|pbkdf2|update(?:_(?:file|stream))?)|e(?:ader(?:_re(?:gister_callback|move)|s_(?:lis|sen)t)|brev|x(?:2bin|dec))|ighlight_(?:file|string)|rtime|t(?:ml(?:(?:_entity|specialchars)_decode|entities)|tp_(?:build_query|response_code))|ypot)|i(?:conv(?:_(?:get_encoding|mime_(?:decode(?:_headers)?|encode)|s(?:et_encoding|tr(?:len|r?pos)|ubstr)))?|dn_to_(?:ascii|utf8)|gnore_user_abort|ma(?:ge(?:_type_to_(?:extension|mime_type)|a(?:ffine(?:matrix(?:conca|ge)t)?|lphablending|ntialias|rc|vif)|(?:bm|w(?:bm|eb))p|c(?:har(?:up)?|o(?:lor(?:a(?:llocate(?:alpha)?|t)|closest(?:alpha|hwb)?|deallocate|(?:exact|resolve)(?:alpha)?|match|s(?:et|forindex|total)|transparent)|nvolution|py(?:merge(?:gray)?|res(?:ampl|iz)ed)?)|r(?:eate(?:from(?:avif|(?:bm|w(?:bm|eb))p|g(?:d(?:2(?:part)?)?|if)|(?:jpe|(?:p|stri)n)g|tga|x[bp]m)|truecolor)?|op(?:auto)?))|d(?:ashedline|estroy)|ellipse|f(?:il(?:l(?:ed(?:arc|(?:ellips|rectangl)e|polygon)|toborder)?|ter)|lip|ont(?:height|width)|t(?:bbox|text))|g(?:ammacorrect|d2?|et(?:clip|interpolation)|if|rab(?:screen|window))|i(?:nterlace|struecolor)|jpeg|l(?:(?:ayereffec|oadfon)t|ine)|openpolygon|p(?:alette(?:copy|totruecolor)|ng|olygon)|r(?:e(?:ctangle|solution)|otate)|s(?:avealpha|cale|et(?:brush|clip|interpolation|pixel|style|t(?:hickness|ile))|tring(?:up)?|[xy])|t(?:ruecolortopalette|ypes)|xbm)|p_(?:(?:8bi|qprin)t|a(?:lerts|ppend)|b(?:ase64|inary|ody(?:struct)?)|c(?:heck|l(?:earflag_full|ose)|reatemailbox)|delete(?:mailbox)?|e(?:rrors|xpunge)|fetch(?:_overview|body|header|(?:mim|structur)e)|g(?:c|et(?:_quota(?:root)?|acl|mailboxes|subscribed))|header(?:info|s)|(?:is_)?open|l(?:ast_error|ist(?:scan)?|sub)|m(?:ail(?:_(?:co(?:mpose|py)|move)|boxmsginfo)?|ime_header_decode|sgno|utf7_to_utf8)|num_(?:msg|recent)|ping|r(?:e(?:namemailbox|open)|fc822_(?:parse_(?:adrlist|headers)|write_address))|s(?:avebody|e(?:arch|t(?:_quota|(?:ac|flag_ful)l))|ort|tatus|ubscribe)|t(?:hread|imeout)|u(?:id|n(?:delet|subscrib)e|tf(?:7_(?:de|en)code|8(?:_to_mutf7)?))))|n(?:_array|et_(?:ntop|pton)|flate_(?:add|get_(?:read_len|status)|init)|i_(?:get(?:_all)?|parse_quantity|restore|set)|t(?:div|erface_exists|l(?:_(?:error_nam|get_error_(?:cod|messag)|is_failur)e|cal_(?:a(?:dd|fter)|(?:befor|f(?:ield_differenc|rom_date_tim)|to_date_tim)e|c(?:lear|reate_instance)|equals|get(?:_(?:a(?:ctual_m(?:ax|in)imum|vailable_locales)|(?:day_of_week_typ|error_(?:cod|messag)|keyword_values_for_local)e|first_day_of_week|greatest_minimum|l(?:east_maximum|ocale)|m(?:aximum|inim(?:al_days_in_first_week|um))|now|(?:(?:repeat|skipp)ed_wall_time_op|weekend_transi)tion|t(?:ime(?:_zone)?|ype)))?|i(?:n_daylight_time|s_(?:equivalent_to|(?:lenien|se)t|weekend))|roll|set(?:_(?:(?:first_day_of|minimal_days_in_first)_week|lenient|(?:repeat|skipp)ed_wall_time_option|time(?:_zone)?))?)|gregcal_(?:(?:create_instanc|[gs]et_gregorian_chang)e|is_leap_year)|tz_(?:c(?:ount_equivalent_ids|reate_(?:default|enumeration|time_zone(?:_id_enumeration)?))|(?:(?:from|to)_date_time_zon|use_daylight_tim)e|get_(?:(?:canonical|windows)_id|d(?:isplay_name|st_savings)|e(?:quivalent_id|rror_(?:cod|messag)e)|(?:gm|offse)t|id(?:_for_windows_id)?|r(?:aw_offset|egion)|(?:tz_data_versio|unknow)n)|has_same_rules))))|p(?:2long|tc(?:embed|parse))|s_(?:bool|(?:(?:(?:c(?:all|ount)|(?:execu|wri)t)ab|uploaded_fi)l|i(?:nfinit|terabl)|re(?:adabl|sourc))e|f(?:i(?:l|nit)e|loat)|link|nan|s(?:calar|oap_fault|tring|ubclass_of))|terator_(?:(?:appl|to_arra)y|count))|j(?:d(?:dayofweek|monthname|to(?:french|gregorian|j(?:ewish|ulian)|unix))|(?:ewish|ulian)tojd|son_(?:last_error(?:_msg)?|validate)))[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Medium-Risk PHP Function Name Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933151,"phase":2,"chain":false}},{"id":"933152","description":"PHP Injection Attack: Medium-Risk PHP Function Name Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:kr?sort|l(?:c(?:first|g_value|h(?:grp|own))|dap_(?:8859_to_t61|(?:ad|bin)d(?:_ext)?|co(?:mpare|nnect(?:_wallet)?|unt_(?:entri|referenc)es)|d(?:elete(?:_ext)?|n2ufn)|e(?:rr(?:(?:2st|o)r|no)|scape|x(?:op(?:_(?:passwd|refresh|sync|whoami))?|plode_dn))|f(?:irst_(?:(?:attribut|referenc)e|entry)|ree_result)|get_(?:(?:attribut|entri)es|(?:d|optio|values_le)n)|list|mod(?:_(?:add|del|replace)(?:_ext)?|ify_batch)|next_(?:(?:attribut|referenc)e|entry)|parse_(?:exop|re(?:ference|sult))|re(?:ad|name(?:_ext)?)|s(?:asl_bind|e(?:arch|t_(?:option|rebind_proc))|tart_tls)|t61_to_8859|unbind)|evenshtein|i(?:bxml_(?:(?:clear|use_internal)_errors|disable_entity_loader|get_(?:e(?:rrors|xternal_entity_loader)|last_error)|set_(?:external_entity_loader|streams_context))|nkinfo|tespeed_(?:finish_request|re(?:quest|sponse)_headers))|o(?:cal(?:e(?:_(?:(?:accept_from_htt|looku)p|(?:c(?:anonicaliz|ompos)|pars)e|filter_matches|get_(?:(?:all_variant|keyword)s|d(?:efault|isplay_(?:(?:languag|nam)e|region|(?:scrip|varian)t))|primary_language|region|script)|set_default)|conv)|time)|g1[0p]|ng2ip)|stat|trim)|m(?:b_(?:c(?:h(?:eck_encoding|r)|onvert_(?:case|encoding|kana|variables))|de(?:code_(?:mimeheader|numericentity)|tect_(?:encoding|order))|e(?:ncod(?:e_(?:mimeheader|numericentity)|ing_aliases)|reg(?:_(?:match|replace(?:_callback)?|search(?:_(?:(?:get(?:po|reg)|(?:set)?po|reg)s|init))?)|i(?:_replace)?)?)|get_info|http_(?:in|out)put|internal_encoding|l(?:anguage|ist_encodings)|o(?:rd|utput_handler)|p(?:arse_str|referred_mime_name)|regex_(?:encoding|set_options)|s(?:crub|end_mail|plit|tr(?:_(?:pad|split)|cut|i(?:mwidth|pos|str)|len|pos|r(?:chr|i(?:chr|pos)|pos)|(?:st|to(?:low|upp)e)r|width)|ubst(?:itute_character|r(?:_count)?)))|(?:(?:d5|ove_uploaded)_fil|e(?:mory_(?:get_(?:peak_)?|reset_peak_)usag|taphon)|i(?:crotim|me_content_typ))e|hash(?:_(?:count|get_(?:block_siz|hash_nam)e|keygen_s2k))?|k(?:dir|time)|sg(?:_(?:(?:get_queu|re(?:ceiv|move_queu))e|queue_exists|s(?:e(?:nd|t_queue)|tat_queue))|fmt_(?:create|(?:format|parse)(?:_message)?|get_(?:(?:error_(?:cod|messag)|local)e|pattern)|set_pattern))|t_(?:getrandmax|s?rand)|ysqli_(?:a(?:ffected_rows|utocommit)|begin_transaction|c(?:ha(?:nge_user|racter_set_name)|lose|o(?:mmit|nnect(?:_err(?:no|or))?))|d(?:ata_seek|ebug|ump_debug_info)|e(?:rr(?:no|or(?:_list)?)|xecute_query)|f(?:etch_(?:a(?:ll|rray|ssoc)|column|field(?:_direct|s)?|lengths|object|row)|ield_(?:count|seek|tell)|ree_result)|get_(?:c(?:harset|lient_(?:info|stats|version)|onnection_stats)|(?:host|proto)_info|(?:links_stat|warning)s|server_(?:info|version))|in(?:fo|it|sert_id)|kill|m(?:ore_results|ulti_query)|n(?:ext_result|um_(?:field|row)s)|options|p(?:ing|oll|repare)|query|r(?:e(?:a(?:l_(?:connect|escape_string|query)|p_async_query)|fresh|(?:lease_savepoin|por)t)|ollback)|s(?:(?:avepoin|sl_se)t|e(?:lect_db|t_charset)|qlstate|t(?:(?:a|ore_resul)t|mt_(?:a(?:ffected_rows|ttr_[gs]et)|bind_(?:param|result)|close|data_seek|e(?:rr(?:no|or(?:_list)?)|xecute)|f(?:etch|(?:ield_coun|ree_resul)t)|get_(?:result|warnings)|in(?:it|sert_id)|more_results|n(?:ext_result|um_rows)|p(?:aram_count|repare)|res(?:et|ult_metadata)|s(?:end_long_data|qlstate|tore_result))))|thread_(?:id|safe)|(?:use_resul|warning_coun)t))|n(?:(?:at(?:case)?sor|gettex)t|et_get_interfaces|l(?:2br|_langinfo)|ormalizer_(?:get_raw_decomposition|is_normalized|normalize)|umfmt_(?:create|(?:format|parse)(?:_currency)?|get_(?:(?:(?:text_)?attribut|error_(?:cod|messag)|local)e|pattern|symbol)|set_(?:(?:text_)?attribute|pattern|symbol)))|o(?:b_(?:clean|end_(?:clean|flush)|(?:implicit_)?flush|g(?:et_(?:c(?:lean|ontents)|flush|le(?:ngth|vel)|status)|zhandler)|list_handlers)|c(?:i(?:_(?:(?:bind_(?:array_)?|define_)by_name|c(?:ancel|l(?:ient_version|ose)|o(?:llection_(?:a(?:ppend|ssign)|element_(?:assign|get)|max|size|trim)|(?:mmi|nnec)t))|e(?:rror|xecute)|f(?:etch(?:_(?:a(?:ll|rray|ssoc)|object|row))?|ield_(?:is_null|(?:nam|s(?:cal|iz))e|precision|type(?:_raw)?)|ree_(?:collection|descriptor|statement))|get_implicit_resultset|lob_(?:(?:appen|loa|re(?:a|win))d|copy|e(?:of|rase|xport)|flush|i(?:mport|s_equal)|s(?:(?:av|iz)e|eek)|t(?:ell|runcate)|write)|n(?:ew_(?:c(?:o(?:llection|nnect)|ursor)|descriptor)|um_(?:field|row)s)|p(?:a(?:rs|ssword_chang)e|connect)|r(?:e(?:gister_taf_callback|sult)|ollback)|s(?:e(?:rver_version|t_(?:(?:ac|db_opera|edi)tion|c(?:all_timeout|lient_i(?:dentifier|nfo))|module_name|prefetch(?:_lob)?))|tatement_type)|unregister_taf_callback)|fetchinto|[gs]etbufferinglob)|tdec)|dbc_(?:autocommit|(?:binmod|data_sourc)e|c(?:lose(?:_all)?|o(?:lumn(?:privilege)?s|mmit|nnect(?:ion_string_(?:is_quoted|(?:should_)?quote))?)|ursor)|e(?:rror(?:msg)?|xec(?:ute)?)|f(?:etch_(?:array|into|object|row)|ield_(?:len|n(?:ame|um)|(?:scal|typ)e)|oreignkeys|ree_result)|gettypeinfo|longreadlen|n(?:ext_result|um_(?:field|row)s)|p(?:connect|r(?:epare|(?:imarykey|ocedure(?:column)?)s))|r(?:esult(?:_all)?|ollback)|s(?:etoption|(?:pecialcolumn|tatistic)s)|table(?:privilege)?s)|p(?:cache_(?:compile_file|get_(?:configuration|status)|i(?:nvalidate|s_script_cached)|reset)|en(?:dir|log|ssl_(?:c(?:ipher_(?:iv|key)_length|ms_(?:(?:de|en)crypt|read|sign|verify)|sr_(?:export(?:_to_file)?|get_(?:public_key|subject)|new|sign))|d(?:(?:ecryp|iges)t|h_compute_key)|e(?:ncrypt|rror_string)|(?:get_(?:c(?:ert_location|ipher_method|urve_name)|md_method)|random_pseudo_byte)s|open|p(?:bkdf2|k(?:cs(?:12_(?:export(?:_to_file)?|read)|7_(?:(?:de|en)crypt|read|sign|verify))|ey_(?:(?:deriv|fre)e|export(?:_to_file)?|get_(?:details|p(?:rivate|ublic))|new))|(?:rivate|ublic)_(?:de|en)crypt)|s(?:eal|ign|pki_(?:export(?:_challenge)?|new|verify))|verify|x509_(?:check(?:_private_key|purpose)|export(?:_to_file)?|f(?:ingerprint|ree)|parse|read|verify))))|utput_(?:add_rewrite_var|reset_rewrite_vars))|p(?:a(?:rse_(?:ini_(?:file|string)|str)|ss(?:thru|word_(?:algos|get_info|(?:needs_re)?hash|verify))|thinfo)|c(?:lose|ntl_(?:a(?:larm|sync_signals)|exec|forkx?|get(?:_last_error|priority)|rfork|s(?:etpriority|ig(?:nal(?:_(?:dispatch|get_handler))?|procmask|timedwait|waitinfo)|trerror)|unshare|w(?:ait(?:pid)?|exitstatus|if(?:continu|exit|s(?:ignal|topp))ed|(?:stop|term)sig)))|do_drivers|fsockopen|g_(?:(?:affected_row|num_(?:field|row)|option)s|c(?:ancel_query|l(?:ient_encoding|ose)|o(?:n(?:nect(?:_poll|ion_(?:busy|reset|status))?|(?:sume_inpu|ver)t)|py_(?:from|to)))|d(?:bnam|elet)e|e(?:n(?:d_copy|ter_pipeline_mode)|scape_(?:bytea|identifier|literal|string)|x(?:ecut|it_pipeline_mod)e)|f(?:etch_(?:a(?:ll(?:_columns)?|rray|ssoc)|object|r(?:esult|ow))|ield(?:_(?:is_null|n(?:ame|um)|prtlen|size|t(?:able|ype(?:_oid)?))|isnull|prtlen)|lush|ree_result)|get_(?:notify|pid|result)|(?:hos|inser)t|l(?:ast_(?:error|notice|oid)|o_(?:(?:c(?:los|reat)|writ)e|(?:ex|im)port|open|read(?:_all)?|(?:see|unlin)k|t(?:ell|runcate)))|meta_data|p(?:arameter_status|(?:connec|or)t|i(?:ng|peline_s(?:tatus|ync))|(?:repar|ut_lin)e)|query(?:_params)?|result_(?:error(?:_field)?|s(?:eek|tatus))|s(?:e(?:lect|nd_(?:(?:execut|prepar)e|query(?:_params)?)|t_(?:client_encoding|error_(?:context_visibil|verbos)ity))|ocket)|t(?:ra(?:ce|nsaction_status)|ty)|u(?:n(?:escape_bytea|trace)|pdate)|version)|hp(?:_(?:ini_(?:loaded_file|scanned_files)|(?:s(?:api_nam|trip_whitespac)|unam)e)|credits|dbg_(?:break_(?:f(?:ile|unction)|method|next)|c(?:lea|olo)r|e(?:nd_oplog|xec)|get_executable|prompt|start_oplog)|info|version)|osix_(?:e?access|ctermid|f?pathconf|get(?:_last_error|(?:cw|(?:e[gu]|[su])i)d|g(?:id|r(?:gid|nam|oups))|login|p(?:g(?:id|rp)|p?id|w(?:nam|uid))|rlimit)|i(?:nitgroups|satty)|kill|mk(?:fifo|nod)|s(?:et(?:(?:e[gu]|p?g|[su])id|rlimit)|trerror|ysconf)|t(?:imes|tyname)|uname)|r(?:eg_(?:filter|grep|last_error(?:_msg)?|match_all|quote|replace_callback(?:_array)?|split)|o(?:c_(?:(?:clos|nic|terminat)e|get_status|open)|perty_exists))|spell_(?:add_to_(?:personal|session)|c(?:heck|lear_session|onfig_(?:(?:creat|ignor|mod)e|d(?:ata|ict)_dir|(?:persona|save_rep)l|r(?:epl|untogether)))|new(?:_(?:config|personal))?|s(?:(?:ave_wordli|ugge)s|tore_replacemen)t)|utenv)|quote(?:d_printable_(?:de|en)code|meta))[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Medium-Risk PHP Function Name Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933152,"phase":2,"chain":false}},{"id":"933153","description":"PHP Injection Attack: Medium-Risk PHP Function Name Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:r(?:a(?:d2deg|ndom_(?:bytes|int)|wurl(?:de|en)code)|e(?:a(?:d(?:dir|(?:gz)?file|lin(?:e(?:_(?:(?:(?:add|list|write)_histor|re(?:ad_histor|displa))y|c(?:allback_(?:handler_(?:install|remove)|read_char)|lear_history|ompletion_function)|info|on_new_line))?|k))|lpath(?:_cache_(?:get|size))?)|gister_(?:shutdown|tick)_function|s(?:ourcebundle_(?:c(?:ount|reate)|get(?:_error_(?:cod|messag)e)?|locales)|tore_e(?:rror|xception)_handler)|wind(?:dir)?)|mdir|sort)|s(?:api_windows_(?:cp_(?:conv|[gs]et|is_utf8)|(?:generate_ctrl_even|vt100_suppor)t|set_ctrl_handler)|candir|e(?:m_(?:(?:acquir|re(?:leas|mov))e|get)|ssion_(?:(?:abor|unse)t|c(?:ache_(?:expire|limiter)|reate_id)|de(?:code|stroy)|(?:encod|(?:module_)?nam|write_clos)e|g(?:c|et_cookie_params)|id|re(?:g(?:enerate_id|ister_shutdown)|set)|s(?:ave_path|et_(?:cookie_params|save_handler)|ta(?:rt|tus)))|t(?:_(?:e(?:rror|xception)_handler|include_path|time_limit)|(?:(?:raw)?cooki|local)e))|h(?:a1(?:_file)?|ell_exec|m(?:_(?:(?:at|de)tach|(?:(?:ge|pu)t|has)_var|remove(?:_var)?)|op_(?:(?:clos|(?:dele|wri)t|siz)e|open|read)))|i(?:m(?:ilar_text|plexml_(?:import_dom|load_(?:file|string)))|nh)|nmp(?:[23]_(?:get(?:next)?|(?:real_)?walk|set)|_(?:get_(?:quick_print|valueretrieval)|read_mib|set_(?:(?:(?:enum|quick)_prin|oid_output_forma)t|valueretrieval))|get(?:next)?|(?:real)?walk|set)|o(?:cket_(?:a(?:ccept|ddrinfo_(?:bind|connect|explain|lookup)|tmark)|bind|c(?:l(?:ear_error|ose)|msg_space|onnect|reate(?:_(?:listen|pair))?)|(?:ex|im)port_stream|get(?:_option|(?:peer|sock)name)|l(?:ast_error|isten)|re(?:ad|cv(?:from|msg)?)|s(?:e(?:lect|nd(?:msg|to)?|t_(?:(?:non)?block|option))|hutdown|trerror)|w(?:rite|saprotocol_info_(?:(?:ex|im)port|release)))|dium_(?:(?:ad|(?:un)?pa)d|b(?:ase642bin|in2(?:base64|hex))|c(?:ompare|rypto_(?:a(?:ead_(?:aes256gcm_(?:(?:de|en)crypt|is_available|keygen)|chacha20poly1305_(?:(?:de|en)crypt|ietf_(?:(?:de|en)crypt|keygen)|keygen)|xchacha20poly1305_ietf_(?:(?:de|en)crypt|keygen))|uth(?:_(?:keygen|verify))?)|box(?:_(?:keypair(?:_from_secretkey_and_publickey)?|open|publickey(?:_from_secretkey)?|se(?:al(?:_open)?|cretkey|ed_keypair)))?|core_ristretto255_(?:add|from_hash|is_valid_point|random|s(?:calar_(?:add|(?:complemen|inver)t|mul|negate|r(?:andom|educe)|sub)|ub))|generichash(?:_(?:final|init|keygen|update))?|k(?:df_(?:derive_from_key|keygen)|x_(?:client_session_keys|keypair|publickey|se(?:cretkey|ed_keypair|rver_session_keys)))|pwhash(?:_s(?:cryptsalsa208sha256(?:_str(?:_verify)?)?|tr(?:_(?:needs_rehash|verify))?))?|s(?:calarmult(?:_ristretto255(?:_base)?)?|ecret(?:box(?:_(?:keyg|op)en)?|stream_xchacha20poly1305_(?:(?:init_)?pu(?:ll|sh)|keygen|rekey))|horthash(?:_keygen)?|ign(?:_(?:(?:verify_)?detached|ed25519_[ps]k_to_curve25519|keypair(?:_from_secretkey_and_publickey)?|open|publickey(?:_from_secretkey)?|se(?:cretkey|ed_keypair)))?|tream(?:_(?:keygen|x(?:chacha20(?:_(?:keygen|xor(?:_ic)?))?|or)))?)))|hex2bin|increment|mem(?:cmp|zero))|undex)|p(?:l_(?:autoload(?:_(?:call|(?:extens|funct)ions|(?:un)?register))?|classes|object_(?:hash|id))|rintf)|qrt|scanf|tr(?:_(?:contains|(?:decreme|word_cou)nt|ends_with|getcsv|i(?:ncrement|replace)|pad|r(?:epeat|ot13)|s(?:huffle|plit|tarts_with))|c(?:(?:asec)?mp|oll|spn)|eam_(?:bucket_(?:(?:ap|pre)pend|make_writeable|new)|co(?:ntext_(?:create|get_(?:default|(?:option|param)s)|set_(?:default|options?|params))|py_to_stream)|filter_(?:(?:ap|pre)pend|re(?:gister|move))|get_(?:(?:(?:conten|transpor)t|(?:filt|wrapp)er)s|line|meta_data)|is(?:_local|atty)|resolve_include_path|s(?:e(?:lect|t_(?:blocking|chunk_size|(?:read|write)_buffer|timeout))|ocket_(?:(?:accep|clien)t|enable_crypto|get_name|pair|recvfrom|s(?:e(?:ndto|rver)|hutdown))|upports_lock)|wrapper_(?:re(?:gister|store)|unregister))|ftime|i(?:p(?:c?slashe|o)s|str)|n(?:at)?c(?:asec)?mp|p(?:brk|time)|r(?:chr|ev|i?pos)|s(?:pn|tr)|t(?:ok|r)|val)|ubstr_(?:co(?:mpare|unt)|replace)|ys_get(?:_temp_dir|loadavg))|t(?:anh|e(?:mpnam|st[12]|xtdomain)|i(?:dy_(?:(?:access|error|warning)_count|c(?:lean_repair|onfig_count)|diagnose|get(?:_(?:body|config|error_buffer|h(?:ead|tml(?:_ver)?)|o(?:pt_doc|utput)|r(?:elease|oot)|status)|opt)|is_x(?:ht)?ml|(?:parse|repair)_(?:file|string))|me(?:_(?:nanosleep|sleep_until)|zone_(?:(?:(?:abbreviation|identifier)s_lis|(?:(?:locat|vers)ion|transitions)_ge)t|name_(?:from_abbr|get)|o(?:ffset_get|pen))))|mpfile|oken_(?:get_all|name)|r(?:a(?:it_exists|nsliterator_(?:create(?:_(?:from_rules|inverse))?|(?:get_error_(?:cod|messag)|transliterat)e|list_ids))|igger_error))|u(?:[ak]sort|cwords|mask|n(?:i(?:qi|xtoj)d|register_tick_function)|(?:rlde|tf8_(?:de|en))code|s(?:e_soap_error_handler|leep|ort))|v(?:ar(?:_(?:dump|export)|iant_(?:a(?:bs|[dn]d)|c(?:as?t|mp)|d(?:ate_(?:from|to)_timestamp|iv)|eqv|fix|get_type|i(?:div|mp|nt)|m(?:od|ul)|n(?:eg|ot)|x?or|pow|round|s(?:et(?:_type)?|ub)))|ersion_compare|[fs]?printf)|wordwrap|xml(?:_(?:error_string|get_(?:current_(?:byte_index|(?:column|line)_number)|error_code)|parse(?:_into_struct|r_(?:create(?:_ns)?|free|[gs]et_option))?|set_(?:(?:character_data|default|e(?:lement|nd_namespace_decl|xternal_entity_ref)|(?:notation|start_namespace|unparsed_entity)_decl|processing_instruction)_handler|object))|writer_(?:end_(?:attribute|c(?:data|omment)|d(?:ocument|td(?:_(?:attlist|e(?:lement|ntity)))?)|element|pi)|f(?:lush|ull_end_element)|o(?:pen_(?:memory|uri)|utput_memory)|s(?:et_indent(?:_string)?|tart_(?:(?:attribute|element)(?:_ns)?|c(?:data|omment)|d(?:ocument|td(?:_(?:attlist|e(?:lement|ntity)))?)|pi))|text|write_(?:(?:attribute|element)(?:_ns)?|c(?:data|omment)|dtd(?:_(?:attlist|e(?:lement|ntity)))?|pi|raw)))|z(?:end_(?:c(?:all_method|reate_unterminated_string)|get_(?:current_func_name|map_ptr_last|unit_enum)|iterable(?:_legacy)?|leak_(?:bytes|variable)|(?:number_or_string|string_or_(?:object|stdclass))(?:_or_null)?|t(?:e(?:rminate_string|st_(?:(?:(?:nullable_)?array|void)_return|c(?:ompile_string|r(?:ash|eate_throwing_resource))|deprecated|f(?:ill_packed_array|unc)|is_string_marked_as_valid_utf8|(?:override_libxml_global_sta|parameter_with_attribu)te|zend_(?:call_stack_(?:get|use_all)|ini_(?:parse_u?quantity|str))))|hread_id)|version|weakmap_(?:attach|dump|remove))|ip_(?:close|entry_(?:c(?:lose|ompress(?:edsize|ionmethod))|(?:filesiz|nam)e|open|read)|open|read)|lib_(?:(?:de|en)cod|get_coding_typ)e)|ZendTestNS2_(?:ZendSubNS_)?namespaced_(?:deprecated_)?func)[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Medium-Risk PHP Function Name Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933153,"phase":2,"chain":false}},{"id":"933015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933015,"phase":1,"chain":false}},{"id":"933016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933016,"phase":2,"chain":false}},{"id":"933131","description":"PHP Injection Attack: Variables Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"AUTH_TYPE|HTTP_(?:ACCEPT(?:_(?:CHARSET|ENCODING|LANGUAGE))?|CONNECTION|(?:HOS|USER_AGEN)T|KEEP_ALIVE|(?:REFERE|X_FORWARDED_FO)R)|ORIG_PATH_INFO|PATH_(?:INFO|TRANSLATED)|QUERY_STRING|REQUEST_URI"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Variables Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["NormalizePath","UrlDecodeUni"],"id":933131,"phase":2,"chain":false}},{"id":"933161","description":"PHP Injection Attack: Low-Value PHP Function Call Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:bs|s(?:in|sert(?:_options)?))|basename|c(?:h(?:eckdate|r(?:oot)?)|o(?:(?:mpac|(?:nsta|u)n)t|py|sh?)|r(?:eate_function|ypt)|urrent)|d(?:ate|e(?:coct|fined?)|ir)|e(?:nd|val|x(?:ec|p(?:lode)?|tract))|f(?:ile(?:(?:[acm]tim|inod|siz|typ)e|group|owner|perms)?|l(?:o(?:ck|or)|ush))|glob|h(?:ash|eader)|i(?:date|m(?:age(?:gif|(?:jpe|pn)g|wbmp|xbm)|plode)|s_a)|key|l(?:ink|og)|m(?:a(?:il|x)|d5|in)|n(?:ame|ext)|o(?:pendir|rd)|p(?:a(?:ck|ss(?:thru)?)|i|o(?:pen|w)|rev)|r(?:an(?:d|ge)|e(?:(?:adfil|nam)e|set)|ound)|s(?:(?:erializ|huffl)e|in|leep|(?:or|ta)t|ubstr|y(?:mlink|s(?:log|tem)))|t(?:an|(?:im|mpfil)e|ouch|rim)|u(?:cfirst|n(?:lin|pac)k)|virtual)(?:[\\s\\x0b]|/\\*.*\\*/|(?:#|//).*)*\\(.*\\)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: Low-Value PHP Function Call Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":933161,"phase":2,"chain":false}},{"id":"933111","description":"PHP Injection Attack: PHP Script File Upload Found","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X.Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"Rx":".*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\..*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Script File Upload Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":933111,"phase":2,"chain":false}},{"id":"933190","description":"PHP Injection Attack: PHP Closing Tag Found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"@pm ?>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Injection Attack: PHP Closing Tag Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-injection-php"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-PHP"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.php_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":933190,"phase":2,"chain":false}},{"id":"933017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933017,"phase":1,"chain":false}},{"id":"933018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-933-APPLICATION-ATTACK-PHP"}],"transformations":[],"id":933018,"phase":2,"chain":false}},{"id":"934011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934011,"phase":1,"chain":false}},{"id":"934012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934012,"phase":2,"chain":false}},{"id":"934110","description":"Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"PmFromFile":"ssrf.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-ssrf"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/225/664"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934110,"phase":2,"chain":false}},{"id":"934130","description":"JavaScript Prototype Pollution","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:__proto__|constructor\\s*(?:\\.|\\]?\\[)\\s*prototype)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"JavaScript Prototype Pollution"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-javascript"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1/180/77"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":934130,"phase":2,"chain":false}},{"id":"934150","description":"Ruby Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"Process[\\s\\x0b]*\\.[\\s\\x0b]*spawn[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Ruby Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-ruby"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934150,"phase":2,"chain":false}},{"id":"934013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934013,"phase":1,"chain":false}},{"id":"934014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934014,"phase":2,"chain":false}},{"id":"934101","description":"Node.js Injection Attack 2/2","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:close|exists|fork|(?:ope|spaw)n|re(?:ad|quire)|w(?:atch|rite))[\\s\\x0b]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Node.js Injection Attack 2/2"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-javascript"},{"Tag":"platform-nodejs"},{"Tag":"attack-rce"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","Base64Decode","UrlDecodeUni"],"id":934101,"phase":2,"chain":false}},{"id":"934120","description":"Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip):/?/?(?:[0-9]{7,10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-ssrf"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/225/664"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934120,"phase":2,"chain":false}},{"id":"934140","description":"Perl Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"^(?:[^@]|@[^\\{])*@+\\{[^\\}]*\\}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Perl Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-perl"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934140,"phase":2,"chain":false}},{"id":"934180","description":"SSTI Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:\\{%[^%}]*%}|<%=?[^%>]*%>)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SSTI Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"platform-multi"},{"Tag":"attack-ssti"},{"Tag":"attack-injection-generic"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-GENERIC"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":934180,"phase":2,"chain":false}},{"id":"934015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934015,"phase":1,"chain":false}},{"id":"934016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934016,"phase":2,"chain":false}},{"id":"934017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934017,"phase":1,"chain":false}},{"id":"934018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-934-APPLICATION-ATTACK-GENERIC"}],"transformations":[],"id":934018,"phase":2,"chain":false}},{"id":"941011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941011,"phase":1,"chain":false}},{"id":"941012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941012,"phase":2,"chain":false}},{"id":"941010","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false}],"operator":{"Rx":"!@validateByteRange 20,45-47,48-57,65-90,95,97-122"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Ctl":["","ruleRemoveTargetByTag=xss-perf-disable;REQUEST_FILENAME"]},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":941010,"phase":1,"chain":false}},{"id":"941100","description":"XSS Attack Detected via libinjection","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":"DetectXSS","actions":["Block",{"Msg":"XSS Attack Detected via libinjection"},{"LogData":"Matched Data: XSS data found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941100,"phase":2,"chain":false}},{"id":"941110","description":"XSS Filter - Category 1: Script Tag Vector","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<script[^>]*>[\\s\\S]*?"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Filter - Category 1: Script Tag Vector"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941110,"phase":2,"chain":false}},{"id":"941130","description":"XSS Filter - Category 3: Attribute Vector","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i).(?:\\b(?:(?:x(?:link:href|html|mlns)|data:text/html|formaction)\\b|pattern[\\s\\x0b]*=)|(?:!ENTITY[\\s\\x0b]+(?:%[\\s\\x0b]+)?[^\\s\\x0b]+[\\s\\x0b]+(?:SYSTEM|PUBLIC)|@import|;base64)\\b)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Filter - Category 3: Attribute Vector"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941130,"phase":2,"chain":false}},{"id":"941140","description":"XSS Filter - Category 4: Javascript URI Vector","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)[a-z]+=(?:[^:=]+:.+;)*?[^:=]+:url\\(javascript"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Filter - Category 4: Javascript URI Vector"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls","RemoveWhitespace"],"id":941140,"phase":2,"chain":false}},{"id":"941180","description":"Node-Validator Deny List Keywords","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":"NoOp","actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Node-Validator Deny List Keywords"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-nodejs"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941180,"phase":2,"chain":false}},{"id":"941190","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:<style.*?>.*?(?:@[i\\x5c]|(?:[:=]|&#x?0*(?:58|3A|61|3D);?).*?(?:[(\\x5c]|&#x?0*(?:40|28|92|5C);?)))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941190,"phase":2,"chain":false}},{"id":"941200","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:<.*[:]?vmlframe.*?[\\s/+]*?src[\\s/+]*=)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941200,"phase":2,"chain":false}},{"id":"941210","description":"Javascript Word Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:j|&#(?:0*(?:74|106)|x0*[46]A);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:v|&#(?:0*(?:86|118)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;))."},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Javascript Word Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941210,"phase":2,"chain":false}},{"id":"941220","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:v|&#(?:0*(?:118|86)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:b|&#(?:0*(?:98|66)|x0*[46]2);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;))."},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941220,"phase":2,"chain":false}},{"id":"941230","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<EMBED[\\s/+].*?(?:src|type).*?="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941230,"phase":2,"chain":false}},{"id":"941240","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"<[?]?import[\\s/+\\S]*?implementation[\\s/+]*?="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","Lowercase","RemoveNulls"],"id":941240,"phase":2,"chain":false}},{"id":"941260","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:<META[\\s/+].*?charset[\\s/+]*=)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941260,"phase":2,"chain":false}},{"id":"941270","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<LINK[\\s/+].*?href[\\s/+]*="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941270,"phase":2,"chain":false}},{"id":"941280","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<BASE[\\s/+].*?href[\\s/+]*="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941280,"phase":2,"chain":false}},{"id":"941290","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<APPLET[\\s/+>]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941290,"phase":2,"chain":false}},{"id":"941300","description":"IE XSS Filters - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<OBJECT[\\s/+].*?(?:type|codetype|classid|code|data)[\\s/+]*="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IE XSS Filters - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941300,"phase":2,"chain":false}},{"id":"941310","description":"US-ASCII Malformed Encoding XSS Filter - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\xbc[^\\xbe>]*[\\xbe>]|<[^\\xbe]*\\xbe"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"US-ASCII Malformed Encoding XSS Filter - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-tomcat"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":["Lowercase","UrlDecodeUni","HtmlEntityDecode"],"id":941310,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"(?:\\xbc\\s*/\\s*[^\\xbe>]*[\\xbe>])|(?:<\\s*/\\s*[^\\xbe]*\\xbe)"},"actions":[{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"941350","description":"UTF-7 Encoding IE XSS - Attack Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\+ADw-.*(?:\\+AD4-|>)|<.*\\+AD4-"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"UTF-7 Encoding IE XSS - Attack Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-internet-explorer"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode"],"id":941350,"phase":2,"chain":false}},{"id":"941360","description":"JSFuck / Hieroglyphy obfuscation detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"![!+ ]\\[\\]"},"actions":["Block",{"Msg":"JSFuck / Hieroglyphy obfuscation detected"},{"LogData":"Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242/63"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":941360,"phase":2,"chain":false}},{"id":"941370","description":"JavaScript global variable found","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:self|document|this|top|window)\\s*(?:/\\*|[\\[)]).+?(?:\\]|\\*/)"},"actions":["Block",{"Msg":"JavaScript global variable found"},{"LogData":"Matched Data: Suspicious JS global variable found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242/63"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","CompressWhitespace"],"id":941370,"phase":2,"chain":false}},{"id":"941390","description":"Javascript method detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:eval|set(?:timeout|interval)|new[\\s\\x0b]+Function|a(?:lert|tob)|btoa|(?:promp|impor)t|con(?:firm|sole\\.(?:log|dir))|fetch)[\\s\\x0b]*[\\(\\{]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Javascript method detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-nodejs"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["HtmlEntityDecode"],"id":941390,"phase":2,"chain":false}},{"id":"941400","description":"XSS JavaScript function without parentheses","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"((?:\\[[^\\]]*\\][^.]*\\.)|Reflect[^.]*\\.).*(?:map|sort|apply)[^.]*\\..*call[^`]*`.*`"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS JavaScript function without parentheses"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","CompressWhitespace"],"id":941400,"phase":2,"chain":false}},{"id":"941013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941013,"phase":1,"chain":false}},{"id":"941014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941014,"phase":2,"chain":false}},{"id":"941101","description":"XSS Attack Detected via libinjection","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":"DetectXSS","actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Attack Detected via libinjection"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941101,"phase":1,"chain":false}},{"id":"941150","description":"XSS Filter - Category 5: Disallowed HTML Attributes","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:s(?:tyle|rc)|href)\\b[\\s\\S]*?="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"XSS Filter - Category 5: Disallowed HTML Attributes"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","RemoveNulls"],"id":941150,"phase":2,"chain":false}},{"id":"941181","description":"Node-Validator Deny List Keywords","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Contains":"-->"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Node-Validator Deny List Keywords"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode","Lowercase","RemoveNulls"],"id":941181,"phase":2,"chain":false}},{"id":"941320","description":"Possible XSS Attack Detected - HTML Tag Handler","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"<(?:a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|hr|html|i|iframe|ilayer|img|input|ins|isindex|kdb|keygen|label|layer|legend|li|limittext|link|listing|map|marquee|menu|meta|multicol|nobr|noembed|noframes|noscript|nosmartquotes|object|ol|optgroup|option|p|param|plaintext|pre|q|rt|ruby|s|samp|script|select|server|shadow|sidebar|small|spacer|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|title|tr|tt|u|ul|var|wbr|xml|xmp)\\W"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible XSS Attack Detected - HTML Tag Handler"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242/63"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":941320,"phase":2,"chain":false}},{"id":"941380","description":"AngularJS client side template injection detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"\\{\\{.*?}}"},"actions":["Block",{"Msg":"AngularJS client side template injection detected"},{"LogData":"Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"attack-xss"},{"Tag":"xss-perf-disable"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-XSS"},{"Tag":"capec/1000/152/242/63"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.xss_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":941380,"phase":2,"chain":false}},{"id":"941015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941015,"phase":1,"chain":false}},{"id":"941016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941016,"phase":2,"chain":false}},{"id":"941017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941017,"phase":1,"chain":false}},{"id":"941018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-941-APPLICATION-ATTACK-XSS"}],"transformations":[],"id":941018,"phase":2,"chain":false}},{"id":"942011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942011,"phase":1,"chain":false}},{"id":"942012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942012,"phase":2,"chain":false}},{"id":"942100","description":"SQL Injection Attack Detected via libinjection","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":"DetectSQLi","actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack Detected via libinjection"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","RemoveNulls"],"id":942100,"phase":2,"chain":false}},{"id":"942140","description":"SQL Injection Attack: Common DB Names Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:d(?:atabas|b_nam)e[^0-9A-Z_a-z]*\\(|(?:information_schema|m(?:aster\\.\\.sysdatabases|s(?:db|ys(?:ac(?:cess(?:objects|storage|xml)|es)|modules2?|(?:object|querie|relationship)s))|ysql\\.db)|northwind|pg_(?:catalog|toast)|tempdb)\\b|s(?:chema(?:_name\\b|[^0-9A-Z_a-z]*\\()|(?:qlite_(?:temp_)?master|ys(?:aux|\\.database_name))\\b))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack: Common DB Names Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942140,"phase":2,"chain":false}},{"id":"942151","description":"SQL Injection Attack: SQL function name detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|eil(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert_tz)?)|t)|rc32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|s_(?:de|en)crypt)|ump)|e(?:n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|insert|object(?:_(?:agg|keys))?|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|insert_id)|case|east|i(?:kely|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2))|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:lygon|w)|rocedure_analyse)|qu(?:ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp))|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack: SQL function name detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942151,"phase":2,"chain":false}},{"id":"942160","description":"Detects blind sqli tests using sleep() or benchmark()","enabled":true,"details":{"variables":[{"variable":"RequestFilename","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:sleep\\s*?\\(.*?\\)|benchmark\\s*?\\(.*?\\,.*?\\))"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects blind sqli tests using sleep() or benchmark()"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942160,"phase":2,"chain":false}},{"id":"942170","description":"Detects SQL benchmark and sleep injection attempts including conditional queries","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:select|;)[\\s\\x0b]+(?:benchmark|if|sleep)[\\s\\x0b]*?\\([\\s\\x0b]*?\\(?[\\s\\x0b]*?[0-9A-Z_a-z]+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects SQL benchmark and sleep injection attempts including conditional queries"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942170,"phase":2,"chain":false}},{"id":"942230","description":"Detects conditional SQL injection attempts","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)[\\s\\x0b\\(\\)]case[\\s\\x0b]+when.*?then|\\)[\\s\\x0b]*?like[\\s\\x0b]*?\\(|select.*?having[\\s\\x0b]*?[^\\s\\x0b]+[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z]|if[\\s\\x0b]?\\([0-9A-Z_a-z]+[\\s\\x0b]*?[<->~]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects conditional SQL injection attempts"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942230,"phase":2,"chain":false}},{"id":"942270","description":"Looking for basic sql injection. Common attack string for mysql, oracle and others","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)union.*?select.*?from"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Looking for basic sql injection. Common attack string for mysql, oracle and others"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942270,"phase":2,"chain":false}},{"id":"942290","description":"Finds basic MongoDB SQL injection attempts","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Finds basic MongoDB SQL injection attempts"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942290,"phase":2,"chain":false}},{"id":"942320","description":"Detects MySQL and PostgreSQL stored procedure/function injections","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects MySQL and PostgreSQL stored procedure/function injections"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942320,"phase":2,"chain":false}},{"id":"942350","description":"Detects MySQL UDF injection and other data/structure manipulation attempts","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)create[\\s\\x0b]+function[\\s\\x0b].+[\\s\\x0b]returns|;[\\s\\x0b]*?(?:alter|(?:(?:cre|trunc|upd)at|re(?:nam|plac))e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)\\b[\\s\\x0b]*?[\\(\\[]?[0-9A-Z_a-z]{2,}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects MySQL UDF injection and other data/structure manipulation attempts"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942350,"phase":2,"chain":false}},{"id":"942500","description":"MySQL in-line comment detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"MySQL in-line comment detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"Tag":"FLAG:multiMatch"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942500,"phase":2,"chain":false}},{"id":"942560","description":"MySQL Scientific Notation payload detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)1\\.e(?:[\\(\\),]|\\.[\\$0-9A-Z_a-z])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"MySQL Scientific Notation payload detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942560,"phase":2,"chain":false}},{"id":"942013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942013,"phase":1,"chain":false}},{"id":"942014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942014,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":{"StrEq":"%{TX.2}"},"actions":[{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"942150","description":"SQL Injection Attack: SQL function name detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:json(?:_[0-9A-Z_a-z]+)?|a(?:bs|(?:cos|sin)h?|tan[2h]?|vg)|c(?:eil(?:ing)?|h(?:a(?:nges|r(?:set)?)|r)|o(?:alesce|sh?|unt)|ast)|d(?:e(?:grees|fault)|a(?:te|y))|exp|f(?:loor(?:avg)?|ormat|ield)|g(?:lob|roup_concat)|h(?:ex|our)|i(?:f(?:null)?|if|n(?:str)?)|l(?:ast(?:_insert_rowid)?|ength|ike(?:l(?:ihood|y))?|n|o(?:ad_extension|g(?:10|2)?|wer(?:pi)?|cal)|trim)|m(?:ax|in(?:ute)?|o(?:d|nth))|n(?:ullif|ow)|p(?:i|ow(?:er)?|rintf|assword)|quote|r(?:a(?:dians|ndom(?:blob)?)|e(?:p(?:lace|eat)|verse)|ound|trim|ight)|s(?:i(?:gn|nh?)|oundex|q(?:lite_(?:compileoption_(?:get|used)|offset|source_id|version)|rt)|u(?:bstr(?:ing)?|m)|econd|leep)|t(?:anh?|otal(?:_changes)?|r(?:im|unc)|ypeof|ime)|u(?:n(?:icode|likely)|(?:pp|s)er)|zeroblob|bin|v(?:alues|ersion)|week|year)[^0-9A-Z_a-z]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack: SQL function name detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942150,"phase":2,"chain":false}},{"id":"942361","description":"Detects basic SQL injection based on keyword alter or union","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:^[\\W\\d]+\\s*?(?:alter|union)\\b)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects basic SQL injection based on keyword alter or union"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942361,"phase":2,"chain":false}},{"id":"942410","description":"SQL Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:(?:b|co)s|dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:in|cii(?:str)?)|tan2?|vg)|b(?:enchmark|i(?:n(?:_to_num)?|t_(?:and|count|length|x?or)))|c(?:ast|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|o(?:alesce|ercibility|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|(?:un)?t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|time(?:stamp)?|user)))|d(?:a(?:t(?:abase|e(?:_(?:add|format|sub)|diff)?)|y(?:name|of(?:month|week|year))?)|count|e(?:code|(?:faul|s_(?:de|en)cryp)t|grees)|ump)|e(?:lt|nc(?:ode|rypt)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:eld(?:_in_set)?|nd_in_set)|loor|o(?:rmat|und_rows)|rom_(?:base64|days|unixtime))|g(?:et_(?:format|lock)|r(?:eates|oup_conca)t)|h(?:ex(?:toraw)?|our)|i(?:f(?:null)?|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)?|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull))|null)?)|l(?:ast(?:_(?:day|insert_id))?|case|e(?:(?:as|f)t|ngth)|n|o(?:ad_file|ca(?:l(?:timestamp)?|te)|g(?:10|2)?|wer)|pad|trim)|m(?:a(?:ke(?:date|_set)|ster_pos_wait|x)|d5|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:d|nth(?:name)?))|n(?:ame_const|o(?:t_in|w)|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:assword|eriod_(?:add|diff)|g_sleep|i|o(?:sition|w(?:er)?)|rocedure_analyse)|qu(?:arter|ote)|r(?:a(?:dians|nd|wto(?:hex|nhex(?:toraw)?))|e(?:lease_lock|p(?:eat|lace)|verse)|ight|o(?:und|w_count)|pad|trim)|s(?:chema|e(?:c(?:ond|_to_time)|ssion_user)|ha[12]?|ig?n|leep|oundex|pace|qrt|t(?:d(?:dev(?:_(?:po|sam)p)?)?|r(?:cmp|_to_date))|u(?:b(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|m)|ys(?:date|tem_user))|t(?:an|ime(?:diff|_(?:format|to_sec)|stamp(?:add|diff)?)?|o_(?:base64|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|ix_timestamp)|p(?:datexml|per)|ser|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|v(?:a(?:lues|r(?:iance|_(?:po|sam)p))|ersion)|we(?:ek(?:day|ofyear)?|ight_string)|xmltype|year(?:week)?)[^0-9A-Z_a-z]*?\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942410,"phase":2,"chain":false}},{"id":"942470","description":"SQL Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)autonomous_transaction|(?:current_use|n?varcha|tbcreato)r|db(?:a_users|ms_java)|open(?:owa_util|query|rowset)|s(?:p_(?:(?:addextendedpro|sqlexe)c|execute(?:sql)?|help|is_srvrolemember|makewebtask|oacreate|p(?:assword|repare)|replwritetovarbin)|ql_(?:longvarchar|variant))|utl_(?:file|http)|xp_(?:availablemedia|(?:cmdshel|servicecontro)l|dirtree|e(?:numdsn|xecresultset)|filelist|loginconfig|makecab|ntsec(?:_enumdomains)?|reg(?:addmultistring|delete(?:key|value)|enum(?:key|value)s|re(?:ad|movemultistring)|write)|terminate(?:_process)?)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942470,"phase":2,"chain":false}},{"id":"942480","description":"SQL Injection Attack","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:(?:d(?:bms_[0-9A-Z_a-z]+\\.|elete\\b[^0-9A-Z_a-z]*?\\bfrom)|(?:group\\b.*?\\bby\\b.{1,100}?\\bhav|overlay\\b[^0-9A-Z_a-z]*?\\(.*?\\b[^0-9A-Z_a-z]*?plac)ing|in(?:ner\\b[^0-9A-Z_a-z]*?\\bjoin|sert\\b[^0-9A-Z_a-z]*?\\binto|to\\b[^0-9A-Z_a-z]*?\\b(?:dump|out)file)|load\\b[^0-9A-Z_a-z]*?\\bdata\\b.*?\\binfile|s(?:elect\\b.{1,100}?\\b(?:(?:.*?\\bdump\\b.*|(?:count|length)\\b.{1,100}?)\\bfrom|(?:data_typ|from\\b.{1,100}?\\bwher)e|instr|to(?:_(?:cha|numbe)r|p\\b.{1,100}?\\bfrom))|ys_context)|u(?:nion\\b.{1,100}?\\bselect|tl_inaddr))\\b|print\\b[^0-9A-Z_a-z]*?@@)|(?:collation[^0-9A-Z_a-z]*?\\(a|@@version|;[^0-9A-Z_a-z]*?\\b(?:drop|shutdown))\\b|'(?:dbo|msdasql|s(?:a|qloledb))'"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942480,"phase":2,"chain":false}},{"id":"942440","description":"SQL Comment Sequence Detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"/\\*!?|\\*/|[';]--|--(?:[\\s\\x0b]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\x0b]|;?\\x00"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Comment Sequence Detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":["UrlDecodeUni"],"id":942440,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^(?:ey[\\-0-9A-Z_a-z]+\\.ey[\\-0-9A-Z_a-z]+\\.)?[\\-0-9A-Z_a-z]+$"},"actions":[{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"942450","description":"SQL Bin or Hex Encoding Identified","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:\\b0x[a-f\\d]{3,}|x\\'[a-f\\d]{3,}\\'|b\\'[0-1]{10,}\\')"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Bin or Hex Encoding Identified"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942450,"phase":2,"chain":false}},{"id":"942510","description":"SQLi bypass attempt by ticks or backticks detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:`(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)`)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQLi bypass attempt by ticks or backticks detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942510,"phase":2,"chain":false}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":{"Rx":"^(?:and|or)$"},"actions":[{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"942101","description":"SQL Injection Attack Detected via libinjection","enabled":true,"details":{"variables":[{"variable":"RequestBasename","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false}],"operator":"DetectSQLi","actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack Detected via libinjection"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","RemoveNulls"],"id":942101,"phase":1,"chain":false}},{"id":"942152","description":"SQL Injection Attack: SQL function name detected","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|eil(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|t)|rc32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|grees|s_(?:de|en)crypt)|ump)|e(?:lt|n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|object(?:_(?:agg|keys))?|e(?:ac|xtract_pat)h(?:_text)?|insert|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|insert_id)|case|e(?:as|f)t|i(?:kel(?:ihood|y)|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2)|wer)|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:(?:lyg|siti)on|w)|rocedure_analyse)|qu(?:arter|ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|pace|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp)|likely)|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\("},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQL Injection Attack: SQL function name detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942152,"phase":1,"chain":false}},{"id":"942321","description":"Detects MySQL and PostgreSQL stored procedure/function injections","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"User-Agent"},"count":false,"negation":false}],"operator":{"Rx":"(?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects MySQL and PostgreSQL stored procedure/function injections"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942321,"phase":1,"chain":false}},{"id":"942015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942015,"phase":1,"chain":false}},{"id":"942016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942016,"phase":2,"chain":false}},{"id":"942251","description":"Detects HAVING injections","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\W+\\d*?\\s*?\\bhaving\\b\\s*?[^\\s\\-]"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Detects HAVING injections"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942251,"phase":2,"chain":false}},{"id":"942460","description":"Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"\\W{4}"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Warning"},{"SetVar":"tx.sql_injection_score=+%{tx.warning_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}"}],"transformations":[],"id":942460,"phase":2,"chain":false}},{"id":"942511","description":"SQLi bypass attempt by ticks detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?:'(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)')"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQLi bypass attempt by ticks detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942511,"phase":2,"chain":false}},{"id":"942530","description":"SQLi query termination detected","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"';"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SQLi query termination detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-sqli"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SQLI"},{"Tag":"capec/1000/152/248/66"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":942530,"phase":2,"chain":false}},{"id":"942017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942017,"phase":1,"chain":false}},{"id":"942018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-942-APPLICATION-ATTACK-SQLI"}],"transformations":[],"id":942018,"phase":2,"chain":false}},{"id":"943011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943011,"phase":1,"chain":false}},{"id":"943012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943012,"phase":2,"chain":false}},{"id":"943100","description":"Possible Session Fixation Attack: Setting Cookie Values in HTML","enabled":true,"details":{"variables":[{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false}],"operator":{"Rx":"(?i:\\.cookie\\b.*?;\\W*?(?:expires|domain)\\W*?=|\\bhttp-equiv\\W+set-cookie\\b)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Session Fixation Attack: Setting Cookie Values in HTML"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-fixation"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SESSION-FIXATION"},{"Tag":"capec/1000/225/21/593/61"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.session_fixation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":943100,"phase":2,"chain":false}},{"id":"943110","description":"Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer"},{"LogData":"Matched Data: %{TX.0} found within %{TX.943110_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-fixation"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SESSION-FIXATION"},{"Tag":"capec/1000/225/21/593/61"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.943110_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase"],"id":943110,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":false,"negation":false}],"operator":{"Rx":"^(?:ht|f)tps?://(.*?)/"},"actions":[{"Tag":"FLAG:capture"}],"transformations":[],"id":0,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"1"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"SetVar":"tx.session_fixation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"943120","description":"Possible Session Fixation Attack: SessionID Parameter Name with No Referer","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Possible Session Fixation Attack: SessionID Parameter Name with No Referer"},{"LogData":"Matched Data: %{TX.0} found within %{TX.943120_MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-fixation"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-SESSION-FIXATION"},{"Tag":"capec/1000/225/21/593/61"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.943120_matched_var_name=%{matched_var_name}"}],"transformations":["Lowercase"],"id":943120,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Referer"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":[{"SetVar":"tx.session_fixation_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"943013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943013,"phase":1,"chain":false}},{"id":"943014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943014,"phase":2,"chain":false}},{"id":"943015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943015,"phase":1,"chain":false}},{"id":"943016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943016,"phase":2,"chain":false}},{"id":"943017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943017,"phase":1,"chain":false}},{"id":"943018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"}],"transformations":[],"id":943018,"phase":2,"chain":false}},{"id":"944011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944011,"phase":1,"chain":false}},{"id":"944012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944012,"phase":2,"chain":false}},{"id":"944100","description":"Remote Command Execution: Suspicious Java class detected","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"java\\.lang\\.(?:runtime|processbuilder)"},"actions":["Block",{"Msg":"Remote Command Execution: Suspicious Java class detected"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/137/6"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":944100,"phase":2,"chain":false}},{"id":"944110","description":"Remote Command Execution: Java process spawn (CVE-2017-9805)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:runtime|processbuilder)"},"actions":["Block",{"Msg":"Remote Command Execution: Java process spawn (CVE-2017-9805)"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":["Lowercase"],"id":944110,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:unmarshaller|base64data|java\\.)"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"944120","description":"Remote Command Execution: Java serialization (CVE-2015-4852)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"},"actions":["Block",{"Msg":"Remote Command Execution: Java serialization (CVE-2015-4852)"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"}],"transformations":["Lowercase"],"id":944120,"phase":2,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"MATCHED_VARS"},"count":false,"negation":false}],"operator":{"Rx":"(?:runtime|processbuilder)"},"actions":[{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"944130","description":"Suspicious Java class detected","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestFilename","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"PmFromFile":"java-classes.data"},"actions":["Block",{"Msg":"Suspicious Java class detected"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":944130,"phase":2,"chain":false}},{"id":"944140","description":"Java Injection Attack: Java Script File Upload Found","enabled":true,"details":{"variables":[{"variable":{"Tx":"FILES"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X_Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X.Filename"},"count":false,"negation":false},{"variable":{"RequestHeadersSpecific":"X-File-Name"},"count":false,"negation":false}],"operator":{"Rx":".*\\.(?:jsp|jspx)\\.*$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Java Injection Attack: Java Script File Upload Found"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-injection-java"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/242"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":944140,"phase":2,"chain":false}},{"id":"944150","description":"Potential Remote Command Execution: Log4j / Log4shell","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"},"actions":["Block","Log",{"Msg":"Potential Remote Command Execution: Log4j / Log4shell"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/137/6"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode"],"id":944150,"phase":2,"chain":false}},{"id":"944013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944013,"phase":1,"chain":false}},{"id":"944014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944014,"phase":2,"chain":false}},{"id":"944151","description":"Potential Remote Command Execution: Log4j / Log4shell","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"},"actions":["Block","Log",{"Msg":"Potential Remote Command Execution: Log4j / Log4shell"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/137/6"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode"],"id":944151,"phase":2,"chain":false}},{"id":"944200","description":"Magic bytes Detected, probable java serialization in use","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"\\xac\\xed\\x00\\x05"},"actions":["Block",{"Msg":"Magic bytes Detected, probable java serialization in use"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":944200,"phase":2,"chain":false}},{"id":"944210","description":"Magic bytes Detected Base64 Encoded, probable java serialization in use","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:rO0ABQ|KztAAU|Cs7QAF)"},"actions":["Block",{"Msg":"Magic bytes Detected Base64 Encoded, probable java serialization in use"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":944210,"phase":2,"chain":false}},{"id":"944240","description":"Remote Command Execution: Java serialization (CVE-2015-4852)","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"},"actions":["Block",{"Msg":"Remote Command Execution: Java serialization (CVE-2015-4852)"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":944240,"phase":2,"chain":false}},{"id":"944250","description":"Remote Command Execution: Suspicious Java method detected","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"java\\b.+(?:runtime|processbuilder)"},"actions":["Block",{"Msg":"Remote Command Execution: Suspicious Java method detected"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["Lowercase"],"id":944250,"phase":2,"chain":false}},{"id":"944260","description":"Remote Command Execution: Malicious class-loading payload","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:class\\.module\\.classLoader\\.resources\\.context\\.parent\\.pipeline|springframework\\.context\\.support\\.FileSystemXmlApplicationContext)"},"actions":["Block",{"Msg":"Remote Command Execution: Malicious class-loading payload"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni"],"id":944260,"phase":2,"chain":false}},{"id":"944015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944015,"phase":1,"chain":false}},{"id":"944016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944016,"phase":2,"chain":false}},{"id":"944300","description":"Base64 encoded string matched suspicious keyword","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestBody","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?:cnVudGltZQ|HJ1bnRpbWU|BydW50aW1l|cHJvY2Vzc2J1aWxkZXI|HByb2Nlc3NidWlsZGVy|Bwcm9jZXNzYnVpbGRlcg|Y2xvbmV0cmFuc2Zvcm1lcg|GNsb25ldHJhbnNmb3JtZXI|BjbG9uZXRyYW5zZm9ybWVy|Zm9yY2xvc3VyZQ|GZvcmNsb3N1cmU|Bmb3JjbG9zdXJl|aW5zdGFudGlhdGVmYWN0b3J5|Gluc3RhbnRpYXRlZmFjdG9yeQ|BpbnN0YW50aWF0ZWZhY3Rvcnk|aW5zdGFudGlhdGV0cmFuc2Zvcm1lcg|Gluc3RhbnRpYXRldHJhbnNmb3JtZXI|BpbnN0YW50aWF0ZXRyYW5zZm9ybWVy|aW52b2tlcnRyYW5zZm9ybWVy|Gludm9rZXJ0cmFuc2Zvcm1lcg|BpbnZva2VydHJhbnNmb3JtZXI|cHJvdG90eXBlY2xvbmVmYWN0b3J5|HByb3RvdHlwZWNsb25lZmFjdG9yeQ|Bwcm90b3R5cGVjbG9uZWZhY3Rvcnk|cHJvdG90eXBlc2VyaWFsaXphdGlvbmZhY3Rvcnk|HByb3RvdHlwZXNlcmlhbGl6YXRpb25mYWN0b3J5|Bwcm90b3R5cGVzZXJpYWxpemF0aW9uZmFjdG9yeQ|d2hpbGVjbG9zdXJl|HdoaWxlY2xvc3VyZQ|B3aGlsZWNsb3N1cmU)"},"actions":["Block",{"Msg":"Base64 encoded string matched suspicious keyword"},{"LogData":"Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/3"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/248"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":944300,"phase":2,"chain":false}},{"id":"944017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944017,"phase":1,"chain":false}},{"id":"944018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-944-APPLICATION-ATTACK-JAVA"}],"transformations":[],"id":944018,"phase":2,"chain":false}},{"id":"944152","description":"Potential Remote Command Execution: Log4j / Log4shell","enabled":true,"details":{"variables":[{"variable":"RequestLine","count":false,"negation":false},{"variable":"Args","count":false,"negation":false},{"variable":"ArgsNames","count":false,"negation":false},{"variable":"RequestCookies","count":false,"negation":false},{"variable":"RequestCookiesNames","count":false,"negation":false},{"variable":"RequestHeaders","count":false,"negation":false},{"variable":{"TxSpecific":"XML:/*"},"count":false,"negation":false},{"variable":{"TxSpecific":"XML://@*"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"},"actions":["Block","Log",{"Msg":"Potential Remote Command Execution: Log4j / Log4shell"},{"Tag":"application-multi"},{"Tag":"language-java"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/4"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/ATTACK-JAVA"},{"Tag":"capec/1000/152/137/6"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.rce_score=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"}],"transformations":["UrlDecodeUni","HtmlEntityDecode"],"id":944152,"phase":2,"chain":false}},{"id":"949052","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"}],"transformations":[],"id":949052,"phase":1,"chain":false}},{"id":"949152","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"}],"transformations":[],"id":949152,"phase":1,"chain":false}},{"id":"949053","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"}],"transformations":[],"id":949053,"phase":1,"chain":false}},{"id":"949153","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"}],"transformations":[],"id":949153,"phase":1,"chain":false}},{"id":"949054","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"}],"transformations":[],"id":949054,"phase":1,"chain":false}},{"id":"949154","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"}],"transformations":[],"id":949154,"phase":1,"chain":false}},{"id":"949055","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"}],"transformations":[],"id":949055,"phase":1,"chain":false}},{"id":"949155","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"}],"transformations":[],"id":949155,"phase":1,"chain":false}},{"id":"949060","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"}],"transformations":[],"id":949060,"phase":2,"chain":false}},{"id":"949160","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"}],"transformations":[],"id":949160,"phase":2,"chain":false}},{"id":"949061","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"}],"transformations":[],"id":949061,"phase":2,"chain":false}},{"id":"949161","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"}],"transformations":[],"id":949161,"phase":2,"chain":false}},{"id":"949062","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"}],"transformations":[],"id":949062,"phase":2,"chain":false}},{"id":"949162","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"}],"transformations":[],"id":949162,"phase":2,"chain":false}},{"id":"949063","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"}],"transformations":[],"id":949063,"phase":2,"chain":false}},{"id":"949163","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"}],"transformations":[],"id":949163,"phase":2,"chain":false}},{"id":"949111","description":"Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_INBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Msg":"Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"},{"Tag":"anomaly-evaluation"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":949111,"phase":1,"chain":true}},{"id":"949110","description":"Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_INBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Msg":"Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"},{"Tag":"anomaly-evaluation"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":949110,"phase":2,"chain":false}},{"id":"949011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949011,"phase":1,"chain":false}},{"id":"949012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949012,"phase":2,"chain":false}},{"id":"949013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949013,"phase":1,"chain":false}},{"id":"949014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949014,"phase":2,"chain":false}},{"id":"949015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949015,"phase":1,"chain":false}},{"id":"949016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949016,"phase":2,"chain":false}},{"id":"949017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949017,"phase":1,"chain":false}},{"id":"949018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REQUEST-949-BLOCKING-EVALUATION"}],"transformations":[],"id":949018,"phase":2,"chain":false}},{"id":"950021","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"crs_skip_response_analysis"},"count":false,"negation":false}],"operator":{"Eq":"1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":950021,"phase":3,"chain":false}},{"id":"950010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950010,"phase":4,"chain":false}},{"id":"950011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950011,"phase":3,"chain":false}},{"id":"950012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950012,"phase":4,"chain":false}},{"id":"950130","description":"Directory Listing","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?:<(?:TITLE>Index of.*?<H|title>Index of.*?<h)1>Index of|>\\[To Parent Directory\\]</[Aa]><br>)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Directory Listing"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Tag":"capec/1000/118/116/54/127"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":950130,"phase":4,"chain":false}},{"id":"950140","description":"CGI source code leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^#\\!\\s?/"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"CGI source code leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":950140,"phase":4,"chain":false}},{"id":"950150","description":"ASP.NET exception leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"asp-dotnet-errors.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"ASP.NET exception leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-aspnet"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Tag":"capec/1000/118/116/54/127"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":950150,"phase":4,"chain":false}},{"id":"950013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950013,"phase":3,"chain":false}},{"id":"950014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950014,"phase":4,"chain":false}},{"id":"950100","description":"The Application Returned a 500-Level Status Code","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_STATUS"},"count":false,"negation":false}],"operator":{"Rx":"^5\\d{2}$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"The Application Returned a 500-Level Status Code"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES"},{"Tag":"capec/1000/152"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"}],"transformations":[],"id":950100,"phase":3,"chain":false}},{"id":"950015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950015,"phase":3,"chain":false}},{"id":"950016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950016,"phase":4,"chain":false}},{"id":"950017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950017,"phase":3,"chain":false}},{"id":"950018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-950-DATA-LEAKAGES"}],"transformations":[],"id":950018,"phase":4,"chain":false}},{"id":"951010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951010,"phase":4,"chain":false}},{"id":"951011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951011,"phase":3,"chain":false}},{"id":"951012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951012,"phase":4,"chain":false}},{"id":"951100","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"!@pmFromFile sql-errors.data"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-SQL-ERROR-MATCH-PL1"}],"transformations":[],"id":951100,"phase":4,"chain":false}},{"id":"951110","description":"Microsoft Access SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:JET Database Engine|Access Database Engine|\\[Microsoft\\]\\[ODBC Microsoft Access Driver\\])"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Microsoft Access SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-msaccess"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951110,"phase":4,"chain":false}},{"id":"951120","description":"Oracle SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)\\bORA-[0-9][0-9][0-9][0-9][0-9]:|java\\.sql\\.SQLException|Oracle(?: erro|[^\\(\\)]{0,20}Drive)r|Warning.{1,10}o(?:ci_.{1,30}|ra_.{1,20})"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Oracle SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-oracle"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951120,"phase":4,"chain":false}},{"id":"951130","description":"DB2 SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:DB2 SQL error:|\\[IBM\\]\\[CLI Driver\\]\\[DB2/6000\\]|CLI Driver.*DB2|DB2 SQL error|db2_\\w+\\()"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"DB2 SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-db2"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951130,"phase":4,"chain":false}},{"id":"951140","description":"EMC SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:\\[DM_QUERY_E_SYNTAX\\]|has occurred in the vicinity of:)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"EMC SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-emc"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951140,"phase":4,"chain":false}},{"id":"951150","description":"firebird SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)Dynamic SQL Error"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"firebird SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-firebird"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951150,"phase":4,"chain":false}},{"id":"951160","description":"Frontbase SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)Exception (?:condition )?\\d+\\. Transaction rollback\\."},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Frontbase SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-frontbase"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951160,"phase":4,"chain":false}},{"id":"951170","description":"hsqldb SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)org\\.hsqldb\\.jdbc"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"hsqldb SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-hsqldb"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951170,"phase":4,"chain":false}},{"id":"951180","description":"informix SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:An illegal character has been found in the statement|com\\.informix\\.jdbc|Exception.*Informix)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"informix SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-informix"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951180,"phase":4,"chain":false}},{"id":"951190","description":"ingres SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:Warning.*ingres_|Ingres SQLSTATE|Ingres\\W.*Driver)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"ingres SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-ingres"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951190,"phase":4,"chain":false}},{"id":"951200","description":"interbase SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i:<b>Warning</b>: ibase_|Unexpected end of command in statement)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"interbase SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-interbase"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951200,"phase":4,"chain":false}},{"id":"951210","description":"maxDB SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)Warning.{1,10}maxdb[\\(\\)_a-z:]{1,26}:"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"maxDB SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-maxdb"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951210,"phase":4,"chain":false}},{"id":"951220","description":"mssql SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:System\\.Data\\.OleDb\\.OleDbException|\\[Microsoft\\]\\[ODBC SQL Server Driver\\]|\\[Macromedia\\]\\[SQLServer JDBC Driver\\]|\\[SqlException|System\\.Data\\.SqlClient\\.SqlException|Unclosed quotation mark after the character string|'80040e14'|mssql_query\\(\\)|Microsoft OLE DB Provider for ODBC Drivers|Microsoft OLE DB Provider for SQL Server|Incorrect syntax near|Sintaxis incorrecta cerca de|Syntax error in string in query expression|Procedure or function '.{1,128}' expects parameter|Unclosed quotation mark before the character string|Syntax error .* in query expression|Data type mismatch in criteria expression\\.|ADODB\\.Field \\(0x800A0BCD\\)|the used select statements have different number of columns|OLE DB.*SQL Server|Warning.*mssql_.*|Driver.*SQL[ _-]*Server|Exception.*\\WSystem\\.Data\\.SqlClient\\.|Conversion failed when converting the varchar value .*? to data type int\\.)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"mssql SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-mssql"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951220,"phase":4,"chain":false}},{"id":"951230","description":"mysql SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:supplied argument is not a valid |SQL syntax.*)MySQL|Column count doesn't match(?: value count at row)?|mysql_fetch_array\\(\\)|on MySQL result index|You have an error in your SQL syntax(?:;| near)|MyS(?:QL server version for the right syntax to use|qlClient\\.)|\\[MySQL\\]\\[ODBC|(?:Table '[^']+' doesn't exis|valid MySQL resul)t|Warning.{1,10}mysql_(?:[\\(\\)_a-z]{1,26})?|(?:ERROR [0-9]{4} \\([0-9a-z]{5}\\)|XPATH syntax error):"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"mysql SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-mysql"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951230,"phase":4,"chain":false}},{"id":"951240","description":"postgres SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)P(?:ostgreSQL(?: query failed:|.{1,20}ERROR)|G::[a-z]*Error)|(?:pg_(?:query|exec)\\(\\) \\[|org\\.postgresql\\.util\\.PSQLException):|Warning.{1,20}\\bpg_.*|valid PostgreSQL result|Npgsql\\.|Supplied argument is not a valid PostgreSQL .*? resource|(?:Unable to connect to PostgreSQL serv|invalid input syntax for integ)er"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"postgres SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-pgsql"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951240,"phase":4,"chain":false}},{"id":"951250","description":"sqlite SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:Warning.*sqlite_|Warning.*SQLite3::|SQLite/JDBCDriver|SQLite\\.Exception|System\\.Data\\.SQLite\\.SQLiteException)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"sqlite SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-sqlite"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951250,"phase":4,"chain":false}},{"id":"951260","description":"Sybase SQL Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:Sybase message:|Warning.{2,20}sybase|Sybase.*Server message)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Sybase SQL Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-sybase"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-SQL"},{"Tag":"capec/1000/118/116/54"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"},{"SetVar":"tx.sql_injection_score=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":951260,"phase":4,"chain":false}},{"id":"951013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951013,"phase":3,"chain":false}},{"id":"951014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951014,"phase":4,"chain":false}},{"id":"951015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951015,"phase":3,"chain":false}},{"id":"951016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951016,"phase":4,"chain":false}},{"id":"951017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951017,"phase":3,"chain":false}},{"id":"951018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-951-DATA-LEAKAGES-SQL"}],"transformations":[],"id":951018,"phase":4,"chain":false}},{"id":"952010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-JAVA"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952010,"phase":4,"chain":false}},{"id":"952011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952011,"phase":3,"chain":false}},{"id":"952012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952012,"phase":4,"chain":false}},{"id":"952013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952013,"phase":3,"chain":false}},{"id":"952014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952014,"phase":4,"chain":false}},{"id":"952015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952015,"phase":3,"chain":false}},{"id":"952016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952016,"phase":4,"chain":false}},{"id":"952017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952017,"phase":3,"chain":false}},{"id":"952018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-952-DATA-LEAKAGES-JAVA"}],"transformations":[],"id":952018,"phase":4,"chain":false}},{"id":"953010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-PHP"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953010,"phase":4,"chain":false}},{"id":"953011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953011,"phase":3,"chain":false}},{"id":"953012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953012,"phase":4,"chain":false}},{"id":"953100","description":"PHP Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"php-errors.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-PHP"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":953100,"phase":4,"chain":false}},{"id":"953110","description":"PHP source code leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?:\\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\\$_(?:(?:pos|ge)t|session))\\b"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP source code leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-PHP"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":953110,"phase":4,"chain":false}},{"id":"953120","description":"PHP source code leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)<\\?(?:=|php)?\\s+"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP source code leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-PHP"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":953120,"phase":4,"chain":false}},{"id":"953013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953013,"phase":3,"chain":false}},{"id":"953014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953014,"phase":4,"chain":false}},{"id":"953015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953015,"phase":3,"chain":false}},{"id":"953016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953016,"phase":4,"chain":false}},{"id":"953017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953017,"phase":3,"chain":false}},{"id":"953018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-953-DATA-LEAKAGES-PHP"}],"transformations":[],"id":953018,"phase":4,"chain":false}},{"id":"954010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954010,"phase":4,"chain":false}},{"id":"954011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954011,"phase":3,"chain":false}},{"id":"954012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954012,"phase":4,"chain":false}},{"id":"954100","description":"Disclosure of IIS install location","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)[a-z]:[\\x5c/]inetpub\\b"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Disclosure of IIS install location"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":954100,"phase":4,"chain":false}},{"id":"954110","description":"Application Availability Error","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?:Microsoft OLE DB Provider for SQL Server(?:</font>.{1,20}?error '800(?:04005|40e31)'.{1,40}?Timeout expired| \\(0x80040e31\\)<br>Timeout expired<br>)|<h1>internal server error</h1>.*?<h2>part of the server has crashed or it has a configuration error\\.</h2>|cannot connect to the server: timed out)"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Application Availability Error"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":954110,"phase":4,"chain":false}},{"id":"954120","description":"IIS Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"iis-errors.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IIS Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":954120,"phase":4,"chain":false}},{"id":"954130","description":"IIS Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_STATUS"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^404$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"IIS Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"}],"transformations":[],"id":954130,"phase":4,"chain":true}},{"id":"0","description":"No description","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"\\bServer Error in.{0,50}?\\bApplication\\b"},"actions":[{"Tag":"FLAG:capture"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":0,"phase":2,"chain":false}},{"id":"954013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954013,"phase":3,"chain":false}},{"id":"954014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954014,"phase":4,"chain":false}},{"id":"954101","description":"Disclosure of IIS install location","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)[\\x5c/]inetpub\\b"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Disclosure of IIS install location"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-multi"},{"Tag":"platform-iis"},{"Tag":"platform-windows"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-IIS"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"}],"transformations":[],"id":954101,"phase":4,"chain":false}},{"id":"954015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954015,"phase":3,"chain":false}},{"id":"954016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954016,"phase":4,"chain":false}},{"id":"954017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954017,"phase":3,"chain":false}},{"id":"954018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-954-DATA-LEAKAGES-IIS"}],"transformations":[],"id":954018,"phase":4,"chain":false}},{"id":"955010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955010,"phase":4,"chain":false}},{"id":"955011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955011,"phase":3,"chain":false}},{"id":"955012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955012,"phase":4,"chain":false}},{"id":"955100","description":"PHP Web shell detected","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"web-shells-php.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PHP Web shell detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955100,"phase":4,"chain":false}},{"id":"955110","description":"r57 web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>r57 Shell Version [0-9.]+</title>|<title>r57 shell</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"r57 web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955110,"phase":4,"chain":false}},{"id":"955120","description":"WSO web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html><head><meta http-equiv='Content-Type' content='text/html; charset=(?:Windows-1251|UTF-8)?'><title>.*?(?: -)? W[Ss][Oo] [0-9.]+</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"WSO web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955120,"phase":4,"chain":false}},{"id":"955130","description":"b4tm4n web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"B4TM4N SH3LL</title>[^<]*<meta name='author' content='k4mpr3t'/>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"b4tm4n web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955130,"phase":4,"chain":false}},{"id":"955140","description":"Mini Shell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>Mini Shell</title>[^D]*Developed By LameHacker"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Mini Shell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955140,"phase":4,"chain":false}},{"id":"955150","description":"Ashiyane web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>\\.:: [^~]*~ Ashiyane V [0-9.]+ ::\\.</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Ashiyane web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955150,"phase":4,"chain":false}},{"id":"955160","description":"Symlink_Sa web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>Symlink_Sa [0-9.]+</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Symlink_Sa web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955160,"phase":4,"chain":false}},{"id":"955170","description":"CasuS web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>CasuS [0-9.]+ by MafiABoY</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"CasuS web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955170,"phase":4,"chain":false}},{"id":"955180","description":"GRP WebShell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html>\\r\\n<head>\\r\\n<title>GRP WebShell [0-9.]+ "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"GRP WebShell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955180,"phase":4,"chain":false}},{"id":"955190","description":"NGHshell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<small>NGHshell [0-9.]+ by Cr4sh</body></html>\\n$"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"NGHshell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955190,"phase":4,"chain":false}},{"id":"955200","description":"SimAttacker web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>SimAttacker - (?:Version|Vrsion) : [0-9.]+ - "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SimAttacker web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955200,"phase":4,"chain":false}},{"id":"955210","description":"Unknown web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<!DOCTYPE html>\\n<html>\\n<!-- By Artyum [^<]*<title>Web Shell</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Unknown web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955210,"phase":4,"chain":false}},{"id":"955220","description":"lama\\'s\\'hell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>lama's'hell v. [0-9.]+</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"lama\\'s\\'hell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955220,"phase":4,"chain":false}},{"id":"955230","description":"lostDC web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^ *<html>\\n[ ]+<head>\\n[ ]+<title>lostDC - "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"lostDC web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955230,"phase":4,"chain":false}},{"id":"955240","description":"Unknown web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<title>PHP Web Shell</title>\\r\\n<html>\\r\\n<body>\\r\\n    <!-- Replaces command with Base64-encoded Data -->"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Unknown web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955240,"phase":4,"chain":false}},{"id":"955260","description":"Ru24PostWebShell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html>\\n<head>\\n<title>Ru24PostWebShell "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Ru24PostWebShell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955260,"phase":4,"chain":false}},{"id":"955270","description":"s72 Shell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"<title>s72 Shell v[0-9.]+ Codinf by Cr@zy_King</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"s72 Shell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955270,"phase":4,"chain":false}},{"id":"955290","description":"g00nshell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^ <html>\\n\\n<head>\\n\\n<title>g00nshell v[0-9.]+ "},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"g00nshell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955290,"phase":4,"chain":false}},{"id":"955300","description":"PuNkHoLic shell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Contains":"<title>punkholicshell</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"PuNkHoLic shell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":["RemoveWhitespace","Lowercase"],"id":955300,"phase":4,"chain":false}},{"id":"955310","description":"azrail web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html>\\n      <head>\\n             <title>azrail [0-9.]+ by C-W-M</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"azrail web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955310,"phase":4,"chain":false}},{"id":"955320","description":"SmEvK_PaThAn Shell web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":">SmEvK_PaThAn Shell v[0-9]+ coded by <a href="},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"SmEvK_PaThAn Shell web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955320,"phase":4,"chain":false}},{"id":"955330","description":"Shell I web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^<html>\\n<title>[^~]*~ Shell I</title>\\n<head>\\n<style>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Shell I web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955330,"phase":4,"chain":false}},{"id":"955340","description":"b374k m1n1 web shell","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"^ <html><head><title>:: b374k m1n1 [0-9.]+ ::</title>"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"b374k m1n1 web shell"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955340,"phase":4,"chain":false}},{"id":"955400","description":"ASP Web shell detected","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"web-shells-asp.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"ASP Web shell detected"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"language-php"},{"Tag":"platform-multi"},{"Tag":"attack-rce"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/WEB-SHELLS"},{"Tag":"capec/1000/225/122/17/650"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Critical"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":955400,"phase":4,"chain":false}},{"id":"955013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955013,"phase":3,"chain":false}},{"id":"955014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955014,"phase":4,"chain":false}},{"id":"955015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955015,"phase":3,"chain":false}},{"id":"955016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955016,"phase":4,"chain":false}},{"id":"955017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955017,"phase":3,"chain":false}},{"id":"955018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-955-WEB-SHELLS"}],"transformations":[],"id":955018,"phase":4,"chain":false}},{"id":"956010","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"RESPONSE_HEADERS:Content-Encoding"},"count":false,"negation":false}],"operator":{"Rx":"@pm gzip compress deflate br zstd"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-RUBY"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956010,"phase":4,"chain":false}},{"id":"956011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956011,"phase":3,"chain":false}},{"id":"956012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956012,"phase":4,"chain":false}},{"id":"956100","description":"RUBY Information Leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"PmFromFile":"ruby-errors.data"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"RUBY Information Leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-ruby"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/1"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-RUBY"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":956100,"phase":4,"chain":false}},{"id":"956013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956013,"phase":3,"chain":false}},{"id":"956014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956014,"phase":4,"chain":false}},{"id":"956110","description":"Ruby source code leakage","enabled":true,"details":{"variables":[{"variable":{"Tx":"RESPONSE_BODY"},"count":false,"negation":false}],"operator":{"Rx":"(?i)(?:<%[=#\\s]|#\\{[^}]+\\})"},"actions":["Block",{"Tag":"FLAG:capture"},{"Msg":"Ruby source code leakage"},{"LogData":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"},{"Tag":"application-multi"},{"Tag":"language-ruby"},{"Tag":"platform-multi"},{"Tag":"attack-disclosure"},{"Tag":"paranoia-level/2"},{"Tag":"OWASP_CRS"},{"Tag":"OWASP_CRS/DATA-LEAKAGES-RUBY"},{"Tag":"capec/1000/118/116"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"Severity":"Error"},{"SetVar":"tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"}],"transformations":[],"id":956110,"phase":4,"chain":false}},{"id":"956015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956015,"phase":3,"chain":false}},{"id":"956016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956016,"phase":4,"chain":false}},{"id":"956017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956017,"phase":3,"chain":false}},{"id":"956018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-956-DATA-LEAKAGES-RUBY"}],"transformations":[],"id":956018,"phase":4,"chain":false}},{"id":"959052","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"}],"transformations":[],"id":959052,"phase":3,"chain":false}},{"id":"959152","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"}],"transformations":[],"id":959152,"phase":3,"chain":false}},{"id":"959053","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"}],"transformations":[],"id":959053,"phase":3,"chain":false}},{"id":"959153","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"}],"transformations":[],"id":959153,"phase":3,"chain":false}},{"id":"959054","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"}],"transformations":[],"id":959054,"phase":3,"chain":false}},{"id":"959154","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"}],"transformations":[],"id":959154,"phase":3,"chain":false}},{"id":"959055","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"}],"transformations":[],"id":959055,"phase":3,"chain":false}},{"id":"959155","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"}],"transformations":[],"id":959155,"phase":3,"chain":false}},{"id":"959060","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"}],"transformations":[],"id":959060,"phase":4,"chain":false}},{"id":"959160","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 1"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"}],"transformations":[],"id":959160,"phase":4,"chain":false}},{"id":"959061","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"}],"transformations":[],"id":959061,"phase":4,"chain":false}},{"id":"959161","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 2"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"}],"transformations":[],"id":959161,"phase":4,"chain":false}},{"id":"959062","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"}],"transformations":[],"id":959062,"phase":4,"chain":false}},{"id":"959162","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 3"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"}],"transformations":[],"id":959162,"phase":4,"chain":false}},{"id":"959063","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"}],"transformations":[],"id":959063,"phase":4,"chain":false}},{"id":"959163","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 4"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SetVar":"tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"}],"transformations":[],"id":959163,"phase":4,"chain":false}},{"id":"959101","description":"Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_OUTBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Msg":"Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})"},{"Tag":"anomaly-evaluation"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":959101,"phase":3,"chain":true}},{"id":"959100","description":"Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_OUTBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":[{"Deny":403},{"Msg":"Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})"},{"Tag":"anomaly-evaluation"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"}],"transformations":[],"id":959100,"phase":4,"chain":false}},{"id":"959011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959011,"phase":3,"chain":false}},{"id":"959012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959012,"phase":4,"chain":false}},{"id":"959013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959013,"phase":3,"chain":false}},{"id":"959014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959014,"phase":4,"chain":false}},{"id":"959015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959015,"phase":3,"chain":false}},{"id":"959016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959016,"phase":4,"chain":false}},{"id":"959017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959017,"phase":3,"chain":false}},{"id":"959018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-959-BLOCKING-EVALUATION"}],"transformations":[],"id":959018,"phase":4,"chain":false}},{"id":"980041","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980041,"phase":5,"chain":false}},{"id":"980042","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Rx":"@ge 5"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980042,"phase":5,"chain":false}},{"id":"980043","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980043,"phase":5,"chain":false}},{"id":"980044","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_INBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980044,"phase":5,"chain":false}},{"id":"980045","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_OUTBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980045,"phase":5,"chain":false}},{"id":"980046","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980046,"phase":5,"chain":false}},{"id":"980047","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_INBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980047,"phase":5,"chain":false}},{"id":"980048","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_OUTBOUND_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":"NoOp","actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980048,"phase":5,"chain":false}},{"id":"980049","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980049,"phase":5,"chain":false}},{"id":"980050","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"BLOCKING_ANOMALY_SCORE"},"count":false,"negation":false}],"operator":{"Gt":0},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"LOG-REPORTING"}],"transformations":[],"id":980050,"phase":5,"chain":false}},{"id":"980051","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"REPORTING_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-REPORTING"}],"transformations":[],"id":980051,"phase":5,"chain":false}},{"id":"980011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980011,"phase":1,"chain":false}},{"id":"980012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980012,"phase":2,"chain":false}},{"id":"980013","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980013,"phase":1,"chain":false}},{"id":"980014","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":2},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980014,"phase":2,"chain":false}},{"id":"980015","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980015,"phase":1,"chain":false}},{"id":"980016","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":3},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980016,"phase":2,"chain":false}},{"id":"980017","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980017,"phase":1,"chain":false}},{"id":"980018","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":4},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.23.0-dev"},{"SkipAfter":"END-RESPONSE-980-CORRELATION"}],"transformations":[],"id":980018,"phase":2,"chain":false}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"(?i)foo"},"actions":["Pass",{"Tag":"FLAG:nolog"}],"transformations":["Lowercase"],"id":1,"phase":1,"chain":false}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false}],"operator":{"Rx":"index.php"},"actions":[{"Deny":403},{"Tag":"FLAG:nolog"},{"Tag":"attack-xss"}],"transformations":[],"id":1,"phase":1,"chain":false}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false}],"operator":{"Rx":"index.php"},"actions":[{"Deny":403},{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"}],"transformations":[],"id":1,"phase":1,"chain":false}},{"id":"2","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false}],"operator":{"Rx":"index.php"},"actions":[{"Deny":403},{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/1.0.0-dev"}],"transformations":[],"id":2,"phase":1,"chain":false}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"TX:1"},"actions":[{"Deny":403},{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.7.0-dev"}],"transformations":[],"id":1,"phase":2,"chain":false}},{"id":"2","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"attack"},"actions":[{"Deny":403},{"Tag":"FLAG:capture"},{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.7.0-dev"}],"transformations":[],"id":2,"phase":2,"chain":true}},{"id":"3","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"attack"},"actions":[{"Deny":403},{"Tag":"FLAG:nolog"},{"Tag":"OWASP_CRS"},{"Ver":"OWASP_CRS/4.7.0-dev"}],"transformations":[],"id":3,"phase":2,"chain":true}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false}],"operator":{"BeginsWith":"/index.php"},"actions":[{"Deny":403},{"Tag":"FLAG:nolog"}],"transformations":[],"id":1,"phase":1,"chain":false}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false}],"operator":{"BeginsWith":"/index.php"},"actions":[{"Deny":403},{"Tag":"FLAG:nolog"}],"transformations":[],"id":1,"phase":1,"chain":false}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"foo"},"actions":["Pass",{"Tag":"FLAG:nolog"}],"transformations":[],"id":1,"phase":1,"chain":false}},{"id":"2","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"foo"},"actions":["Pass",{"Tag":"FLAG:nolog"}],"transformations":[],"id":2,"phase":1,"chain":false}},{"id":"3","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"foo"},"actions":["Pass",{"Tag":"FLAG:nolog"}],"transformations":[],"id":3,"phase":1,"chain":false}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"RequestUri","count":false,"negation":false}],"operator":{"Rx":"index.php"},"actions":[{"Deny":403},{"Tag":"FLAG:nolog"}],"transformations":[],"id":1,"phase":1,"chain":false}},{"id":"1","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"attack"},"actions":["Block",{"Tag":"FLAG:capture"},{"Ctl":["","auditLogParts=+E"]}],"transformations":[],"id":1,"phase":4,"chain":false}},{"id":"1001","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"foo"},"actions":["Block",{"Tag":"FLAG:capture"}],"transformations":[],"id":1001,"phase":2,"chain":false}},{"id":"1001","description":"No description","enabled":true,"details":{"variables":[{"variable":"ArgsNames","count":false,"negation":false}],"operator":{"Rx":"bar"},"actions":["Block",{"Tag":"FLAG:capture"}],"transformations":[],"id":1001,"phase":2,"chain":false}},{"id":"901120","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"blocking_paranoia_level"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Ver":"OWASP_CRS/4.0.0-rc1"},{"SetVar":"tx.blocking_paranoia_level=1"}],"transformations":[],"id":901120,"phase":1,"chain":false}},{"id":"901125","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"detection_paranoia_level"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Ver":"OWASP_CRS/4.0.0-rc1"},{"SetVar":"tx.detection_paranoia_level=%{TX.blocking_paranoia_level}"}],"transformations":[],"id":901125,"phase":1,"chain":false}},{"id":"901141","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"error_anomaly_score"},"count":true,"negation":false}],"operator":{"Eq":"0"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"Ver":"OWASP_CRS/4.0.0-rc1"},{"SetVar":"tx.error_anomaly_score=4"}],"transformations":[],"id":901141,"phase":1,"chain":false}},{"id":"920011","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920011,"phase":1,"chain":false}},{"id":"920012","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"DETECTION_PARANOIA_LEVEL"},"count":false,"negation":false}],"operator":{"Lt":1},"actions":["Pass",{"Tag":"FLAG:nolog"},{"SkipAfter":"END-REQUEST-920-PROTOCOL-ENFORCEMENT"}],"transformations":[],"id":920012,"phase":2,"chain":false}},{"id":"920160","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^\\d+$"},"actions":["Block",{"Tag":"paranoia-level/2"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":920160,"phase":1,"chain":false}},{"id":"920161","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^\\d+$"},"actions":["Block",{"Tag":"paranoia-level/1"},{"SetVar":"tx.inbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"}],"transformations":[],"id":920161,"phase":1,"chain":false}},{"id":"920162","description":"No description","enabled":true,"details":{"variables":[{"variable":{"RequestHeadersSpecific":"Content-Length"},"count":false,"negation":false}],"operator":{"Rx":"!@rx ^\\d+$"},"actions":["Block",{"Tag":"paranoia-level/1"},{"Severity":"Critical"},{"SetVar":"tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"}],"transformations":[],"id":920162,"phase":1,"chain":false}},{"id":"1001","description":"No description","enabled":true,"details":{"variables":[{"variable":{"TxSpecific":"foo"},"count":false,"negation":false}],"operator":{"Rx":"bar"},"actions":["Pass",{"Tag":"FLAG:nolog"}],"transformations":[],"id":1001,"phase":1,"chain":false}},{"id":"1002","description":"No description","enabled":true,"details":{"variables":[{"variable":"Args","count":false,"negation":false}],"operator":{"Rx":"^.*$"},"actions":["Pass",{"Tag":"FLAG:nolog"},{"SetVar":"tx.bar=1"}],"transformations":[],"id":1002,"phase":1,"chain":false}}]